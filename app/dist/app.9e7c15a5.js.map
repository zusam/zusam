{"version":3,"sources":["../src/options.js","../src/constants.js","../src/create-element.js","../src/component.js","../src/create-context.js","../src/util.js","../src/diff/children.js","../src/diff/props.js","../src/diff/index.js","../src/render.js","../src/clone-element.js","../src/diff/catch-error.js","core/alert.js","core/storage.js","core/lang.js","core/me.js","core/util.js","core/router.js","core/http.js","core/api.js","../node_modules/idb-keyval/dist/idb-keyval.mjs","core/cache.js","core/index.js","misc/fa-icon.component.js","misc/index.js","../node_modules/parcel-bundler/src/builtins/bundle-url.js","../node_modules/parcel-bundler/src/builtins/bundle-loader.js","message/file-grid.component.js","message/message-child.component.js","message/message-children.component.js","message/message-head.component.js","message/message-footer.component.js","message/embeds/twitch-embed.component.js","message/embeds/bandcamp-embed.component.js","message/embeds/generic-embed.component.js","message/embed-block.component.js","message/message-body.component.js","message/writer.component.js","message/message.component.js","message/message-parent.component.js","message/message-preview.component.js","message/message-search-result.component.js","message/index.js","navbar/group-search.component.js","navbar/groups-dropdown-navbar.component.js","pages/create-group.component.js","pages/group-board.component.js","pages/bookmark-board.component.js","settings/group-settings.component.js","settings/user-settings.component.js","settings/settings.component.js","settings/index.js","pages/main-content.component.js","pages/notification.component.js","pages/search.component.js","pages/share.component.js","pages/group-title.component.js","pages/index.js","navbar/navbar.component.js","navbar/notifications-dropdown-navbar.component.js","navbar/index.js","outside/login.component.js","outside/reset-password.component.js","outside/signup.component.js","outside/stop-notification-emails.component.js","outside/public.component.js","outside/index.js","app.js","../node_modules/parcel-bundler/src/builtins/loaders/browser/js-loader.js"],"names":["options","isValidElement","rerenderQueue","defer","prevDebounce","i","EMPTY_OBJ","EMPTY_ARR","IS_NON_DIMENSIONAL","assign","obj","props","removeNode","node","parentNode","removeChild","createElement","type","children","key","ref","normalizedProps","arguments","length","push","defaultProps","createVNode","original","vnode","undefined","constructor","createRef","current","Fragment","Component","context","getDomSibling","childIndex","indexOf","sibling","updateParentDomPointers","child","base","enqueueRender","c","process","debounceRendering","queue","sort","a","b","some","component","commitQueue","oldVNode","oldDom","parentDom","diff","ownerSVGElement","commitRoot","diffChildren","renderResult","newParentVNode","oldParentVNode","globalContext","isSvg","excessDomChildren","isHydrating","j","childVNode","newDom","firstChildDom","refs","oldChildren","oldChildrenLength","Array","isArray","reorderChildren","placeChild","value","unmount","applyRef","tmp","toChildArray","out","nextDom","sibDom","outer","appendChild","nextSibling","insertBefore","diffProps","dom","newProps","oldProps","hydrate","setProperty","setStyle","style","test","name","oldValue","useCapture","o","cssText","replace","toLowerCase","slice","_listeners","addEventListener","eventProxyCapture","eventProxy","removeEventListener","e","setAttribute","removeAttribute","event","newVNode","isNew","oldState","snapshot","clearProcessingException","provider","componentContext","newType","contextType","prototype","render","doRender","sub","state","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","getChildContext","getSnapshotBeforeUpdate","diffElementNodes","diffed","root","cb","call","oldHtml","newHtml","nodeType","localName","document","createTextNode","createElementNS","is","data","childNodes","dangerouslySetInnerHTML","attributes","innerHTML","firstChild","checked","parentVNode","skipRemove","r","componentWillUnmount","this","replaceNode","cloneElement","createContext","defaultValue","contextId","Consumer","contextValue","Provider","subs","ctx","_props","old","splice","error","ctor","handled","getDerivedStateFromError","setState","componentDidCatch","update","callback","s","forceUpdate","Promise","then","bind","resolve","setTimeout","alert","remove","id","getElementById","outerHTML","add","text","alertStyle","countdown","alertNode","hash","classList","body","str","charCodeAt","storage","usage","total","k","localStorage","Object","hasOwnProperty","createStorageBox","metadata","createdAt","Date","now","removeItem","set","setItem","JSON","stringify","get","getItem","parse","reset","clear","window","dispatchEvent","CustomEvent","lang","dict","possibleLang","en","es","fr","sk","getDefaultLang","querySelector","content","getCurrentLang","me","fetchDict","http","t","params","count","keys","getOwnPropertyNames","map","filter","isNaN","match","forEach","rid","notifications","loadNotifications","matchNotification","notif","target","n","fromMessage","removeMatchingNotifications","all","delete","reject","hasBookmark","bookmarks","bid","addBookmark","post","user","removeBookmark","util","genId","seed","toString","Math","random","id2Int","parseInt","urlRegExp","getUrl","txt","url","startsWith","link","endsWith","limitStrSize","limit","humanFullDate","timestamp","d","getTime","getTimezoneOffset","toISOString","humanTime","duration","abs","round","floor","split","getGroupId","groups","router","entity","entityType","getId","group","getGroupName","find","g","pop","console","thumbnail","width","height","toApp","crop","defaultAvatar","reduce","colorHash","backgroundHash","c1","c2","reverse","join","logout","location","href","origin","is_it_enter","keyCode","code","route","action","backUrl","backUrlPrompt","entityUrl","search","isValidUrl","URL","_","getSubpath","baseURI","pathname","removeSubpath","path","RegExp","getParam","param","searchParams","substring","res","decodeURIComponent","getSegments","isOutside","includes","isEntity","getUrlComponents","components","navigate","warn","catch","history","replaceState","pushState","apiKey","sync","onClick","newTab","preventDefault","stopPropagation","closest","getAttribute","targetUrl","host","ctrlKey","open","getElementsByClassName","sendFile","formData","loadFn","progressFn","errorFn","xhr","XMLHttpRequest","setRequestHeader","status","response","statusText","upload","onprogress","loaded","send","nocache","h","fetch","method","headers","Headers","ok","json","err","contentType","request","put","fetchOptions","exception","message","api","info","Store","dbName","storeName","_dbp","openreq","indexedDB","onerror","onsuccess","result","onupgradeneeded","createObjectStore","_withIDBStore","db","transaction","oncomplete","onabort","objectStore","store","getDefaultStore","req","del","openKeyCursor","openCursor","continue","cache","CACHE_VERSION","cache_store","purgeOldCache","lastUsed","log","caches","removeMatching","openCache","matchAll","_api","_alert","_cache","_storage","_http","_me","_router","_util","_lang","FaIcon","regular","comment","bookmark","images","bell","solid","film","times","icon","family","rotation","_FaIcon","bundleURL","getBundleURLCached","getBundleURL","Error","matches","stack","getBaseURL","exports","require","loadBundlesLazy","bundles","LazyPromise","loadBundles","loadBundle","bundleLoaders","registerBundleLoader","loader","module","load","register","bundle","lastIndexOf","bundleLoader","resolved","executor","promise","onSuccess","onError","FileGrid","toggleFile","files","fileIndex","evt","currentTarget","renderMiniatureFile","file","filePath","contentUrl","progress","inWriter","removed","renderBigFile","nlg","default","start","MessageChild","msgElement","contains","scrollIntoView","block","behavior","isRemoved","isPublic","edit","avatar","MessageChildren","onNewChild","loadMessage","displayPreviousChildren","displayNextChildren","firstDisplayedChild","lastDisplayedChild","newMsg","detail","parent","prevState","childMessages","msgIndex","findIndex","max","min","MessageHead","author","isChild","MessageFooter","editMessage","toggle","deleteMessage","openPublicLink","shareMessage","isInFront","publishInGroup","getEmbedUrl","splits","TwitchEmbed","embedUrl","hostname","BandCampEmbed","revealed","preview","GenericEmbed","playBtnClass","EmbedBlock","getPreview","segments","videoId","encodeURIComponent","__html","MessageBody","displayMessageText","trim","shift","gotPreview","previewUrl","title","Writer","sendMessage","genPreview","postMessage","putMessage","onKeyPress","inputImages","inputVideo","uploadFile","addFile","removeFile","updateFile","manageWorkers","removeWorker","addWorker","writerId","workers","workerManager","setInterval","clearInterval","doGenPreview","scrollHeight","links","f","messageId","msg","sending","lastActivityDate","inputGenericFile","mimetype","input","display","accept","click","multiple","from","inputFile","navigator","hardwareConcurrency","w","worker","workerId","imageService","handleImage","fileId","FormData","append","focus","image","video","pdf","cancel","Message","getComponentClass","cancelEdit","onEditMessage","token","cn","confirm","resetGroupDisplay","displayWriter","preMessageHeadComponent","postMessageComponent","MessageParent","scrollTo","MessagePreview","getAvatar","src","tabindex","MessageSearchResult","getMiniature","getLink","displayMessageTitle","displayAuthorName","authorName","words","searchTerms","lines","hashtags","_FileGrid","_MessageBody","_MessageFooter","_MessageParent","_MessageChild","_MessageChildren","_MessageHead","_MessagePreview","_MessageSearchResult","_EmbedBlock","GroupSearch","groupId","messages","totalMessages","loadMessages","GroupsDropdownNavbar","CreateGroup","postNewGroup","secretKey","GroupBoard","screen","scrollTop","pageYOffset","page","scroll_cooldown","onScroll","onNewParent","new_loaded","msgList","m","getComputedStyle","BookmarkBoard","loadBookmarks","GroupSettings","updateSettings","leaveGroup","leave","resetSecretKey","hydratedUsers","default_group","protocol","users","UserSettings","destroyAccount","inputAvatar","resetApiKey","blob","login","password","notification_emails","Settings","_GroupSettings","_Settings","_UserSettings","MainContent","Notification","setMiniatureOnError","getAction","getTarget","getTitle","imgSrc","fromUser","getObject","fromGroup","Search","group_id","normalize","entityId","Share","currentUrl","groupSelect","GroupTitle","_CreateGroup","_GroupBoard","_BookmarkBoard","_MainContent","_Notification","_Search","_Share","_GroupTitle","Navbar","clickBackButton","NotificationsDropdownNavbar","clearAllNotifications","_GroupSearch","_GroupsDropdownNavbar","_Navbar","_NotificationsDropdownNavbar","Login","showAlert","sendLoginForm","sendPasswordReset","showPasswordReset","mail","api_key","showResetPassword","zusam_logo","ResetPassword","sendNewPassword","passwordConfirmation","Signup","inviteKey","sendSignupForm","invite_key","StopNotificationEmails","Public","_Login","_ResetPassword","_Signup","_StopNotificationEmails","_Public","App","onRouterStateChange","querySelectorAll","serviceWorker","getRegistrations","registrations","registration","unregister","scope","script","async","charset","onload","getElementsByTagName"],"mappings":"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","file":"app.9e7c15a5.js","sourceRoot":"../src","sourcesContent":["import { _catchError } from './diff/catch-error';\n\n/**\n * The `option` object can potentially contain callback functions\n * that are called during various stages of our renderer. This is the\n * foundation on which all our addons like `preact/debug`, `preact/compat`,\n * and `preact/hooks` are based on. See the `Options` type in `internal.d.ts`\n * for a full list of available option hooks (most editors/IDEs allow you to\n * ctrl+click or cmd+click on mac the type definition below).\n * @type {import('./internal').Options}\n */\nconst options = {\n\t_catchError,\n\t_vnodeId: 0\n};\n\nexport default options;\n","export const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\nexport const IS_NON_DIMENSIONAL = /acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;\n","import options from './options';\n\n/**\n * Create an virtual node (used for JSX)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * constructor for this virtual node\n * @param {object | null | undefined} [props] The properties of the virtual node\n * @param {Array<import('.').ComponentChildren>} [children] The children of the virtual node\n * @returns {import('./internal').VNode}\n */\nexport function createElement(type, props, children) {\n\tlet normalizedProps = {},\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\t// https://github.com/preactjs/preact/issues/1916\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\t// If a Component VNode, check for and apply defaultProps\n\t// Note: type may be undefined in development, must never error here.\n\tif (typeof type == 'function' && type.defaultProps != null) {\n\t\tfor (i in type.defaultProps) {\n\t\t\tif (normalizedProps[i] === undefined) {\n\t\t\t\tnormalizedProps[i] = type.defaultProps[i];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn createVNode(type, normalizedProps, key, ref, null);\n}\n\n/**\n * Create a VNode (used internally by Preact)\n * @param {import('./internal').VNode[\"type\"]} type The node name or Component\n * Constructor for this virtual node\n * @param {object | string | number | null} props The properties of this virtual node.\n * If this virtual node represents a text node, this is the text of the node (string or number).\n * @param {string | number | null} key The key for this virtual node, used when\n * diffing it against its children\n * @param {import('./internal').VNode[\"ref\"]} ref The ref property that will\n * receive a reference to its created child\n * @returns {import('./internal').VNode}\n */\nexport function createVNode(type, props, key, ref, original) {\n\t// V8 seems to be better at detecting type shapes if the object is allocated from the same call site\n\t// Do not inline into createElement and coerceToVNode!\n\tconst vnode = {\n\t\ttype,\n\t\tprops,\n\t\tkey,\n\t\tref,\n\t\t_children: null,\n\t\t_parent: null,\n\t\t_depth: 0,\n\t\t_dom: null,\n\t\t// _nextDom must be initialized to undefined b/c it will eventually\n\t\t// be set to dom.nextSibling which can return `null` and it is important\n\t\t// to be able to distinguish between an uninitialized _nextDom and\n\t\t// a _nextDom that has been set to `null`\n\t\t_nextDom: undefined,\n\t\t_component: null,\n\t\t_hydrating: null,\n\t\tconstructor: undefined,\n\t\t_original: original == null ? ++options._vnodeId : original\n\t};\n\n\tif (options.vnode != null) options.vnode(vnode);\n\n\treturn vnode;\n}\n\nexport function createRef() {\n\treturn { current: null };\n}\n\nexport function Fragment(props) {\n\treturn props.children;\n}\n\n/**\n * Check if a the argument is a valid Preact VNode.\n * @param {*} vnode\n * @returns {vnode is import('./internal').VNode}\n */\nexport const isValidElement = vnode =>\n\tvnode != null && vnode.constructor === undefined;\n","import { assign } from './util';\nimport { diff, commitRoot } from './diff/index';\nimport options from './options';\nimport { Fragment } from './create-element';\n\n/**\n * Base Component class. Provides `setState()` and `forceUpdate()`, which\n * trigger rendering\n * @param {object} props The initial component props\n * @param {object} context The initial context from parent components'\n * getChildContext\n */\nexport function Component(props, context) {\n\tthis.props = props;\n\tthis.context = context;\n}\n\n/**\n * Update component state and schedule a re-render.\n * @this {import('./internal').Component}\n * @param {object | ((s: object, p: object) => object)} update A hash of state\n * properties to update with new values or a function that given the current\n * state and props returns a new partial state\n * @param {() => void} [callback] A function to be called once component state is\n * updated\n */\nComponent.prototype.setState = function(update, callback) {\n\t// only clone state when copying to nextState the first time.\n\tlet s;\n\tif (this._nextState != null && this._nextState !== this.state) {\n\t\ts = this._nextState;\n\t} else {\n\t\ts = this._nextState = assign({}, this.state);\n\t}\n\n\tif (typeof update == 'function') {\n\t\t// Some libraries like `immer` mark the current state as readonly,\n\t\t// preventing us from mutating it, so we need to clone it. See #2716\n\t\tupdate = update(assign({}, s), this.props);\n\t}\n\n\tif (update) {\n\t\tassign(s, update);\n\t}\n\n\t// Skip update if updater function returned null\n\tif (update == null) return;\n\n\tif (this._vnode) {\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Immediately perform a synchronous re-render of the component\n * @this {import('./internal').Component}\n * @param {() => void} [callback] A function to be called after component is\n * re-rendered\n */\nComponent.prototype.forceUpdate = function(callback) {\n\tif (this._vnode) {\n\t\t// Set render mode so that we can differentiate where the render request\n\t\t// is coming from. We need this because forceUpdate should never call\n\t\t// shouldComponentUpdate\n\t\tthis._force = true;\n\t\tif (callback) this._renderCallbacks.push(callback);\n\t\tenqueueRender(this);\n\t}\n};\n\n/**\n * Accepts `props` and `state`, and returns a new Virtual DOM tree to build.\n * Virtual DOM is generally constructed via [JSX](http://jasonformat.com/wtf-is-jsx).\n * @param {object} props Props (eg: JSX attributes) received from parent\n * element/component\n * @param {object} state The component's current state\n * @param {object} context Context object, as returned by the nearest\n * ancestor's `getChildContext()`\n * @returns {import('./index').ComponentChildren | void}\n */\nComponent.prototype.render = Fragment;\n\n/**\n * @param {import('./internal').VNode} vnode\n * @param {number | null} [childIndex]\n */\nexport function getDomSibling(vnode, childIndex) {\n\tif (childIndex == null) {\n\t\t// Use childIndex==null as a signal to resume the search from the vnode's sibling\n\t\treturn vnode._parent\n\t\t\t? getDomSibling(vnode._parent, vnode._parent._children.indexOf(vnode) + 1)\n\t\t\t: null;\n\t}\n\n\tlet sibling;\n\tfor (; childIndex < vnode._children.length; childIndex++) {\n\t\tsibling = vnode._children[childIndex];\n\n\t\tif (sibling != null && sibling._dom != null) {\n\t\t\t// Since updateParentDomPointers keeps _dom pointer correct,\n\t\t\t// we can rely on _dom to tell us if this subtree contains a\n\t\t\t// rendered DOM node, and what the first rendered DOM node is\n\t\t\treturn sibling._dom;\n\t\t}\n\t}\n\n\t// If we get here, we have not found a DOM node in this vnode's children.\n\t// We must resume from this vnode's sibling (in it's parent _children array)\n\t// Only climb up and search the parent if we aren't searching through a DOM\n\t// VNode (meaning we reached the DOM parent of the original vnode that began\n\t// the search)\n\treturn typeof vnode.type == 'function' ? getDomSibling(vnode) : null;\n}\n\n/**\n * Trigger in-place re-rendering of a component.\n * @param {import('./internal').Component} component The component to rerender\n */\nfunction renderComponent(component) {\n\tlet vnode = component._vnode,\n\t\toldDom = vnode._dom,\n\t\tparentDom = component._parentDom;\n\n\tif (parentDom) {\n\t\tlet commitQueue = [];\n\t\tconst oldVNode = assign({}, vnode);\n\t\toldVNode._original = vnode._original + 1;\n\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tvnode,\n\t\t\toldVNode,\n\t\t\tcomponent._globalContext,\n\t\t\tparentDom.ownerSVGElement !== undefined,\n\t\t\tvnode._hydrating != null ? [oldDom] : null,\n\t\t\tcommitQueue,\n\t\t\toldDom == null ? getDomSibling(vnode) : oldDom,\n\t\t\tvnode._hydrating\n\t\t);\n\t\tcommitRoot(commitQueue, vnode);\n\n\t\tif (vnode._dom != oldDom) {\n\t\t\tupdateParentDomPointers(vnode);\n\t\t}\n\t}\n}\n\n/**\n * @param {import('./internal').VNode} vnode\n */\nfunction updateParentDomPointers(vnode) {\n\tif ((vnode = vnode._parent) != null && vnode._component != null) {\n\t\tvnode._dom = vnode._component.base = null;\n\t\tfor (let i = 0; i < vnode._children.length; i++) {\n\t\t\tlet child = vnode._children[i];\n\t\t\tif (child != null && child._dom != null) {\n\t\t\t\tvnode._dom = vnode._component.base = child._dom;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn updateParentDomPointers(vnode);\n\t}\n}\n\n/**\n * The render queue\n * @type {Array<import('./internal').Component>}\n */\nlet rerenderQueue = [];\n\n/**\n * Asynchronously schedule a callback\n * @type {(cb: () => void) => void}\n */\n/* istanbul ignore next */\n// Note the following line isn't tree-shaken by rollup cuz of rollup/rollup#2566\nconst defer =\n\ttypeof Promise == 'function'\n\t\t? Promise.prototype.then.bind(Promise.resolve())\n\t\t: setTimeout;\n\n/*\n * The value of `Component.debounce` must asynchronously invoke the passed in callback. It is\n * important that contributors to Preact can consistently reason about what calls to `setState`, etc.\n * do, and when their effects will be applied. See the links below for some further reading on designing\n * asynchronous APIs.\n * * [Designing APIs for Asynchrony](https://blog.izs.me/2013/08/designing-apis-for-asynchrony)\n * * [Callbacks synchronous and asynchronous](https://blog.ometer.com/2011/07/24/callbacks-synchronous-and-asynchronous/)\n */\n\nlet prevDebounce;\n\n/**\n * Enqueue a rerender of a component\n * @param {import('./internal').Component} c The component to rerender\n */\nexport function enqueueRender(c) {\n\tif (\n\t\t(!c._dirty &&\n\t\t\t(c._dirty = true) &&\n\t\t\trerenderQueue.push(c) &&\n\t\t\t!process._rerenderCount++) ||\n\t\tprevDebounce !== options.debounceRendering\n\t) {\n\t\tprevDebounce = options.debounceRendering;\n\t\t(prevDebounce || defer)(process);\n\t}\n}\n\n/** Flush the render queue by rerendering all queued components */\nfunction process() {\n\tlet queue;\n\twhile ((process._rerenderCount = rerenderQueue.length)) {\n\t\tqueue = rerenderQueue.sort((a, b) => a._vnode._depth - b._vnode._depth);\n\t\trerenderQueue = [];\n\t\t// Don't update `renderCount` yet. Keep its value non-zero to prevent unnecessary\n\t\t// process() calls from getting scheduled while `queue` is still being consumed.\n\t\tqueue.some(c => {\n\t\t\tif (c._dirty) renderComponent(c);\n\t\t});\n\t}\n}\nprocess._rerenderCount = 0;\n","import { enqueueRender } from './component';\n\nexport let i = 0;\n\nexport function createContext(defaultValue, contextId) {\n\tcontextId = '__cC' + i++;\n\n\tconst context = {\n\t\t_id: contextId,\n\t\t_defaultValue: defaultValue,\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tConsumer(props, contextValue) {\n\t\t\t// return props.children(\n\t\t\t// \tcontext[contextId] ? context[contextId].props.value : defaultValue\n\t\t\t// );\n\t\t\treturn props.children(contextValue);\n\t\t},\n\t\t/** @type {import('./internal').FunctionComponent} */\n\t\tProvider(props) {\n\t\t\tif (!this.getChildContext) {\n\t\t\t\tlet subs = [];\n\t\t\t\tlet ctx = {};\n\t\t\t\tctx[contextId] = this;\n\n\t\t\t\tthis.getChildContext = () => ctx;\n\n\t\t\t\tthis.shouldComponentUpdate = function(_props) {\n\t\t\t\t\tif (this.props.value !== _props.value) {\n\t\t\t\t\t\t// I think the forced value propagation here was only needed when `options.debounceRendering` was being bypassed:\n\t\t\t\t\t\t// https://github.com/preactjs/preact/commit/4d339fb803bea09e9f198abf38ca1bf8ea4b7771#diff-54682ce380935a717e41b8bfc54737f6R358\n\t\t\t\t\t\t// In those cases though, even with the value corrected, we're double-rendering all nodes.\n\t\t\t\t\t\t// It might be better to just tell folks not to use force-sync mode.\n\t\t\t\t\t\t// Currently, using `useContext()` in a class component will overwrite its `this.context` value.\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\n\t\t\t\t\t\t// subs.some(c => {\n\t\t\t\t\t\t// \tc.context[contextId] = _props.value;\n\t\t\t\t\t\t// \tenqueueRender(c);\n\t\t\t\t\t\t// });\n\t\t\t\t\t\tsubs.some(enqueueRender);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tthis.sub = c => {\n\t\t\t\t\tsubs.push(c);\n\t\t\t\t\tlet old = c.componentWillUnmount;\n\t\t\t\t\tc.componentWillUnmount = () => {\n\t\t\t\t\t\tsubs.splice(subs.indexOf(c), 1);\n\t\t\t\t\t\tif (old) old.call(c);\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn props.children;\n\t\t}\n\t};\n\n\t// Devtools needs access to the context object when it\n\t// encounters a Provider. This is necessary to support\n\t// setting `displayName` on the context object instead\n\t// of on the component itself. See:\n\t// https://reactjs.org/docs/context.html#contextdisplayname\n\n\treturn (context.Provider._contextRef = context.Consumer.contextType = context);\n}\n","/**\n * Assign properties from `props` to `obj`\n * @template O, P The obj and props types\n * @param {O} obj The object to copy properties to\n * @param {P} props The object to copy properties from\n * @returns {O & P}\n */\nexport function assign(obj, props) {\n\t// @ts-ignore We change the type of `obj` to be `O & P`\n\tfor (let i in props) obj[i] = props[i];\n\treturn /** @type {O & P} */ (obj);\n}\n\n/**\n * Remove a child node from its parent if attached. This is a workaround for\n * IE11 which doesn't support `Element.prototype.remove()`. Using this function\n * is smaller than including a dedicated polyfill.\n * @param {Node} node The node to remove\n */\nexport function removeNode(node) {\n\tlet parentNode = node.parentNode;\n\tif (parentNode) parentNode.removeChild(node);\n}\n","import { diff, unmount, applyRef } from './index';\nimport { createVNode, Fragment } from '../create-element';\nimport { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { getDomSibling } from '../component';\n\n/**\n * Diff the children of a virtual node\n * @param {import('../internal').PreactElement} parentDom The DOM element whose\n * children are being diffed\n * @param {import('../internal').ComponentChildren[]} renderResult\n * @param {import('../internal').VNode} newParentVNode The new virtual\n * node whose children should be diff'ed against oldParentVNode\n * @param {import('../internal').VNode} oldParentVNode The old virtual\n * node whose children should be diff'ed against newParentVNode\n * @param {object} globalContext The current context object - modified by getChildContext\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} isHydrating Whether or not we are in hydration\n */\nexport function diffChildren(\n\tparentDom,\n\trenderResult,\n\tnewParentVNode,\n\toldParentVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet i, j, oldVNode, childVNode, newDom, firstChildDom, refs;\n\n\t// This is a compression of oldParentVNode!=null && oldParentVNode != EMPTY_OBJ && oldParentVNode._children || EMPTY_ARR\n\t// as EMPTY_OBJ._children should be `undefined`.\n\tlet oldChildren = (oldParentVNode && oldParentVNode._children) || EMPTY_ARR;\n\n\tlet oldChildrenLength = oldChildren.length;\n\n\tnewParentVNode._children = [];\n\tfor (i = 0; i < renderResult.length; i++) {\n\t\tchildVNode = renderResult[i];\n\n\t\tif (childVNode == null || typeof childVNode == 'boolean') {\n\t\t\tchildVNode = newParentVNode._children[i] = null;\n\t\t}\n\t\t// If this newVNode is being reused (e.g. <div>{reuse}{reuse}</div>) in the same diff,\n\t\t// or we are rendering a component (e.g. setState) copy the oldVNodes so it can have\n\t\t// it's own DOM & etc. pointers\n\t\telse if (typeof childVNode == 'string' || typeof childVNode == 'number') {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tnull,\n\t\t\t\tchildVNode,\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tchildVNode\n\t\t\t);\n\t\t} else if (Array.isArray(childVNode)) {\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tFragment,\n\t\t\t\t{ children: childVNode },\n\t\t\t\tnull,\n\t\t\t\tnull,\n\t\t\t\tnull\n\t\t\t);\n\t\t} else if (childVNode._depth > 0) {\n\t\t\t// VNode is already in use, clone it. This can happen in the following\n\t\t\t// scenario:\n\t\t\t//   const reuse = <div />\n\t\t\t//   <div>{reuse}<span />{reuse}</div>\n\t\t\tchildVNode = newParentVNode._children[i] = createVNode(\n\t\t\t\tchildVNode.type,\n\t\t\t\tchildVNode.props,\n\t\t\t\tchildVNode.key,\n\t\t\t\tnull,\n\t\t\t\tchildVNode._original\n\t\t\t);\n\t\t} else {\n\t\t\tchildVNode = newParentVNode._children[i] = childVNode;\n\t\t}\n\n\t\t// Terser removes the `continue` here and wraps the loop body\n\t\t// in a `if (childVNode) { ... } condition\n\t\tif (childVNode == null) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tchildVNode._parent = newParentVNode;\n\t\tchildVNode._depth = newParentVNode._depth + 1;\n\n\t\t// Check if we find a corresponding element in oldChildren.\n\t\t// If found, delete the array item by setting to `undefined`.\n\t\t// We use `undefined`, as `null` is reserved for empty placeholders\n\t\t// (holes).\n\t\toldVNode = oldChildren[i];\n\n\t\tif (\n\t\t\toldVNode === null ||\n\t\t\t(oldVNode &&\n\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\tchildVNode.type === oldVNode.type)\n\t\t) {\n\t\t\toldChildren[i] = undefined;\n\t\t} else {\n\t\t\t// Either oldVNode === undefined or oldChildrenLength > 0,\n\t\t\t// so after this loop oldVNode == null or oldVNode is a valid value.\n\t\t\tfor (j = 0; j < oldChildrenLength; j++) {\n\t\t\t\toldVNode = oldChildren[j];\n\t\t\t\t// If childVNode is unkeyed, we only match similarly unkeyed nodes, otherwise we match by key.\n\t\t\t\t// We always match by type (in either case).\n\t\t\t\tif (\n\t\t\t\t\toldVNode &&\n\t\t\t\t\tchildVNode.key == oldVNode.key &&\n\t\t\t\t\tchildVNode.type === oldVNode.type\n\t\t\t\t) {\n\t\t\t\t\toldChildren[j] = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\toldVNode = null;\n\t\t\t}\n\t\t}\n\n\t\toldVNode = oldVNode || EMPTY_OBJ;\n\n\t\t// Morph the old element into the new one, but don't append it to the dom yet\n\t\tdiff(\n\t\t\tparentDom,\n\t\t\tchildVNode,\n\t\t\toldVNode,\n\t\t\tglobalContext,\n\t\t\tisSvg,\n\t\t\texcessDomChildren,\n\t\t\tcommitQueue,\n\t\t\toldDom,\n\t\t\tisHydrating\n\t\t);\n\n\t\tnewDom = childVNode._dom;\n\n\t\tif ((j = childVNode.ref) && oldVNode.ref != j) {\n\t\t\tif (!refs) refs = [];\n\t\t\tif (oldVNode.ref) refs.push(oldVNode.ref, null, childVNode);\n\t\t\trefs.push(j, childVNode._component || newDom, childVNode);\n\t\t}\n\n\t\tif (newDom != null) {\n\t\t\tif (firstChildDom == null) {\n\t\t\t\tfirstChildDom = newDom;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\ttypeof childVNode.type == 'function' &&\n\t\t\t\tchildVNode._children != null && // Can be null if childVNode suspended\n\t\t\t\tchildVNode._children === oldVNode._children\n\t\t\t) {\n\t\t\t\tchildVNode._nextDom = oldDom = reorderChildren(\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldDom,\n\t\t\t\t\tparentDom\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tchildVNode,\n\t\t\t\t\toldVNode,\n\t\t\t\t\toldChildren,\n\t\t\t\t\tnewDom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Browsers will infer an option's `value` from `textContent` when\n\t\t\t// no value is present. This essentially bypasses our code to set it\n\t\t\t// later in `diff()`. It works fine in all browsers except for IE11\n\t\t\t// where it breaks setting `select.value`. There it will be always set\n\t\t\t// to an empty string. Re-applying an options value will fix that, so\n\t\t\t// there are probably some internal data structures that aren't\n\t\t\t// updated properly.\n\t\t\t//\n\t\t\t// To fix it we make sure to reset the inferred value, so that our own\n\t\t\t// value check in `diff()` won't be skipped.\n\t\t\tif (!isHydrating && newParentVNode.type === 'option') {\n\t\t\t\t// @ts-ignore We have validated that the type of parentDOM is 'option'\n\t\t\t\t// in the above check\n\t\t\t\tparentDom.value = '';\n\t\t\t} else if (typeof newParentVNode.type == 'function') {\n\t\t\t\t// Because the newParentVNode is Fragment-like, we need to set it's\n\t\t\t\t// _nextDom property to the nextSibling of its last child DOM node.\n\t\t\t\t//\n\t\t\t\t// `oldDom` contains the correct value here because if the last child\n\t\t\t\t// is a Fragment-like, then oldDom has already been set to that child's _nextDom.\n\t\t\t\t// If the last child is a DOM VNode, then oldDom will be set to that DOM\n\t\t\t\t// node's nextSibling.\n\t\t\t\tnewParentVNode._nextDom = oldDom;\n\t\t\t}\n\t\t} else if (\n\t\t\toldDom &&\n\t\t\toldVNode._dom == oldDom &&\n\t\t\toldDom.parentNode != parentDom\n\t\t) {\n\t\t\t// The above condition is to handle null placeholders. See test in placeholder.test.js:\n\t\t\t// `efficiently replace null placeholders in parent rerenders`\n\t\t\toldDom = getDomSibling(oldVNode);\n\t\t}\n\t}\n\n\tnewParentVNode._dom = firstChildDom;\n\n\t// Remove remaining oldChildren if there are any.\n\tfor (i = oldChildrenLength; i--; ) {\n\t\tif (oldChildren[i] != null) {\n\t\t\tif (\n\t\t\t\ttypeof newParentVNode.type == 'function' &&\n\t\t\t\toldChildren[i]._dom != null &&\n\t\t\t\toldChildren[i]._dom == newParentVNode._nextDom\n\t\t\t) {\n\t\t\t\t// If the newParentVNode.__nextDom points to a dom node that is about to\n\t\t\t\t// be unmounted, then get the next sibling of that vnode and set\n\t\t\t\t// _nextDom to it\n\t\t\t\tnewParentVNode._nextDom = getDomSibling(oldParentVNode, i + 1);\n\t\t\t}\n\n\t\t\tunmount(oldChildren[i], oldChildren[i]);\n\t\t}\n\t}\n\n\t// Set refs only after unmount\n\tif (refs) {\n\t\tfor (i = 0; i < refs.length; i++) {\n\t\t\tapplyRef(refs[i], refs[++i], refs[++i]);\n\t\t}\n\t}\n}\n\nfunction reorderChildren(childVNode, oldDom, parentDom) {\n\tfor (let tmp = 0; tmp < childVNode._children.length; tmp++) {\n\t\tlet vnode = childVNode._children[tmp];\n\t\tif (vnode) {\n\t\t\t// We typically enter this code path on sCU bailout, where we copy\n\t\t\t// oldVNode._children to newVNode._children. If that is the case, we need\n\t\t\t// to update the old children's _parent pointer to point to the newVNode\n\t\t\t// (childVNode here).\n\t\t\tvnode._parent = childVNode;\n\n\t\t\tif (typeof vnode.type == 'function') {\n\t\t\t\toldDom = reorderChildren(vnode, oldDom, parentDom);\n\t\t\t} else {\n\t\t\t\toldDom = placeChild(\n\t\t\t\t\tparentDom,\n\t\t\t\t\tvnode,\n\t\t\t\t\tvnode,\n\t\t\t\t\tchildVNode._children,\n\t\t\t\t\tvnode._dom,\n\t\t\t\t\toldDom\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn oldDom;\n}\n\n/**\n * Flatten and loop through the children of a virtual node\n * @param {import('../index').ComponentChildren} children The unflattened\n * children of a virtual node\n * @returns {import('../internal').VNode[]}\n */\nexport function toChildArray(children, out) {\n\tout = out || [];\n\tif (children == null || typeof children == 'boolean') {\n\t} else if (Array.isArray(children)) {\n\t\tchildren.some(child => {\n\t\t\ttoChildArray(child, out);\n\t\t});\n\t} else {\n\t\tout.push(children);\n\t}\n\treturn out;\n}\n\nfunction placeChild(\n\tparentDom,\n\tchildVNode,\n\toldVNode,\n\toldChildren,\n\tnewDom,\n\toldDom\n) {\n\tlet nextDom;\n\tif (childVNode._nextDom !== undefined) {\n\t\t// Only Fragments or components that return Fragment like VNodes will\n\t\t// have a non-undefined _nextDom. Continue the diff from the sibling\n\t\t// of last DOM child of this child VNode\n\t\tnextDom = childVNode._nextDom;\n\n\t\t// Eagerly cleanup _nextDom. We don't need to persist the value because\n\t\t// it is only used by `diffChildren` to determine where to resume the diff after\n\t\t// diffing Components and Fragments. Once we store it the nextDOM local var, we\n\t\t// can clean up the property\n\t\tchildVNode._nextDom = undefined;\n\t} else if (\n\t\toldVNode == null ||\n\t\tnewDom != oldDom ||\n\t\tnewDom.parentNode == null\n\t) {\n\t\touter: if (oldDom == null || oldDom.parentNode !== parentDom) {\n\t\t\tparentDom.appendChild(newDom);\n\t\t\tnextDom = null;\n\t\t} else {\n\t\t\t// `j<oldChildrenLength; j+=2` is an alternative to `j++<oldChildrenLength/2`\n\t\t\tfor (\n\t\t\t\tlet sibDom = oldDom, j = 0;\n\t\t\t\t(sibDom = sibDom.nextSibling) && j < oldChildren.length;\n\t\t\t\tj += 2\n\t\t\t) {\n\t\t\t\tif (sibDom == newDom) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparentDom.insertBefore(newDom, oldDom);\n\t\t\tnextDom = oldDom;\n\t\t}\n\t}\n\n\t// If we have pre-calculated the nextDOM node, use it. Else calculate it now\n\t// Strictly check for `undefined` here cuz `null` is a valid value of `nextDom`.\n\t// See more detail in create-element.js:createVNode\n\tif (nextDom !== undefined) {\n\t\toldDom = nextDom;\n\t} else {\n\t\toldDom = newDom.nextSibling;\n\t}\n\n\treturn oldDom;\n}\n","import { IS_NON_DIMENSIONAL } from '../constants';\nimport options from '../options';\n\n/**\n * Diff the old and new properties of a VNode and apply changes to the DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to apply\n * changes to\n * @param {object} newProps The new props\n * @param {object} oldProps The old props\n * @param {boolean} isSvg Whether or not this node is an SVG node\n * @param {boolean} hydrate Whether or not we are in hydration mode\n */\nexport function diffProps(dom, newProps, oldProps, isSvg, hydrate) {\n\tlet i;\n\n\tfor (i in oldProps) {\n\t\tif (i !== 'children' && i !== 'key' && !(i in newProps)) {\n\t\t\tsetProperty(dom, i, null, oldProps[i], isSvg);\n\t\t}\n\t}\n\n\tfor (i in newProps) {\n\t\tif (\n\t\t\t(!hydrate || typeof newProps[i] == 'function') &&\n\t\t\ti !== 'children' &&\n\t\t\ti !== 'key' &&\n\t\t\ti !== 'value' &&\n\t\t\ti !== 'checked' &&\n\t\t\toldProps[i] !== newProps[i]\n\t\t) {\n\t\t\tsetProperty(dom, i, newProps[i], oldProps[i], isSvg);\n\t\t}\n\t}\n}\n\nfunction setStyle(style, key, value) {\n\tif (key[0] === '-') {\n\t\tstyle.setProperty(key, value);\n\t} else if (value == null) {\n\t\tstyle[key] = '';\n\t} else if (typeof value != 'number' || IS_NON_DIMENSIONAL.test(key)) {\n\t\tstyle[key] = value;\n\t} else {\n\t\tstyle[key] = value + 'px';\n\t}\n}\n\n/**\n * Set a property value on a DOM node\n * @param {import('../internal').PreactElement} dom The DOM node to modify\n * @param {string} name The name of the property to set\n * @param {*} value The value to set the property to\n * @param {*} oldValue The old value the property had\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node or not\n */\nexport function setProperty(dom, name, value, oldValue, isSvg) {\n\tlet useCapture;\n\n\to: if (name === 'style') {\n\t\tif (typeof value == 'string') {\n\t\t\tdom.style.cssText = value;\n\t\t} else {\n\t\t\tif (typeof oldValue == 'string') {\n\t\t\t\tdom.style.cssText = oldValue = '';\n\t\t\t}\n\n\t\t\tif (oldValue) {\n\t\t\t\tfor (name in oldValue) {\n\t\t\t\t\tif (!(value && name in value)) {\n\t\t\t\t\t\tsetStyle(dom.style, name, '');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (value) {\n\t\t\t\tfor (name in value) {\n\t\t\t\t\tif (!oldValue || value[name] !== oldValue[name]) {\n\t\t\t\t\t\tsetStyle(dom.style, name, value[name]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Benchmark for comparison: https://esbench.com/bench/574c954bdb965b9a00965ac6\n\telse if (name[0] === 'o' && name[1] === 'n') {\n\t\tuseCapture = name !== (name = name.replace(/Capture$/, ''));\n\n\t\t// Infer correct casing for DOM built-in events:\n\t\tif (name.toLowerCase() in dom) name = name.toLowerCase().slice(2);\n\t\telse name = name.slice(2);\n\n\t\tif (!dom._listeners) dom._listeners = {};\n\t\tdom._listeners[name + useCapture] = value;\n\n\t\tif (value) {\n\t\t\tif (!oldValue) {\n\t\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\t\tdom.addEventListener(name, handler, useCapture);\n\t\t\t}\n\t\t} else {\n\t\t\tconst handler = useCapture ? eventProxyCapture : eventProxy;\n\t\t\tdom.removeEventListener(name, handler, useCapture);\n\t\t}\n\t} else if (name !== 'dangerouslySetInnerHTML') {\n\t\tif (isSvg) {\n\t\t\t// Normalize incorrect prop usage for SVG:\n\t\t\t// - xlink:href / xlinkHref --> href (xlink:href was removed from SVG and isn't needed)\n\t\t\t// - className --> class\n\t\t\tname = name.replace(/xlink[H:h]/, 'h').replace(/sName$/, 's');\n\t\t} else if (\n\t\t\tname !== 'href' &&\n\t\t\tname !== 'list' &&\n\t\t\tname !== 'form' &&\n\t\t\tname !== 'download' &&\n\t\t\tname in dom\n\t\t) {\n\t\t\ttry {\n\t\t\t\tdom[name] = value == null ? '' : value;\n\t\t\t\t// labelled break is 1b smaller here than a return statement (sorry)\n\t\t\t\tbreak o;\n\t\t\t} catch (e) {}\n\t\t}\n\n\t\t// ARIA-attributes have a different notion of boolean values.\n\t\t// The value `false` is different from the attribute not\n\t\t// existing on the DOM, so we can't remove it. For non-boolean\n\t\t// ARIA-attributes we could treat false as a removal, but the\n\t\t// amount of exceptions would cost us too many bytes. On top of\n\t\t// that other VDOM frameworks also always stringify `false`.\n\n\t\tif (typeof value === 'function') {\n\t\t\t// never serialize functions as attribute values\n\t\t} else if (\n\t\t\tvalue != null &&\n\t\t\t(value !== false || (name[0] === 'a' && name[1] === 'r'))\n\t\t) {\n\t\t\tdom.setAttribute(name, value);\n\t\t} else {\n\t\t\tdom.removeAttribute(name);\n\t\t}\n\t}\n}\n\n/**\n * Proxy an event to hooked event handlers\n * @param {Event} e The event object from the browser\n * @private\n */\nfunction eventProxy(e) {\n\tthis._listeners[e.type + false](options.event ? options.event(e) : e);\n}\n\nfunction eventProxyCapture(e) {\n\tthis._listeners[e.type + true](options.event ? options.event(e) : e);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from '../constants';\nimport { Component } from '../component';\nimport { Fragment } from '../create-element';\nimport { diffChildren } from './children';\nimport { diffProps, setProperty } from './props';\nimport { assign, removeNode } from '../util';\nimport options from '../options';\n\n/**\n * Diff two virtual nodes and apply proper changes to the DOM\n * @param {import('../internal').PreactElement} parentDom The parent of the DOM element\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object. Modified by getChildContext\n * @param {boolean} isSvg Whether or not this element is an SVG node\n * @param {Array<import('../internal').PreactElement>} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').PreactElement} oldDom The current attached DOM\n * element any new dom elements should be placed around. Likely `null` on first\n * render (except when hydrating). Can be a sibling DOM element when diffing\n * Fragments that have siblings. In most cases, it starts out as `oldChildren[0]._dom`.\n * @param {boolean} [isHydrating] Whether or not we are in hydration\n */\nexport function diff(\n\tparentDom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\toldDom,\n\tisHydrating\n) {\n\tlet tmp,\n\t\tnewType = newVNode.type;\n\n\t// When passing through createElement it assigns the object\n\t// constructor as undefined. This to prevent JSON-injection.\n\tif (newVNode.constructor !== undefined) return null;\n\n\t// If the previous diff bailed out, resume creating/hydrating.\n\tif (oldVNode._hydrating != null) {\n\t\tisHydrating = oldVNode._hydrating;\n\t\toldDom = newVNode._dom = oldVNode._dom;\n\t\t// if we resume, we want the tree to be \"unlocked\"\n\t\tnewVNode._hydrating = null;\n\t\texcessDomChildren = [oldDom];\n\t}\n\n\tif ((tmp = options._diff)) tmp(newVNode);\n\n\ttry {\n\t\touter: if (typeof newType == 'function') {\n\t\t\tlet c, isNew, oldProps, oldState, snapshot, clearProcessingException;\n\t\t\tlet newProps = newVNode.props;\n\n\t\t\t// Necessary for createContext api. Setting this property will pass\n\t\t\t// the context value as `this.context` just for this component.\n\t\t\ttmp = newType.contextType;\n\t\t\tlet provider = tmp && globalContext[tmp._id];\n\t\t\tlet componentContext = tmp\n\t\t\t\t? provider\n\t\t\t\t\t? provider.props.value\n\t\t\t\t\t: tmp._defaultValue\n\t\t\t\t: globalContext;\n\n\t\t\t// Get component and set it to `c`\n\t\t\tif (oldVNode._component) {\n\t\t\t\tc = newVNode._component = oldVNode._component;\n\t\t\t\tclearProcessingException = c._processingException = c._pendingError;\n\t\t\t} else {\n\t\t\t\t// Instantiate the new component\n\t\t\t\tif ('prototype' in newType && newType.prototype.render) {\n\t\t\t\t\t// @ts-ignore The check above verifies that newType is suppose to be constructed\n\t\t\t\t\tnewVNode._component = c = new newType(newProps, componentContext); // eslint-disable-line new-cap\n\t\t\t\t} else {\n\t\t\t\t\t// @ts-ignore Trust me, Component implements the interface we want\n\t\t\t\t\tnewVNode._component = c = new Component(newProps, componentContext);\n\t\t\t\t\tc.constructor = newType;\n\t\t\t\t\tc.render = doRender;\n\t\t\t\t}\n\t\t\t\tif (provider) provider.sub(c);\n\n\t\t\t\tc.props = newProps;\n\t\t\t\tif (!c.state) c.state = {};\n\t\t\t\tc.context = componentContext;\n\t\t\t\tc._globalContext = globalContext;\n\t\t\t\tisNew = c._dirty = true;\n\t\t\t\tc._renderCallbacks = [];\n\t\t\t}\n\n\t\t\t// Invoke getDerivedStateFromProps\n\t\t\tif (c._nextState == null) {\n\t\t\t\tc._nextState = c.state;\n\t\t\t}\n\t\t\tif (newType.getDerivedStateFromProps != null) {\n\t\t\t\tif (c._nextState == c.state) {\n\t\t\t\t\tc._nextState = assign({}, c._nextState);\n\t\t\t\t}\n\n\t\t\t\tassign(\n\t\t\t\t\tc._nextState,\n\t\t\t\t\tnewType.getDerivedStateFromProps(newProps, c._nextState)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\toldProps = c.props;\n\t\t\toldState = c.state;\n\n\t\t\t// Invoke pre-render lifecycle methods\n\t\t\tif (isNew) {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tc.componentWillMount != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillMount();\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidMount != null) {\n\t\t\t\t\tc._renderCallbacks.push(c.componentDidMount);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tnewType.getDerivedStateFromProps == null &&\n\t\t\t\t\tnewProps !== oldProps &&\n\t\t\t\t\tc.componentWillReceiveProps != null\n\t\t\t\t) {\n\t\t\t\t\tc.componentWillReceiveProps(newProps, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\t(!c._force &&\n\t\t\t\t\t\tc.shouldComponentUpdate != null &&\n\t\t\t\t\t\tc.shouldComponentUpdate(\n\t\t\t\t\t\t\tnewProps,\n\t\t\t\t\t\t\tc._nextState,\n\t\t\t\t\t\t\tcomponentContext\n\t\t\t\t\t\t) === false) ||\n\t\t\t\t\tnewVNode._original === oldVNode._original\n\t\t\t\t) {\n\t\t\t\t\tc.props = newProps;\n\t\t\t\t\tc.state = c._nextState;\n\t\t\t\t\t// More info about this here: https://gist.github.com/JoviDeCroock/bec5f2ce93544d2e6070ef8e0036e4e8\n\t\t\t\t\tif (newVNode._original !== oldVNode._original) c._dirty = false;\n\t\t\t\t\tc._vnode = newVNode;\n\t\t\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t\t\t\tnewVNode._children = oldVNode._children;\n\t\t\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\t\t\tcommitQueue.push(c);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\n\t\t\t\tif (c.componentWillUpdate != null) {\n\t\t\t\t\tc.componentWillUpdate(newProps, c._nextState, componentContext);\n\t\t\t\t}\n\n\t\t\t\tif (c.componentDidUpdate != null) {\n\t\t\t\t\tc._renderCallbacks.push(() => {\n\t\t\t\t\t\tc.componentDidUpdate(oldProps, oldState, snapshot);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tc.context = componentContext;\n\t\t\tc.props = newProps;\n\t\t\tc.state = c._nextState;\n\n\t\t\tif ((tmp = options._render)) tmp(newVNode);\n\n\t\t\tc._dirty = false;\n\t\t\tc._vnode = newVNode;\n\t\t\tc._parentDom = parentDom;\n\n\t\t\ttmp = c.render(c.props, c.state, c.context);\n\n\t\t\t// Handle setState called in render, see #2553\n\t\t\tc.state = c._nextState;\n\n\t\t\tif (c.getChildContext != null) {\n\t\t\t\tglobalContext = assign(assign({}, globalContext), c.getChildContext());\n\t\t\t}\n\n\t\t\tif (!isNew && c.getSnapshotBeforeUpdate != null) {\n\t\t\t\tsnapshot = c.getSnapshotBeforeUpdate(oldProps, oldState);\n\t\t\t}\n\n\t\t\tlet isTopLevelFragment =\n\t\t\t\ttmp != null && tmp.type === Fragment && tmp.key == null;\n\t\t\tlet renderResult = isTopLevelFragment ? tmp.props.children : tmp;\n\n\t\t\tdiffChildren(\n\t\t\t\tparentDom,\n\t\t\t\tArray.isArray(renderResult) ? renderResult : [renderResult],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\toldDom,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\tc.base = newVNode._dom;\n\n\t\t\t// We successfully rendered this VNode, unset any stored hydration/bailout state:\n\t\t\tnewVNode._hydrating = null;\n\n\t\t\tif (c._renderCallbacks.length) {\n\t\t\t\tcommitQueue.push(c);\n\t\t\t}\n\n\t\t\tif (clearProcessingException) {\n\t\t\t\tc._pendingError = c._processingException = null;\n\t\t\t}\n\n\t\t\tc._force = false;\n\t\t} else if (\n\t\t\texcessDomChildren == null &&\n\t\t\tnewVNode._original === oldVNode._original\n\t\t) {\n\t\t\tnewVNode._children = oldVNode._children;\n\t\t\tnewVNode._dom = oldVNode._dom;\n\t\t} else {\n\t\t\tnewVNode._dom = diffElementNodes(\n\t\t\t\toldVNode._dom,\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg,\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tisHydrating\n\t\t\t);\n\t\t}\n\n\t\tif ((tmp = options.diffed)) tmp(newVNode);\n\t} catch (e) {\n\t\tnewVNode._original = null;\n\t\t// if hydrating or creating initial tree, bailout preserves DOM:\n\t\tif (isHydrating || excessDomChildren != null) {\n\t\t\tnewVNode._dom = oldDom;\n\t\t\tnewVNode._hydrating = !!isHydrating;\n\t\t\texcessDomChildren[excessDomChildren.indexOf(oldDom)] = null;\n\t\t\t// ^ could possibly be simplified to:\n\t\t\t// excessDomChildren.length = 0;\n\t\t}\n\t\toptions._catchError(e, newVNode, oldVNode);\n\t}\n}\n\n/**\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {import('../internal').VNode} root\n */\nexport function commitRoot(commitQueue, root) {\n\tif (options._commit) options._commit(root, commitQueue);\n\n\tcommitQueue.some(c => {\n\t\ttry {\n\t\t\t// @ts-ignore Reuse the commitQueue variable here so the type changes\n\t\t\tcommitQueue = c._renderCallbacks;\n\t\t\tc._renderCallbacks = [];\n\t\t\tcommitQueue.some(cb => {\n\t\t\t\t// @ts-ignore See above ts-ignore on commitQueue\n\t\t\t\tcb.call(c);\n\t\t\t});\n\t\t} catch (e) {\n\t\t\toptions._catchError(e, c._vnode);\n\t\t}\n\t});\n}\n\n/**\n * Diff two virtual nodes representing DOM element\n * @param {import('../internal').PreactElement} dom The DOM element representing\n * the virtual nodes being diffed\n * @param {import('../internal').VNode} newVNode The new virtual node\n * @param {import('../internal').VNode} oldVNode The old virtual node\n * @param {object} globalContext The current context object\n * @param {boolean} isSvg Whether or not this DOM node is an SVG node\n * @param {*} excessDomChildren\n * @param {Array<import('../internal').Component>} commitQueue List of components\n * which have callbacks to invoke in commitRoot\n * @param {boolean} isHydrating Whether or not we are in hydration\n * @returns {import('../internal').PreactElement}\n */\nfunction diffElementNodes(\n\tdom,\n\tnewVNode,\n\toldVNode,\n\tglobalContext,\n\tisSvg,\n\texcessDomChildren,\n\tcommitQueue,\n\tisHydrating\n) {\n\tlet oldProps = oldVNode.props;\n\tlet newProps = newVNode.props;\n\tlet nodeType = newVNode.type;\n\tlet i = 0;\n\n\t// Tracks entering and exiting SVG namespace when descending through the tree.\n\tif (nodeType === 'svg') isSvg = true;\n\n\tif (excessDomChildren != null) {\n\t\tfor (; i < excessDomChildren.length; i++) {\n\t\t\tconst child = excessDomChildren[i];\n\n\t\t\t// if newVNode matches an element in excessDomChildren or the `dom`\n\t\t\t// argument matches an element in excessDomChildren, remove it from\n\t\t\t// excessDomChildren so it isn't later removed in diffChildren\n\t\t\tif (\n\t\t\t\tchild &&\n\t\t\t\t(child === dom ||\n\t\t\t\t\t(nodeType ? child.localName == nodeType : child.nodeType == 3))\n\t\t\t) {\n\t\t\t\tdom = child;\n\t\t\t\texcessDomChildren[i] = null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (dom == null) {\n\t\tif (nodeType === null) {\n\t\t\t// @ts-ignore createTextNode returns Text, we expect PreactElement\n\t\t\treturn document.createTextNode(newProps);\n\t\t}\n\n\t\tif (isSvg) {\n\t\t\tdom = document.createElementNS(\n\t\t\t\t'http://www.w3.org/2000/svg',\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType\n\t\t\t);\n\t\t} else {\n\t\t\tdom = document.createElement(\n\t\t\t\t// @ts-ignore We know `newVNode.type` is a string\n\t\t\t\tnodeType,\n\t\t\t\tnewProps.is && newProps\n\t\t\t);\n\t\t}\n\n\t\t// we created a new parent, so none of the previously attached children can be reused:\n\t\texcessDomChildren = null;\n\t\t// we are creating a new node, so we can assume this is a new subtree (in case we are hydrating), this deopts the hydrate\n\t\tisHydrating = false;\n\t}\n\n\tif (nodeType === null) {\n\t\t// During hydration, we still have to split merged text from SSR'd HTML.\n\t\tif (oldProps !== newProps && (!isHydrating || dom.data !== newProps)) {\n\t\t\tdom.data = newProps;\n\t\t}\n\t} else {\n\t\t// If excessDomChildren was not null, repopulate it with the current element's children:\n\t\texcessDomChildren =\n\t\t\texcessDomChildren && EMPTY_ARR.slice.call(dom.childNodes);\n\n\t\toldProps = oldVNode.props || EMPTY_OBJ;\n\n\t\tlet oldHtml = oldProps.dangerouslySetInnerHTML;\n\t\tlet newHtml = newProps.dangerouslySetInnerHTML;\n\n\t\t// During hydration, props are not diffed at all (including dangerouslySetInnerHTML)\n\t\t// @TODO we should warn in debug mode when props don't match here.\n\t\tif (!isHydrating) {\n\t\t\t// But, if we are in a situation where we are using existing DOM (e.g. replaceNode)\n\t\t\t// we should read the existing DOM attributes to diff them\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\toldProps = {};\n\t\t\t\tfor (let i = 0; i < dom.attributes.length; i++) {\n\t\t\t\t\toldProps[dom.attributes[i].name] = dom.attributes[i].value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newHtml || oldHtml) {\n\t\t\t\t// Avoid re-applying the same '__html' if it did not changed between re-render\n\t\t\t\tif (\n\t\t\t\t\t!newHtml ||\n\t\t\t\t\t((!oldHtml || newHtml.__html != oldHtml.__html) &&\n\t\t\t\t\t\tnewHtml.__html !== dom.innerHTML)\n\t\t\t\t) {\n\t\t\t\t\tdom.innerHTML = (newHtml && newHtml.__html) || '';\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdiffProps(dom, newProps, oldProps, isSvg, isHydrating);\n\n\t\t// If the new vnode didn't have dangerouslySetInnerHTML, diff its children\n\t\tif (newHtml) {\n\t\t\tnewVNode._children = [];\n\t\t} else {\n\t\t\ti = newVNode.props.children;\n\t\t\tdiffChildren(\n\t\t\t\tdom,\n\t\t\t\tArray.isArray(i) ? i : [i],\n\t\t\t\tnewVNode,\n\t\t\t\toldVNode,\n\t\t\t\tglobalContext,\n\t\t\t\tisSvg && nodeType !== 'foreignObject',\n\t\t\t\texcessDomChildren,\n\t\t\t\tcommitQueue,\n\t\t\t\tdom.firstChild,\n\t\t\t\tisHydrating\n\t\t\t);\n\n\t\t\t// Remove children that are not part of any vnode.\n\t\t\tif (excessDomChildren != null) {\n\t\t\t\tfor (i = excessDomChildren.length; i--; ) {\n\t\t\t\t\tif (excessDomChildren[i] != null) removeNode(excessDomChildren[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// (as above, don't diff props during hydration)\n\t\tif (!isHydrating) {\n\t\t\tif (\n\t\t\t\t'value' in newProps &&\n\t\t\t\t(i = newProps.value) !== undefined &&\n\t\t\t\t// #2756 For the <progress>-element the initial value is 0,\n\t\t\t\t// despite the attribute not being present. When the attribute\n\t\t\t\t// is missing the progress bar is treated as indeterminate.\n\t\t\t\t// To fix that we'll always update it when it is 0 for progress elements\n\t\t\t\t(i !== dom.value || (nodeType === 'progress' && !i))\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'value', i, oldProps.value, false);\n\t\t\t}\n\t\t\tif (\n\t\t\t\t'checked' in newProps &&\n\t\t\t\t(i = newProps.checked) !== undefined &&\n\t\t\t\ti !== dom.checked\n\t\t\t) {\n\t\t\t\tsetProperty(dom, 'checked', i, oldProps.checked, false);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn dom;\n}\n\n/**\n * Invoke or update a ref, depending on whether it is a function or object ref.\n * @param {object|function} ref\n * @param {any} value\n * @param {import('../internal').VNode} vnode\n */\nexport function applyRef(ref, value, vnode) {\n\ttry {\n\t\tif (typeof ref == 'function') ref(value);\n\t\telse ref.current = value;\n\t} catch (e) {\n\t\toptions._catchError(e, vnode);\n\t}\n}\n\n/**\n * Unmount a virtual node from the tree and apply DOM changes\n * @param {import('../internal').VNode} vnode The virtual node to unmount\n * @param {import('../internal').VNode} parentVNode The parent of the VNode that\n * initiated the unmount\n * @param {boolean} [skipRemove] Flag that indicates that a parent node of the\n * current element is already detached from the DOM.\n */\nexport function unmount(vnode, parentVNode, skipRemove) {\n\tlet r;\n\tif (options.unmount) options.unmount(vnode);\n\n\tif ((r = vnode.ref)) {\n\t\tif (!r.current || r.current === vnode._dom) applyRef(r, null, parentVNode);\n\t}\n\n\tlet dom;\n\tif (!skipRemove && typeof vnode.type != 'function') {\n\t\tskipRemove = (dom = vnode._dom) != null;\n\t}\n\n\t// Must be set to `undefined` to properly clean up `_nextDom`\n\t// for which `null` is a valid value. See comment in `create-element.js`\n\tvnode._dom = vnode._nextDom = undefined;\n\n\tif ((r = vnode._component) != null) {\n\t\tif (r.componentWillUnmount) {\n\t\t\ttry {\n\t\t\t\tr.componentWillUnmount();\n\t\t\t} catch (e) {\n\t\t\t\toptions._catchError(e, parentVNode);\n\t\t\t}\n\t\t}\n\n\t\tr.base = r._parentDom = null;\n\t}\n\n\tif ((r = vnode._children)) {\n\t\tfor (let i = 0; i < r.length; i++) {\n\t\t\tif (r[i]) unmount(r[i], parentVNode, skipRemove);\n\t\t}\n\t}\n\n\tif (dom != null) removeNode(dom);\n}\n\n/** The `.render()` method for a PFC backing instance. */\nfunction doRender(props, state, context) {\n\treturn this.constructor(props, context);\n}\n","import { EMPTY_OBJ, EMPTY_ARR } from './constants';\nimport { commitRoot, diff } from './diff/index';\nimport { createElement, Fragment } from './create-element';\nimport options from './options';\n\n/**\n * Render a Preact virtual node into a DOM element\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * render into\n * @param {import('./internal').PreactElement | object} [replaceNode] Optional: Attempt to re-use an\n * existing DOM tree rooted at `replaceNode`\n */\nexport function render(vnode, parentDom, replaceNode) {\n\tif (options._root) options._root(vnode, parentDom);\n\n\t// We abuse the `replaceNode` parameter in `hydrate()` to signal if we are in\n\t// hydration mode or not by passing the `hydrate` function instead of a DOM\n\t// element..\n\tlet isHydrating = typeof replaceNode === 'function';\n\n\t// To be able to support calling `render()` multiple times on the same\n\t// DOM node, we need to obtain a reference to the previous tree. We do\n\t// this by assigning a new `_children` property to DOM nodes which points\n\t// to the last rendered tree. By default this property is not present, which\n\t// means that we are mounting a new tree for the first time.\n\tlet oldVNode = isHydrating\n\t\t? null\n\t\t: (replaceNode && replaceNode._children) || parentDom._children;\n\n\tvnode = (\n\t\t(!isHydrating && replaceNode) ||\n\t\tparentDom\n\t)._children = createElement(Fragment, null, [vnode]);\n\n\t// List of effects that need to be called after diffing.\n\tlet commitQueue = [];\n\tdiff(\n\t\tparentDom,\n\t\t// Determine the new vnode tree and store it on the DOM element on\n\t\t// our custom `_children` property.\n\t\tvnode,\n\t\toldVNode || EMPTY_OBJ,\n\t\tEMPTY_OBJ,\n\t\tparentDom.ownerSVGElement !== undefined,\n\t\t!isHydrating && replaceNode\n\t\t\t? [replaceNode]\n\t\t\t: oldVNode\n\t\t\t? null\n\t\t\t: parentDom.firstChild\n\t\t\t? EMPTY_ARR.slice.call(parentDom.childNodes)\n\t\t\t: null,\n\t\tcommitQueue,\n\t\t!isHydrating && replaceNode\n\t\t\t? replaceNode\n\t\t\t: oldVNode\n\t\t\t? oldVNode._dom\n\t\t\t: parentDom.firstChild,\n\t\tisHydrating\n\t);\n\n\t// Flush all queued effects\n\tcommitRoot(commitQueue, vnode);\n}\n\n/**\n * Update an existing DOM element with data from a Preact virtual node\n * @param {import('./internal').ComponentChild} vnode The virtual node to render\n * @param {import('./internal').PreactElement} parentDom The DOM element to\n * update\n */\nexport function hydrate(vnode, parentDom) {\n\trender(vnode, parentDom, hydrate);\n}\n","import { assign } from './util';\nimport { createVNode } from './create-element';\n\n/**\n * Clones the given VNode, optionally adding attributes/props and replacing its children.\n * @param {import('./internal').VNode} vnode The virtual DOM element to clone\n * @param {object} props Attributes/props to add when cloning\n * @param {Array<import('./internal').ComponentChildren>} rest Any additional arguments will be used as replacement children.\n * @returns {import('./internal').VNode}\n */\nexport function cloneElement(vnode, props, children) {\n\tlet normalizedProps = assign({}, vnode.props),\n\t\tkey,\n\t\tref,\n\t\ti;\n\tfor (i in props) {\n\t\tif (i == 'key') key = props[i];\n\t\telse if (i == 'ref') ref = props[i];\n\t\telse normalizedProps[i] = props[i];\n\t}\n\n\tif (arguments.length > 3) {\n\t\tchildren = [children];\n\t\tfor (i = 3; i < arguments.length; i++) {\n\t\t\tchildren.push(arguments[i]);\n\t\t}\n\t}\n\tif (children != null) {\n\t\tnormalizedProps.children = children;\n\t}\n\n\treturn createVNode(\n\t\tvnode.type,\n\t\tnormalizedProps,\n\t\tkey || vnode.key,\n\t\tref || vnode.ref,\n\t\tnull\n\t);\n}\n","/**\n * Find the closest error boundary to a thrown error and call it\n * @param {object} error The thrown value\n * @param {import('../internal').VNode} vnode The vnode that threw\n * the error that was caught (except for unmounting when this parameter\n * is the highest parent that was being unmounted)\n */\nexport function _catchError(error, vnode) {\n\t/** @type {import('../internal').Component} */\n\tlet component, ctor, handled;\n\n\tfor (; (vnode = vnode._parent); ) {\n\t\tif ((component = vnode._component) && !component._processingException) {\n\t\t\ttry {\n\t\t\t\tctor = component.constructor;\n\n\t\t\t\tif (ctor && ctor.getDerivedStateFromError != null) {\n\t\t\t\t\tcomponent.setState(ctor.getDerivedStateFromError(error));\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\tif (component.componentDidCatch != null) {\n\t\t\t\t\tcomponent.componentDidCatch(error);\n\t\t\t\t\thandled = component._dirty;\n\t\t\t\t}\n\n\t\t\t\t// This is an error boundary. Mark it as having bailed out, and whether it was mid-hydration.\n\t\t\t\tif (handled) {\n\t\t\t\t\treturn (component._pendingError = component);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\terror = e;\n\t\t\t}\n\t\t}\n\t}\n\n\tthrow error;\n}\n","const alert = {\n  remove: id => (document.getElementById(id).outerHTML = \"\"),\n  add: (text, alertStyle = \"alert-success\", countdown = 5000) => {\n    if (!text) {\n      return;\n    }\n    let alertNode = document.createElement(\"DIV\");\n    alertNode.id = alert.hash(text);\n    alertNode.innerHTML = text;\n    alertNode.classList.add(\"global-alert\", \"alert\", alertStyle);\n    document.body.appendChild(alertNode);\n    setTimeout(() => alert.remove(alertNode.id), countdown);\n  },\n  hash: str => {\n    let hash = 0;\n    if (str.length == 0) {\n      return hash;\n    }\n    for (let i = 0; i < str.length; i++) {\n      let char = str.charCodeAt(i);\n      hash = (hash << 5) - hash + char;\n      hash = hash & hash; // Convert to 32bit integer\n    }\n    return hash;\n  }\n};\nexport default alert;\n","const storage = {\n  usage: () => {\n    let total = 0;\n    let k;\n    for (k in localStorage) {\n      if (Object.prototype.hasOwnProperty.call(localStorage, k)) {\n        total += (localStorage[k].length + k.length) * 2;\n      }\n    }\n    return total;\n  },\n  createStorageBox: (data, metadata = null) => ({\n    data,\n    createdAt: Date.now(),\n    metadata\n  }),\n  remove: id => localStorage.removeItem(id),\n  set: (id, data, metadata = null) => {\n    localStorage.setItem(\n      id,\n      JSON.stringify(storage.createStorageBox(data, metadata))\n    );\n    return Promise.resolve(id);\n  },\n  get: id => {\n    let data = localStorage.getItem(id);\n    if (data != null) {\n      data = JSON.parse(data);\n      if (Object.prototype.hasOwnProperty.call(data, \"data\")) {\n        return new Promise(r => r(data.data));\n      }\n    }\n    return new Promise(r => r(null));\n  },\n  reset: () =>\n    localStorage.clear() &&\n    window.dispatchEvent(new CustomEvent(\"resetStorage\"))\n};\nexport default storage;\n","import me from \"./me.js\";\nimport http from \"./http.js\";\n\nconst lang = {\n  dict: [], // dicts loaded for the current session\n  possibleLang: {\n    en: \"English\",\n    es: \"Espaol\",\n    fr: \"Franais\",\n    sk: \"Slovensk\"\n  }, // possible dicts names to load\n  getDefaultLang: () =>\n    (document.querySelector(\"meta[name='zusam:default-lang']\") || {}).content ||\n    \"en\",\n  getCurrentLang: () =>\n    me.me && me.me[\"data\"]\n      ? me.me.data[\"lang\"] || lang.getDefaultLang()\n      : lang.getDefaultLang(),\n  fetchDict: (dict = lang.getCurrentLang()) =>\n    !lang.dict[dict] &&\n    http.get(`/lang/${  dict  }.json`).then(r => {\n      lang.dict[dict] = r;\n      window.dispatchEvent(new CustomEvent(\"fetchedNewDict\"));\n    }),\n  t: (id, params = {}) => {\n    // prepare default values\n    params.dict = params[\"dict\"] || lang.getCurrentLang();\n    params.count = params[\"count\"] || 0;\n\n    // quick validity checks\n    if (!id || !lang.dict[params.dict]) {\n      return \"\";\n    }\n\n    // select translation string corresponding to count\n    // We treat the list of translation keys like ranges\n    // So if we have the keys 0, 1, 5; we have the ranges [0], [1, 4], [5, +inf]\n    let str = lang.dict[params.dict][id] || \"\";\n    if (typeof str == \"object\") {\n      let keys = Object.getOwnPropertyNames(str)\n        .map(e => +e)\n        .filter(e => !isNaN(e) && e <= params.count)\n        .sort((a, b) => a - b);\n      str = keys.length ? str[keys.slice(-1)[0]] : \"\";\n    }\n\n    // replace parameters\n    Object.assign([], str.match(/{{\\w+}}/g)).forEach(s => {\n      let rid = s.replace(/[{}]/g, \"\");\n      if (params[rid]) {\n        str = str.replace(s, params[rid]);\n      }\n    });\n\n    return str;\n  }\n};\nexport default lang;\n","import http from \"./http.js\";\nimport lang from \"./lang.js\";\nimport alert from \"./alert.js\";\n\nconst me = {\n  me: {},\n  get: () => (me.me.id ? Promise.resolve(me.me) : me.update()),\n  update: () =>\n    http.get(\"/api/me\", true).then(r => {\n      if (!r) {\n        return;\n      }\n      me.me = Object.assign({ notifications: [] }, r);\n      me.loadNotifications();\n      lang.fetchDict();\n      setTimeout(dispatchEvent(new CustomEvent(\"meStateChange\")));\n      return r;\n    }),\n  loadNotifications: () =>\n    http.get(`/api/users/${me.me.id}/notifications`).then(r => {\n      me.me.notifications = r;\n      setTimeout(dispatchEvent(new CustomEvent(\"meStateChange\")));\n    }),\n  matchNotification: (notif, id) => {\n    if (notif.id === id) {\n      return true;\n    }\n    if (notif.target === id) {\n      return true;\n    }\n    return false;\n  },\n  isNew: id =>\n    Array.isArray(me.me.notifications)\n      ? me.me.notifications.some(\n          n =>\n            me.matchNotification(n, id) ||\n            (n.type == \"new_comment\" && n.fromMessage.id === id)\n        )\n      : false,\n  removeMatchingNotifications: id => {\n    return me.loadNotifications().then(() => {\n      if (!Array.isArray(me.me.notifications)) {\n        return Promise.reject(\"Failed to get notifications from server\");\n      }\n      return Promise.all(\n        me.me.notifications\n          .filter(n => me.matchNotification(n, id))\n          .map(n =>\n            http.delete(`/api/notifications/${n.id}`).then(() => {\n              me.me.notifications = me.me.notifications.filter(\n                e => !me.matchNotification(e, id)\n              );\n              setTimeout(dispatchEvent(new CustomEvent(\"meStateChange\")));\n            })\n          )\n      );\n    });\n  },\n  hasBookmark: id => {\n    if (me.me && me.me.data && Array.isArray(me.me.data.bookmarks)) {\n      return me.me.data.bookmarks.some(bid => bid === id);\n    }\n    return false;\n  },\n  addBookmark: id => {\n    if (!me.hasBookmark(id)) {\n      http.post(`/api/bookmarks/${id}`).then(user => {\n        me.me = Object.assign(me.me, user);\n        setTimeout(dispatchEvent(new CustomEvent(\"meStateChange\")));\n        alert.add(lang.t(\"bookmark_added\"));\n      });\n    }\n  },\n  removeBookmark: id => {\n    if (me.hasBookmark(id)) {\n      http.delete(`/api/bookmarks/${id}`).then(user => {\n        me.me = Object.assign(me.me, user);\n        setTimeout(dispatchEvent(new CustomEvent(\"meStateChange\")));\n        alert.add(lang.t(\"bookmark_removed\"));\n      });\n    }\n  },\n};\nexport default me;\n","import lang from \"./lang.js\";\nimport router from \"./router.js\";\nimport me from \"./me.js\";\nimport storage from \"./storage.js\";\n\nconst util = {\n  // genId starts with a letter to be DOM friendly\n  // seed can be used to order ids\n  genId: seed => `z${seed || \"\"}-${Date.now().toString().slice(-5)}${Math.random().toString().slice(-5)}`,\n  // transform an id into int for the API (TODO: revisit this on 0.5)\n  id2Int: id => parseInt(id.replace(/[^\\d]/g,''), 10),\n  urlRegExp: /(\\([^()]*)?https?:\\/\\/[^[\\]\\n\\r ]*[-A-Za-z0-9+&@#/%=~_()|]/i,\n  getUrl: txt => {\n    if (!txt) {\n      return \"\";\n    }\n    let url = txt.match(util.urlRegExp);\n    if (url && url[0].startsWith(\"(\")) {\n      let link = url[0].match(/https?:\\/\\//i);\n      url[\"index\"] += link[\"index\"];\n      url[0] = url[0].slice(link[\"index\"]);\n      if (url[0].endsWith(\")\")) {\n        url[0] = url[0].slice(0, -1);\n      }\n    }\n    return url;\n  },\n  limitStrSize: (str, limit) => str.length > limit ? `${str.slice(0, limit-3)}...` : str,\n  // full datetime as a string adapted to the users timezone\n  humanFullDate: timestamp => {\n    let d = new Date(timestamp * 1000);\n    d = new Date(d.getTime() + d.getTimezoneOffset() * 60000 * -1);\n    return d.toISOString().replace(\"T\", \" \").replace(/\\..*$/, \"\");\n  },\n  // duration relative to event\n  humanTime: timestamp => {\n    if (!timestamp) {\n      return null;\n    }\n    const duration = Math.abs(Math.round((Date.now() / 1000 - timestamp) / 60));\n    if (duration < 1) {\n      return lang.t(\"just_now\");\n    }\n    if (duration < 60) {\n      return lang.t(\"ago\", { duration: `${duration  }mn` });\n    }\n    if (duration < 60 * 24) {\n      return lang.t(\"ago\", { duration: `${Math.floor(duration / 60)  }h` });\n    }\n    return util.humanFullDate(timestamp).split(\" \")[0];\n  },\n  getGroupId: () => {\n    if (me.me.groups) {\n      switch (router.entity.entityType) {\n        case \"group\":\n          return util.getId(router.entity);\n        case \"message\":\n          return util.getId(router.entity.group);\n      }\n    }\n    return \"\";\n  },\n  getGroupName: () => {\n    let group = me.me.groups.find(g => g[\"id\"] == util.getGroupId());\n    return group ? group[\"name\"] : \"\";\n  },\n  // get the id of an object from an url\n  getId: e => {\n    switch (typeof e) {\n      case \"object\":\n        return e ? e.id : null;\n      case \"string\":\n        return e\n          .split(\"/\")\n          .pop()\n          .replace(/\\?.*$/, \"\")\n          .replace(/\\.\\w+$/, \"\");\n      default:\n        console.error(e);\n        throw \"Could not extract id !\";\n    }\n  },\n  // get the url to a thubmnail\n  thumbnail: (id, width, height) =>\n    typeof(id) == \"string\" && !id.startsWith(\"z\")\n      ? router.toApp(`/api/images/thumbnail/${width}/${height}/${id}`)\n      : null,\n  // same as http.thumbnail but for a crop\n  crop: (id, width, height) =>\n    typeof(id) == \"string\" && !id.startsWith(\"z\")\n      ? router.toApp(`/api/images/crop/${width}/${height}/${id}`)\n      : null,\n  // default avatar in base64\n  defaultAvatar:\n    \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAABlBMVEUAAAD///+l2Z/dAAAAAnRSTlMA/iyWEiMAAAMJSURBVHja7ZtBjpwwEEWxmIhFFmiURZZEyi6HCLkZHCXr2eQKHIUjoEiRSGRRiWB6klaDU/hDF4z+W6LuNz3+ZRvbkCSEEEIIIYQQQgghhBBCCCGEEEIIITvwGfy+kxoTpNJigkw6TJBLjwkK8ZiglMFYUInAAqwQRKRBBR0q8FhXEKwVR0GLCvxCjeo6oyzkoIxnEvj5661acPO3yvFqpxdcV+Pj88VeNZ7cGB4ul1QFkv399KT4KBIpmGEwF4i9oL6DIN/3FzToL2ju8AvsBeE2aNFfQMFJBCkF0/R+bkHyCgSVuaDcVaC5zyvMBTkqyHYVaBZDKSpw5oJgLcMC5doXFBSoIMNutjcQBHJULmlhQYUKlmNQbs9kqGC5P2o3FqBBOVjMWkEOdcZQKam3dyqkkgP/g35zxmEpLhbjir0ZFz2tXHgbPR5deI+EMPKmig/hhU/fIkOYL4iYDbIyqpCXajp2Zy4yhNuxqUfbMCaEIraQZ9swJgQBQ0jBQr6eYXrzQrYIYdtC9uaFbDKayJajyTkL+VijyWA+mnBajGpDeFrMzAu5BNvwKoQBDaFHQ+jQEBo0hBoMYUBD8GgIHRpCi44mcAiJRQhoITvzQs63LGQxL2SOJnEhiHUI296bwNOixb1JYr5kz8yX7Odf6XDfBC9kd6yVzq+np69QIY/8AEJ45kt0T4hIM0VONm5CiLlVhLflS+CwdTGEVa2AnfOFTogaVAAfcg1QivpqzLFHD4LnrR0q8FAhqlux3PPUu0EFLSrooL6kLeaQwKMCTY4OfUjVoY+IOvTxSFiw81NtnbmgRwXeXDAg08IxBPIKBPX5BQ0FBxC0+wtSCg4gcBT853nruwiqfQXNHQT/LDiGD9Old6sEL2umn3MtqxDks9NotVbwfaG+FDfL6fznsjV32365cTXrtqoPdJKYrbmreIDvT42DCMYoIUEu4FvIKSpwgr6JvYEAfJm8QgUl+j58gb6Rn4Nvcv/p0jUmcODr8IQQQgghhBBCCCGEEEIIIYQQQgghs/wGp6uYgtiKODIAAAAASUVORK5CYII=\",\n  hash: str =>\n    str.split(\"\").reduce((a, c) => ((a << 5) - a + c.charCodeAt()) | 0),\n  colorHash: str =>\n    [\n      \"#000000\",\n      \"#333366\",\n      \"#333399\",\n      \"#3333CC\",\n      \"#339933\",\n      \"#339999\",\n      \"#33CC33\",\n      \"#33CC99\",\n      \"#663333\",\n      \"#663366\",\n      \"#666633\",\n      \"#666699\",\n      \"#66CC33\",\n      \"#66CCCC\",\n      \"#993333\",\n      \"#993366\",\n      \"#993399\",\n      \"#996633\",\n      \"#999966\",\n      \"#CC3333\",\n      \"#CC3366\",\n      \"#CC3399\",\n      \"#CC33CC\",\n      \"#CC6633\",\n      \"#CC9933\",\n      \"#CC99CC\",\n      \"#CCCC33\"\n    ][Math.abs(util.hash(str)) % 27],\n  backgroundHash: str => {\n    if (!str) {\n      return \"background-color: #aaa;\";\n    }\n    let c1 = util.colorHash(str);\n    let c2 = util.colorHash(\n      str\n        .split(\"\")\n        .reverse()\n        .join(\".\")\n    );\n    let deg = 45 * (Math.abs(util.hash(str)) % 4);\n    return (\n      `background-color:${c1};background-image:linear-gradient(${deg}deg, ${c2} 15%, transparent 15% 30%, ${c2} 30% 45%, transparent 45% 60%, ${c2} 60% 75%, transparent 75% 90%, ${c2} 90%);`\n    );\n  },\n  logout: () => {\n    storage.reset();\n    window.location.href = window.location.origin;\n  },\n  // Accepts a keydown event and checks if it's enter. Compatibility between browsers\n  // We do it the permissive way\n  is_it_enter: e => {\n    return e.keyCode == 13 || e.keyCode == 10 || e.key == \"Enter\" || e.key == \"\" || e.code == \"Enter\";\n  }\n};\nexport default util;\n","import http from \"./http.js\";\nimport me from \"./me.js\";\nimport util from \"./util.js\";\nimport lang from \"./lang.js\";\nimport storage from \"./storage.js\";\n\nconst router = {\n  route: \"\",\n  id: \"\",\n  action: \"\",\n  backUrl: \"\",\n  backUrlPrompt: \"\",\n  entityUrl: \"\",\n  entityType: \"\",\n  search: \"\",\n  entity: {},\n  isValidUrl: url => {\n    try {\n      new URL(url);\n      return true;\n    } catch (_) {\n      return false;\n    }\n  },\n  getSubpath: () => new URL(document.baseURI).pathname.replace(/\\/$/, \"\"),\n  toApp: url => {\n    if (!url || typeof url != \"string\") {\n      return \"\";\n    }\n    if (router.isValidUrl(url)) {\n      return url;\n    }\n    return location.origin + router.getSubpath() + router.removeSubpath(url);\n  },\n  removeSubpath: path =>\n    path ? path.replace(new RegExp(`^${  router.getSubpath()}`), \"\") : \"\",\n  getParam: (param, searchParams = window.location.search.substring(1)) => {\n    let res = searchParams.split(\"&\").find(e => e.split(\"=\")[0] === param);\n    return res ? decodeURIComponent(res.split(\"=\")[1]) : \"\";\n  },\n  getSegments: () =>\n      router\n      .removeSubpath(window.location.pathname)\n      .slice(1)\n      .split(\"?\")[0]\n      .split(\"/\"),\n  // check if route is \"outside\": accessible to non connected user\n  isOutside: () =>\n    [\n      \"login\",\n      \"password-reset\",\n      \"signup\",\n      \"invitation\",\n      \"stop-notification-emails\",\n      \"public\"\n    ].includes(router.route || router.getSegments()[0]),\n  isEntity: name =>\n    [\"messages\", \"groups\", \"users\", \"links\", \"files\"].includes(name),\n  getUrlComponents: url => {\n    let components = {};\n    if (url) {\n      components.url = new URL(url);\n      components.path = components.url.pathname;\n      components.search = components.url.search.slice(1);\n      [components.route, components.id, components.action] = router\n        .removeSubpath(components.path)\n        .slice(1)\n        .split(\"/\");\n    }\n    components.entityUrl = \"\";\n    components.entityType = \"\";\n    components.backUrl = \"\";\n    components.backUrlPrompt = \"\";\n    return components;\n  },\n  navigate: async (url = \"/\", options = {}) => {\n    if (!url.match(/^http/) && !options[\"raw_url\"]) {\n      url = router.toApp(url);\n    }\n    let components = router.getUrlComponents(url);\n    // do not allow to renavigate to the same url. This is done to avoid accidental navigate locks\n    if (router.url && router.url.href == components.url.href) {\n      console.warn(\"navigate lock !\");\n      return;\n    }\n    Object.assign(router, components);\n\n    // set url, backUrl and entityUrl\n    if (router.id && router.isEntity(router.route)) {\n      router.entityUrl = `/api/${router.route}/${router.id}`;\n      router.entityType = router.route;\n\n      await http\n        .get(router.entityUrl)\n        .then(res => {\n          if (!res) {\n            console.warn(\"Unknown entity\");\n            // TODO: what should we do here ?\n            //router.navigate(); // could go into navigate loop if disconnected\n            return;\n          }\n          router.entity = res;\n          switch (router.route) {\n            case \"groups\":\n              if (router.action == \"write\") {\n                router.backUrl = `/${router.route}/${router.id}`;\n                router.backUrlPrompt = lang.t(\"cancel_write\");\n              }\n              if (router.search) {\n                router.backUrl = `/${router.route}/${router.id}`;\n              }\n              break;\n            case \"messages\":\n              if (res[\"parent\"] && !res[\"isInFront\"]) {\n                router.backUrl = `/messages/${res[\"parent\"].id}`;\n              } else {\n                router.backUrl = `/groups/${util.getId(res.group)}`;\n              }\n              break;\n            case \"users\":\n              router.backUrl = \"/\";\n              break;\n            default:\n              if (router.action) {\n                router.backUrl = \"/\";\n              }\n          }\n        })\n        .catch(e => console.warn(e));\n    } else {\n      router.entity = null;\n    }\n\n    switch (router.route) {\n      case \"login\":\n        storage.reset();\n      case \"bookmarks\":\n      case \"create-group\":\n      case \"groups\":\n      case \"messages\":\n      case \"password-reset\":\n      case \"public\":\n      case \"share\":\n      case \"signup\":\n      case \"stop-notification-emails\":\n      case \"users\":\n        if (options.replace) {\n          history.replaceState(null, \"\", url);\n        } else {\n          history.pushState(null, \"\", url);\n        }\n        window.dispatchEvent(new CustomEvent(\"routerStateChange\"));\n        break;\n      case \"logout\":\n        util.logout();\n        break;\n      case \"invitation\":\n        storage.get(\"apiKey\").then(apiKey => {\n          if (apiKey) {\n            http.post(`/api/groups/invitation/${  router.id}`, {}).then(() => {\n              window.location.href = window.location.origin;\n            });\n          } else {\n            router.navigate(`/signup?inviteKey=${  router.id}`);\n          }\n        });\n        break;\n      default:\n        me.get().then(user => {\n          if (!user) {\n            router.navigate(\"/login\");\n            return;\n          }\n          if (user.data[\"default_group\"]) {\n            router.navigate(`/groups/${  user.data[\"default_group\"]}`);\n          } else if (user.groups[0]) {\n              router.navigate(`/groups/${  user.groups[0].id}`);\n            } else {\n              window.location = `${window.location.origin}/create-group`;\n            }\n        });\n    }\n  },\n  sync: () => {\n    router.navigate(location.pathname + location.search + location.hash, {\n      replace: true\n    });\n  },\n  onClick: (e, newTab = false, url = null) => {\n    // stop propagation\n    e.preventDefault();\n    e.stopPropagation();\n\n    // if url is not given, try to guess it\n    if (!url) {\n      const t = e.target.closest(\"a\");\n      if (t) {\n        if (t.target == \"_blank\") {\n          newTab = true;\n        }\n        url = t.getAttribute(\"href\");\n      }\n    }\n\n    if (!url) {\n      return;\n    }\n\n    // check if it's an external url\n    if (url.startsWith(\"http\")) {\n      let targetUrl = new URL(url);\n      if (targetUrl.host != location.host) {\n        if (e.ctrlKey || newTab) {\n          open(url, \"_blank\");\n        } else {\n          location.href = url;\n        }\n        return;\n      }\n    }\n\n    // disable active stances (dropdowns...)\n    for (let e of document.getElementsByClassName(\"active\")) {\n      e.classList.remove(\"active\");\n    }\n\n    // go to target url\n    if (e.ctrlKey || newTab) {\n      open(url, \"_blank\");\n    } else {\n      router.navigate(url);\n    }\n  }\n};\nexport default router;\n","import alert from \"./alert.js\";\nimport storage from \"./storage.js\";\nimport router from \"./router.js\";\n\nconst http = {\n  sendFile: (formData, loadFn, progressFn = null, errorFn = null) => {\n    return storage\n      .get(\"apiKey\")\n      .then(apiKey => {\n        let xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", `${document.baseURI}api/files`, true);\n        xhr.setRequestHeader(\"X-AUTH-TOKEN\", apiKey);\n        xhr.addEventListener(\"load\", e => {\n          if (e.target.status > 199 && e.target.status < 300) {\n            loadFn(JSON.parse(e.target.response));\n          } else if (errorFn) {\n              errorFn(e.target.statusText);\n            } else {\n              console.error(e.target.statusText);\n            }\n        });\n        if (progressFn) {\n          xhr.upload.onprogress = e =>\n            progressFn({ loaded: e.loaded, total: e.total });\n        }\n        if (errorFn) {\n          xhr.addEventListener(\"error\", e => errorFn(e));\n        }\n        xhr.send(formData);\n      })\n      .catch(error => alert.add(error, \"alert-danger\"));\n  },\n  get: (url, nocache = false) => {\n    return storage\n      .get(\"apiKey\")\n      .then(apiKey => {\n        url = router.toApp(url);\n        if (!url) {\n          return;\n        }\n        let h = {};\n        if (apiKey) {\n          h[\"X-AUTH-TOKEN\"] = apiKey;\n        }\n        if (nocache) {\n          h[\"X-NOCACHE\"] = \"nocache\";\n        }\n        return fetch(url, {\n          method: \"GET\",\n          headers: new Headers(h)\n        })\n          .then(res => res.ok && res.json())\n          .catch(err => console.warn(`ERROR for ${url}`, err));\n      })\n      .catch(error => alert.add(error, \"alert-danger\"));\n  },\n  post: (url, data, contentType = \"application/json\") =>\n    http.request(url, data, \"POST\", contentType),\n  put: (url, data, contentType = \"application/json\") =>\n    http.request(url, data, \"PUT\", contentType),\n  delete: (url, data, contentType = \"application/json\") =>\n    http.request(url, null, \"DELETE\", contentType),\n  request: (url, data, method, contentType = \"application/json\") => {\n    return storage\n      .get(\"apiKey\")\n      .then(apiKey => {\n        url = router.toApp(url);\n        if (!url) {\n          return;\n        }\n        let h = {};\n        if (apiKey) {\n          h[\"X-AUTH-TOKEN\"] = apiKey;\n        }\n        if (contentType) {\n          h[\"Content-type\"] = contentType;\n        }\n        let fetchOptions = {\n          method,\n          headers: new Headers(h)\n        };\n        if (data) {\n          fetchOptions.body =\n            typeof data == \"object\" && data.constructor.name == \"Object\"\n              ? JSON.stringify(data)\n              : data;\n        }\n        return fetch(url, fetchOptions)\n          .then(res => {\n            try {\n              return res.json();\n            } catch (exception) {\n              console.warn(exception.message);\n              return Promise.reject(exception.message);\n            }\n          })\n          .catch(err => console.warn(`ERROR for ${  url}`, err));\n      })\n      .catch(error => alert.add(error, \"alert-danger\"));\n  }\n};\nexport default http;\n","import http from \"./http.js\";\n\nconst api = {\n  info: {},\n  update: () =>\n    http.get(\"/api/info\", true).then(r => {\n      if (!r) {\n        return;\n      }\n      api.info = Object.assign({}, r);\n      setTimeout(dispatchEvent(new CustomEvent(\"apiStateChange\")));\n      return r;\n    }),\n};\nexport default api;\n","class Store {\r\n    constructor(dbName = 'keyval-store', storeName = 'keyval') {\r\n        this.storeName = storeName;\r\n        this._dbp = new Promise((resolve, reject) => {\r\n            const openreq = indexedDB.open(dbName, 1);\r\n            openreq.onerror = () => reject(openreq.error);\r\n            openreq.onsuccess = () => resolve(openreq.result);\r\n            // First time setup: create an empty object store\r\n            openreq.onupgradeneeded = () => {\r\n                openreq.result.createObjectStore(storeName);\r\n            };\r\n        });\r\n    }\r\n    _withIDBStore(type, callback) {\r\n        return this._dbp.then(db => new Promise((resolve, reject) => {\r\n            const transaction = db.transaction(this.storeName, type);\r\n            transaction.oncomplete = () => resolve();\r\n            transaction.onabort = transaction.onerror = () => reject(transaction.error);\r\n            callback(transaction.objectStore(this.storeName));\r\n        }));\r\n    }\r\n}\r\nlet store;\r\nfunction getDefaultStore() {\r\n    if (!store)\r\n        store = new Store();\r\n    return store;\r\n}\r\nfunction get(key, store = getDefaultStore()) {\r\n    let req;\r\n    return store._withIDBStore('readonly', store => {\r\n        req = store.get(key);\r\n    }).then(() => req.result);\r\n}\r\nfunction set(key, value, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.put(value, key);\r\n    });\r\n}\r\nfunction del(key, store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.delete(key);\r\n    });\r\n}\r\nfunction clear(store = getDefaultStore()) {\r\n    return store._withIDBStore('readwrite', store => {\r\n        store.clear();\r\n    });\r\n}\r\nfunction keys(store = getDefaultStore()) {\r\n    const keys = [];\r\n    return store._withIDBStore('readonly', store => {\r\n        // This would be store.getAllKeys(), but it isn't supported by Edge or Safari.\r\n        // And openKeyCursor isn't supported by Safari.\r\n        (store.openKeyCursor || store.openCursor).call(store).onsuccess = function () {\r\n            if (!this.result)\r\n                return;\r\n            keys.push(this.result.key);\r\n            this.result.continue();\r\n        };\r\n    }).then(() => keys);\r\n}\n\nexport { Store, get, set, del, clear, keys };\n","import { Store, get, keys, del } from \"idb-keyval\";\n\n// update at the same time as the version in service-workers.js\nconst CACHE_VERSION = \"0.4\";\n\nconst cache = {\n  name: `zusam-simplecache-${CACHE_VERSION}`,\n  cache_store: new Store(`zusam-${CACHE_VERSION}`, `zusam-simplecache-${CACHE_VERSION}`),\n  purgeOldCache: () => {\n    keys().then(keys =>\n      keys.map(k =>\n        get(k).then(e => {\n          // purge if older than 30 days\n          if (e.lastUsed + 1000 * 60 * 60 * 24 * 30 < Date.now()) {\n            console.log(`Remove from cache: ${k.url}`);\n            del(k);\n            caches.open(cache.name).then(c => c.delete(k));\n          }\n        })\n      )\n    );\n  },\n  removeMatching: str => caches.open(cache.name).then(openCache => openCache.matchAll().then(a =>\n      Promise.all(a.filter(e => e.url.match(str)).map(e => openCache.delete(e)))\n    )\n  )\n};\n\nexport default cache;\n","import _api from \"./api.js\";\nimport _alert from \"./alert.js\";\nimport _cache from \"./cache.js\";\nimport _storage from \"./storage.js\";\nimport _http from \"./http.js\";\nimport _me from \"./me.js\";\nimport _router from \"./router.js\";\nimport _util from \"./util.js\";\nimport _lang from \"./lang.js\";\n\nexport const api = _api;\nexport const alert = _alert;\nexport const cache = _cache;\nexport const storage = _storage;\nexport const http = _http;\nexport const me = _me;\nexport const router = _router;\nexport const util = _util;\nexport const lang = _lang;\n","import { h, Component } from \"preact\";\n\n// Fontawesome icons taken from https://raw.githubusercontent.com/FortAwesome/Font-Awesome/master/js/all.js\n\nexport default class FaIcon extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      regular: {\n        comment: [512, 512, [], \"f075\", \"M256 32C114.6 32 0 125.1 0 240c0 47.6 19.9 91.2 52.9 126.3C38 405.7 7 439.1 6.5 439.5c-6.6 7-8.4 17.2-4.6 26S14.4 480 24 480c61.5 0 110-25.7 139.1-46.3C192 442.8 223.2 448 256 448c141.4 0 256-93.1 256-208S397.4 32 256 32zm0 368c-26.7 0-53.1-4.1-78.4-12.1l-22.7-7.2-19.5 13.8c-14.3 10.1-33.9 21.4-57.5 29 7.3-12.1 14.4-25.7 19.9-40.2l10.6-28.1-20.6-21.8C69.7 314.1 48 282.2 48 240c0-88.2 93.3-160 208-160s208 71.8 208 160-93.3 160-208 160z\"],\n        bookmark: [384, 512, [], \"f02e\", \"M336 0H48C21.49 0 0 21.49 0 48v464l192-112 192 112V48c0-26.51-21.49-48-48-48zm0 428.43l-144-84-144 84V54a6 6 0 0 1 6-6h276c3.314 0 6 2.683 6 5.996V428.43z\"],\n        images: [ 576, 512, [], \"f302\", \"M480 416v16c0 26.51-21.49 48-48 48H48c-26.51 0-48-21.49-48-48V176c0-26.51 21.49-48 48-48h16v48H54a6 6 0 0 0-6 6v244a6 6 0 0 0 6 6h372a6 6 0 0 0 6-6v-10h48zm42-336H150a6 6 0 0 0-6 6v244a6 6 0 0 0 6 6h372a6 6 0 0 0 6-6V86a6 6 0 0 0-6-6zm6-48c26.51 0 48 21.49 48 48v256c0 26.51-21.49 48-48 48H144c-26.51 0-48-21.49-48-48V80c0-26.51 21.49-48 48-48h384zM264 144c0 22.091-17.909 40-40 40s-40-17.909-40-40 17.909-40 40-40 40 17.909 40 40zm-72 96l39.515-39.515c4.686-4.686 12.284-4.686 16.971 0L288 240l103.515-103.515c4.686-4.686 12.284-4.686 16.971 0L480 208v80H192v-48z\"],\n        \"check-circle\": [512, 512, [], \"f058\", \"M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 48c110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200-110.532 0-200-89.451-200-200 0-110.532 89.451-200 200-200m140.204 130.267l-22.536-22.718c-4.667-4.705-12.265-4.736-16.97-.068L215.346 303.697l-59.792-60.277c-4.667-4.705-12.265-4.736-16.97-.069l-22.719 22.536c-4.705 4.667-4.736 12.265-.068 16.971l90.781 91.516c4.667 4.705 12.265 4.736 16.97.068l172.589-171.204c4.704-4.668 4.734-12.266.067-16.971z\"],\n        \"file-pdf\": [384, 512, [], \"f1c1\", \"M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm250.2-143.7c-12.2-12-47-8.7-64.4-6.5-17.2-10.5-28.7-25-36.8-46.3 3.9-16.1 10.1-40.6 5.4-56-4.2-26.2-37.8-23.6-42.6-5.9-4.4 16.1-.4 38.5 7 67.1-10 23.9-24.9 56-35.4 74.4-20 10.3-47 26.2-51 46.2-3.3 15.8 26 55.2 76.1-31.2 22.4-7.4 46.8-16.5 68.4-20.1 18.9 10.2 41 17 55.8 17 25.5 0 28-28.2 17.5-38.7zm-198.1 77.8c5.1-13.7 24.5-29.5 30.4-35-19 30.3-30.4 35.7-30.4 35zm81.6-190.6c7.4 0 6.7 32.1 1.8 40.8-4.4-13.9-4.3-40.8-1.8-40.8zm-24.4 136.6c9.7-16.9 18-37 24.7-54.7 8.3 15.1 18.9 27.2 30.1 35.5-20.8 4.3-38.9 13.1-54.8 19.2zm131.6-5s-5 6-37.3-7.8c35.1-2.6 40.9 5.4 37.3 7.8z\"],\n        bell: [448, 512, [], \"f0f3\", \"M439.39 362.29c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71zM67.53 368c21.22-27.97 44.42-74.33 44.53-159.42 0-.2-.06-.38-.06-.58 0-61.86 50.14-112 112-112s112 50.14 112 112c0 .2-.06.38-.06.58.11 85.1 23.31 131.46 44.53 159.42H67.53zM224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64z\"],\n        \"level-down-alt\": [320, 512, [], \"f3be\", \"M313.553 392.331L209.587 504.334c-9.485 10.214-25.676 10.229-35.174 0L70.438 392.331C56.232 377.031 67.062 352 88.025 352H152V80H68.024a11.996 11.996 0 0 1-8.485-3.515l-56-56C-4.021 12.926 1.333 0 12.024 0H208c13.255 0 24 10.745 24 24v328h63.966c20.878 0 31.851 24.969 17.587 40.331z\"]\n      },\n      solid: {\n        bookmark: [384, 512, [], \"f02e\", \"M0 512V48C0 21.49 21.49 0 48 0h288c26.51 0 48 21.49 48 48v464L192 400 0 512z\"],\n        comment: [512, 512, [], \"f075\", \"M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z\"],\n        \"pencil-alt\": [512, 512, [], \"f303\", \"M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z\"],\n        \"arrow-left\": [448, 512, [], \"f060\", \"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z\"],\n        \"caret-down\": [320, 512, [], \"f0d7\", \"M31.3 192h257.3c17.8 0 26.7 21.5 14.1 34.1L174.1 354.8c-7.8 7.8-20.5 7.8-28.3 0L17.2 226.1C4.6 213.5 13.5 192 31.3 192z\"],\n        film: [512, 512, [], \"f008\", \"M488 64h-8v20c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12V64H96v20c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12V64h-8C10.7 64 0 74.7 0 88v336c0 13.3 10.7 24 24 24h8v-20c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v20h320v-20c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v20h8c13.3 0 24-10.7 24-24V88c0-13.3-10.7-24-24-24zM96 372c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12H44c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm272 208c0 6.6-5.4 12-12 12H156c-6.6 0-12-5.4-12-12v-96c0-6.6 5.4-12 12-12h200c6.6 0 12 5.4 12 12v96zm0-168c0 6.6-5.4 12-12 12H156c-6.6 0-12-5.4-12-12v-96c0-6.6 5.4-12 12-12h200c6.6 0 12 5.4 12 12v96zm112 152c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40zm0-96c0 6.6-5.4 12-12 12h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40z\"],\n        times: [352, 512, [], \"f00d\", \"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\"],\n        bell: [448, 512, [], \"f0f3\", \"M224 512c35.32 0 63.97-28.65 63.97-64H160.03c0 35.35 28.65 64 63.97 64zm215.39-149.71c-19.32-20.76-55.47-51.99-55.47-154.29 0-77.7-54.48-139.9-127.94-155.16V32c0-17.67-14.32-32-31.98-32s-31.98 14.33-31.98 32v20.84C118.56 68.1 64.08 130.3 64.08 208c0 102.3-36.15 133.53-55.47 154.29-6 6.45-8.66 14.16-8.61 21.71.11 16.4 12.98 32 32.1 32h383.8c19.12 0 32-15.6 32.1-32 .05-7.55-2.61-15.27-8.61-21.71z\"],\n        \"ellipsis-h\": [512, 512, [], \"f141\", \"M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z\"],\n        search: [512, 512, [], \"f002\", \"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z\"]\n      }\n    };\n  }\n\n  render() {\n    const icon = this.state[this.props.family][this.props.icon];\n    return (\n      icon && (\n        <svg\n          style={this.props.rotation ? `transform: rotate(${this.props.rotation})` : null}\n          className={`fa-icon ${  this.props.family  } ${  this.props.icon} ${this.props.rotation}`}\n          viewBox={`0 0 ${  icon[0]  } ${  icon[1]}`}\n        >\n          <path fill=\"currentColor\" d={icon[4]} />\n        </svg>\n      )\n    );\n  }\n}\n","import _FaIcon from \"./fa-icon.component.js\";\n\nexport const FaIcon = _FaIcon;\n","var bundleURL = null;\nfunction getBundleURLCached() {\n  if (!bundleURL) {\n    bundleURL = getBundleURL();\n  }\n\n  return bundleURL;\n}\n\nfunction getBundleURL() {\n  // Attempt to find the URL of the current script and use that as the base URL\n  try {\n    throw new Error;\n  } catch (err) {\n    var matches = ('' + err.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\\/\\/[^)\\n]+/g);\n    if (matches) {\n      return getBaseURL(matches[0]);\n    }\n  }\n\n  return '/';\n}\n\nfunction getBaseURL(url) {\n  return ('' + url).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\\/\\/.+)\\/[^/]+$/, '$1') + '/';\n}\n\nexports.getBundleURL = getBundleURLCached;\nexports.getBaseURL = getBaseURL;\n","var getBundleURL = require('./bundle-url').getBundleURL;\n\nfunction loadBundlesLazy(bundles) {\n  if (!Array.isArray(bundles)) {\n    bundles = [bundles]\n  }\n\n  var id = bundles[bundles.length - 1];\n\n  try {\n    return Promise.resolve(require(id));\n  } catch (err) {\n    if (err.code === 'MODULE_NOT_FOUND') {\n      return new LazyPromise(function (resolve, reject) {\n        loadBundles(bundles.slice(0, -1))\n          .then(function () {\n            return require(id);\n          })\n          .then(resolve, reject);\n      });\n    }\n\n    throw err;\n  }\n}\n\nfunction loadBundles(bundles) {\n  return Promise.all(bundles.map(loadBundle));\n}\n\nvar bundleLoaders = {};\nfunction registerBundleLoader(type, loader) {\n  bundleLoaders[type] = loader;\n}\n\nmodule.exports = exports = loadBundlesLazy;\nexports.load = loadBundles;\nexports.register = registerBundleLoader;\n\nvar bundles = {};\nfunction loadBundle(bundle) {\n  var id;\n  if (Array.isArray(bundle)) {\n    id = bundle[1];\n    bundle = bundle[0];\n  }\n\n  if (bundles[bundle]) {\n    return bundles[bundle];\n  }\n\n  var type = (bundle.substring(bundle.lastIndexOf('.') + 1, bundle.length) || bundle).toLowerCase();\n  var bundleLoader = bundleLoaders[type];\n  if (bundleLoader) {\n    return bundles[bundle] = bundleLoader(getBundleURL() + bundle)\n      .then(function (resolved) {\n        if (resolved) {\n          module.bundle.register(id, resolved);\n        }\n\n        return resolved;\n      }).catch(function(e) {\n        delete bundles[bundle];\n        \n        throw e;\n      });\n  }\n}\n\nfunction LazyPromise(executor) {\n  this.executor = executor;\n  this.promise = null;\n}\n\nLazyPromise.prototype.then = function (onSuccess, onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.then(onSuccess, onError)\n};\n\nLazyPromise.prototype.catch = function (onError) {\n  if (this.promise === null) this.promise = new Promise(this.executor)\n  return this.promise.catch(onError)\n};\n","import { h, Component } from \"preact\";\nimport { util, router, lang } from \"/core\";\nimport { FaIcon } from \"/misc\";\n\nexport default class FileGrid extends Component {\n  constructor(props) {\n    super(props);\n    this.toggleFile = this.toggleFile.bind(this);\n    let files = [];\n    if (Array.isArray(props.files)) {\n      props.files.forEach((e, i) => {\n        if (e.fileIndex == null) {\n          e.fileIndex = i;\n        }\n        files.splice(e.fileIndex, 0, e);\n      });\n    }\n    this.state = { files };\n  }\n\n  toggleFile(evt) {\n    evt.stopPropagation();\n    evt.preventDefault();\n    if (typeof this.props.toggleFile == \"function\") {\n      this.props.toggleFile(evt.currentTarget.getAttribute(\"fileIndex\"));\n    }\n  }\n\n  renderMiniatureFile(file) {\n    let filePath = file.contentUrl ? `/files/${file.contentUrl}` : null;\n    let url = filePath;\n    if (/image/.test(file.type) && file.type != \"image/gif\") {\n      // no limit in height for long format images\n      url = util.thumbnail(file.id, 1366, 999999);\n    }\n    switch (file.status) {\n      case \"raw\":\n        return (\n          <a class=\"rounded\">\n            <div class=\"miniature\">\n              <FaIcon family={\"regular\"} icon={\"check-circle\"} />\n            </div>\n          </a>\n        );\n      case \"initial\":\n        return (\n          <a class=\"rounded\">\n            <div\n              class=\"miniature video-raw\"\n              style={`background-image:url('${util.crop(file.id, 160, 160)}')`}\n             />\n            <div class=\"spinner orange-spinner\">\n              <div /><div /><div /><div /><div />\n            </div>\n            { file && file.progress > 0 && (\n              <div class=\"progress-bar\">\n                <div style={{ width: `${file.progress}%` }} />\n              </div>\n            )}\n          </a>\n        );\n      case \"ready\":\n      default:\n        if (/pdf/.test(file.type) || /video/.test(file.type) || file.type == \"image/gif\") {\n          return (\n            <a\n              data-nlg={!this.props.inWriter}\n              data-origin={router.toApp(filePath)}\n              href={!this.props.inWriter ? router.toApp(url) : undefined}\n              className={`rounded image${file.removed ? \" removed\" : \"\"}`}\n            >\n              <div\n                className={`miniature${file.removed ? \" removed\" : \"\"}`}\n                style={\n                  `background-image:url('${util.crop(file.id, 160, 160)}')`\n                }\n               />\n              <div\n                class=\"remove-button\"\n                style={file.removed ? \"color:red\" : \"\"}\n                fileIndex={file.fileIndex}\n                onClick={e => this.toggleFile(e)}\n              >\n                <FaIcon family={\"solid\"} icon={\"times\"} />\n              </div>\n            </a>\n          );\n        }\n        if (/image/.test(file.type) && file.type != \"image/gif\") {\n          return (\n            <a\n              data-nlg={!this.props.inWriter}\n              data-origin={router.toApp(filePath)}\n              data-src={util.thumbnail(file.id, 1366, 768)}\n              href={!this.props.inWriter ? router.toApp(url) : undefined}\n              class=\"rounded\"\n            >\n              <div\n                className={`miniature${file.removed ? \" removed\" : \"\"}`}\n                style={\n                  `background-image:url('${util.crop(file.id, 160, 160)}')`\n                }\n               />\n              <div\n                class=\"remove-button\"\n                style={file.removed ? \"color:red\" : \"\"}\n                fileIndex={file.fileIndex}\n                onClick={e => this.toggleFile(e)}\n              >\n                <FaIcon family={\"solid\"} icon={\"times\"} />\n              </div>\n            </a>\n          );\n        }\n    }\n  }\n\n  renderBigFile(file) {\n    let filePath = file.contentUrl ? `/files/${  file.contentUrl}` : null;\n    let url = filePath;\n    if (/image/.test(file.type) && file.type != \"image/gif\") {\n      // no limit in height for long format images\n      url = util.thumbnail(file.id, 1366, 999999);\n    }\n    if (file.contentUrl) {\n      if (/video/.test(file.type)) {\n        if (file.status == \"ready\") {\n          return (\n            <video\n              poster={util.thumbnail(file.id, 1280, 720)}\n              class=\"img-fluid contained-height video\"\n              controls=\"true\"\n              src={url}\n             />\n          );\n        }\n        return (\n          <a class=\"image video-uploaded\">\n            <img\n              class=\"img-fluid video-raw\"\n              src={util.crop(file.id, 320, 180)}\n             />\n            <div class=\"video-not-ready\">\n              {lang.t(\"video_not_ready\")}\n            </div>\n          </a>\n        );\n      }\n      if (/pdf/.test(file.type)) {\n        return (\n          <a\n            data-nlg={!this.props.inWriter}\n            data-origin={router.toApp(filePath)}\n            href={!this.props.inWriter ? router.toApp(url) : undefined}\n            className={`pdf-outline image${file.removed ? \" removed\" : \"\"}`}\n          >\n            <img class=\"img-fluid\" src={util.thumbnail(file.id, 210*2, 497*2)} />\n            <div\n              class=\"remove-button\"\n              style={file.removed ? \"color:red\" : \"\"}\n              fileIndex={file.fileIndex}\n              onClick={e => this.toggleFile(e)}\n            >\n              <FaIcon family={\"solid\"} icon={\"times\"} />\n            </div>\n          </a>\n        );\n      }\n      if (/image/.test(file.type)) {\n        return (\n          <a\n            data-nlg={!this.props.inWriter}\n            data-origin={router.toApp(filePath)}\n            href={!this.props.inWriter ? router.toApp(url) : undefined}\n            className={`image${file.removed ? \" removed\" : \"\"}`}\n          >\n            <img class=\"img-fluid\" src={url} />\n            <div\n              class=\"remove-button\"\n              style={file.removed ? \"color:red\" : \"\"}\n              fileIndex={file.fileIndex}\n              onClick={e => this.toggleFile(e)}\n            >\n              <FaIcon family={\"solid\"} icon={\"times\"} />\n            </div>\n          </a>\n        );\n      }\n    }\n    return (\n      <div class=\"file-placeholder\">\n        {file[\"error\"] ? (\n          <div class=\"orange-error\">&times;</div>\n        ) : (\n          <div class=\"spinner orange-spinner\">\n            <div /><div /><div /><div /><div />\n          </div>\n        )}\n        <div class=\"progress-bar\">\n          <div style={{ width: `${file.progress}%` }} />\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    if (!this.props.files || this.props.files.length === 0) {\n      return null;\n    }\n    if (this.props.files && this.props.files.length > 3) {\n      return (\n        <div class=\"file-grid\">\n          {this.state.files\n            .sort((a, b) => (a.fileIndex > b.fileIndex ? 1 : -1))\n            .map(e => this.renderMiniatureFile(e))}\n        </div>\n      );\n    }\n    return (\n      <div class=\"d-flex justify-content-center flex-wrap\">\n        {this.state.files\n          .sort((a, b) => (a.fileIndex > b.fileIndex ? 1 : -1))\n          .map(e => this.renderBigFile(e))}\n      </div>\n    );\n  }\n\n  componentDidMount() {\n    import(\"/lazy/nlg.js\").then(nlg => nlg.default.start());\n  }\n\n  componentDidUpdate() {\n    import(\"/lazy/nlg.js\").then(nlg => nlg.default.start());\n  }\n}\n","import { h, Component } from \"preact\";\nimport { me, router, util } from \"/core\";\nimport Message from \"./message.component.js\";\n\nexport default class MessageChild extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { message: this.props.message };\n  }\n\n  componentDidMount() {\n    me.removeMatchingNotifications(this.props.message.id);\n  }\n\n  componentWillUpdate() {\n    let msgElement = document.getElementById(this.state.message.id);\n    if (\n      this.state.message.id == router.action &&\n      msgElement.classList.contains(\"highlight\")\n    ) {\n      setTimeout(() => {\n        msgElement.scrollIntoView({ block: \"start\", behavior: \"smooth\" });\n        setTimeout(() => msgElement.classList.remove(\"highlight\"), 1000);\n      }, 1000);\n    }\n  }\n\n  render() {\n    if (!this.state.message || this.state.isRemoved) {\n      return;\n    }\n    return (\n      <Message\n        message={this.state.message}\n        isPublic={this.props.isPublic}\n        isChild={true}\n        preMessageHeadComponent={\n          this.state.edit &&\n          me.me && (\n            <div class=\"message-head d-none d-md-block\">\n              <img\n                class=\"rounded-circle w-3 material-shadow avatar\"\n                style={util.backgroundHash(me.me.id)}\n                src={\n                  me.me.avatar\n                    ? util.crop(me.me.avatar[\"id\"], 100, 100)\n                    : util.defaultAvatar\n                }\n              />\n            </div>\n          )\n        }\n       />\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, router, util } from \"/core\";\nimport MessageChild from \"./message-child.component.js\";\n\nexport default class MessageChildren extends Component {\n  constructor(props) {\n    super(props);\n    this.onNewChild = this.onNewChild.bind(this);\n    this.loadMessage = this.loadMessage.bind(this);\n    this.displayPreviousChildren = this.displayPreviousChildren.bind(this);\n    this.displayNextChildren = this.displayNextChildren.bind(this);\n    this.state = { firstDisplayedChild: 0, lastDisplayedChild: 0 };\n    window.addEventListener(\"newChild\", this.onNewChild);\n  }\n\n  onNewChild(event) {\n    const newMsg = event.detail;\n    if (newMsg.parent && util.getId(newMsg.parent) == this.props.id) {\n      this.setState(prevState => ({\n        lastDisplayedChild: prevState.lastDisplayedChild + 1\n      }));\n    }\n  }\n\n  loadMessage() {\n    let firstDisplayedChild = 0;\n    let lastDisplayedChild = 0;\n    if (this.props.childMessages.length) {\n      let msgIndex = router.action\n        ? this.props.childMessages.findIndex(e => e && e.id === router.action)\n        : -1;\n      if (msgIndex != -1) {\n        firstDisplayedChild = Math.max(0, msgIndex - 1);\n        lastDisplayedChild = Math.min(\n          this.props.childMessages.length,\n          msgIndex + 1\n        );\n      } else {\n        firstDisplayedChild =\n          this.props.childMessages && this.props.childMessages.length - 5; // display the last 5 children\n        lastDisplayedChild =\n          this.props.childMessages && this.props.childMessages.length;\n      }\n    }\n    this.setState({\n      firstDisplayedChild,\n      lastDisplayedChild\n    });\n  }\n\n  displayPreviousChildren() {\n    this.setState(prevState => ({\n      firstDisplayedChild: Math.max(0, prevState.firstDisplayedChild - 10)\n    }));\n  }\n\n  displayNextChildren() {\n    this.setState(prevState => ({\n      lastDisplayedChild: Math.min(\n        this.props.childMessages.length,\n        prevState.lastDisplayedChild + 10\n      )\n    }));\n  }\n\n  componentDidMount() {\n    this.loadMessage();\n  }\n\n  render() {\n    if (\n      this.state.lastDisplayedChild - this.state.firstDisplayedChild < 1 ||\n      !this.props.childMessages\n    ) {\n      return null;\n    }\n    return (\n      <div class=\"children\">\n        {this.state.firstDisplayedChild > 0 && (\n          <div class=\"d-flex\">\n            <a\n              class=\"more-coms unselectable\"\n              onClick={() => this.displayPreviousChildren()}\n            >\n              {lang.t(\"previous_coms\")}\n            </a>\n          </div>\n        )}\n        {this.props.childMessages.map((e, i) => {\n          // bypass empty messages\n          if (!e.files.length && e.data[\"text\"] == \"\" && !e.children.length) {\n            return null;\n          }\n\n          if (\n            i < this.state.firstDisplayedChild ||\n            i > this.state.lastDisplayedChild\n          ) {\n            return null;\n          }\n\n          return (\n            <MessageChild\n              message={e}\n              key={e.id}\n              isPublic={this.props.isPublic}\n            />\n          );\n        })}\n        {this.state.lastDisplayedChild + 1 <\n          this.props.childMessages.length && (\n          <div class=\"d-flex\">\n            <span\n              class=\"more-coms unselectable\"\n              onClick={() => this.displayNextChildren()}\n            >\n              {lang.t(\"next_coms\")}\n            </span>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","import { h } from \"preact\";\nimport { util } from \"/core\";\n\nexport default function MessageHead() {\n  return (\n    <div class=\"message-head d-flex\">\n      <div>\n        <img\n          className={\n            `rounded-circle material-shadow avatar${ \n              this.props.author && this.props.author.name ? \"\" : \" removed-user\"}`\n          }\n          style={util.backgroundHash(\n            this.props.author && this.props.author.name ? this.props.author && this.props.author.id : \"\"\n          )}\n          src={\n            this.props.author && this.props.author.avatar\n              ? util.crop(this.props.author.avatar.id, 100, 100)\n              : util.defaultAvatar\n          }\n          title={this.props.author && this.props.author.name ? this.props.author.name : \"\"}\n        />\n      </div>\n      {!this.props.isChild && (\n        <div class=\"infos\">\n          <span class=\"capitalize author\">\n            {this.props.author && this.props.author.name ? this.props.author.name : \"\"}\n          </span>\n        </div>\n      )}\n    </div>\n  );\n}\n","import { Fragment, h } from \"preact\";\nimport { router, lang, me, util } from \"/core\";\nimport { FaIcon } from \"/misc\";\n\nexport default function MessageFooter() {\n  return (\n    <div class=\"message-footer\">\n      <div class=\"infos\">\n        {!this.props.isPublic &&\n            this.props.author &&\n            this.props.author.id == me.me.id && (\n              <Fragment>\n                <a\n                  class=\"action seamless-link font-size-90 capitalize d-none d-sm-block\"\n                  onClick={e => this.props.editMessage(e)}\n                >\n                  {lang.t(\"edit\")}\n                </a>\n                <div class=\"dot d-none d-sm-block\">&bull;</div>\n              </Fragment>\n            )}\n        {!this.props.isPublic && this.props.isChild && (\n          <Fragment>\n            <a\n              class=\"action seamless-link font-size-90 capitalize\"\n              href={router.toApp(\n                `/messages/${ \n                    this.props.message.id \n                    }${this.props.message.children.length ? \"\" : \"?focus=reply\"}`\n              )}\n              onClick={e => router.onClick(e)}\n            >\n              {this.props.message.children.length ? (\n                this.props.message.children.some(e => me.isNew(e.id)) ? (\n                  <b>\n                    {lang.t(\"replies\", {\n                      count: this.props.message.children.length\n                    })}\n                  </b>\n                ) : (\n                  lang.t(\"replies\", {\n                    count: this.props.message.children.length\n                  })\n                )\n              ) : (\n                lang.t(\"reply\")\n              )}\n            </a>\n            <div class=\"dot\">&bull;</div>\n          </Fragment>\n        )}\n        <div\n          class=\"date font-size-90\"\n          title={util.humanFullDate(this.props.message.createdAt)}\n        >\n          {util.humanTime(this.props.message.createdAt)}\n        </div>\n        <Fragment>\n          <div class=\"dot\">&bull;</div>\n          <div class=\"font-size-90\">\n            {\n              this.props.author && this.props.author.name ? this.props.author.name : \"--\"\n            }\n          </div>\n        </Fragment>\n      </div>\n      <div>\n        {!this.props.isPublic && (\n          <div\n            class=\"options dropdown\"\n            onClick={e =>\n                e.target.closest(\".dropdown\").classList.toggle(\"active\")\n            }\n          >\n            <div class=\"none-if-follows-empty\">\n              <FaIcon family=\"solid\" icon=\"ellipsis-h\" />\n            </div>\n            <div class=\"dropdown-menu dropdown-options\">\n              {this.props.author && this.props.author.id == me.me.id && (\n                <a\n                  class=\"seamless-link capitalize\"\n                  onClick={e => this.props.deleteMessage(e)}\n                >\n                  {lang.t(\"delete\")}\n                </a>\n              )}\n              {\n                <a\n                  class=\"seamless-link capitalize\"\n                  onClick={e => this.props.openPublicLink(e)}\n                >\n                  {lang.t(\"public_link\")}\n                </a>\n              }\n              {me.me.groups.length > 1 && (\n                <a\n                  class=\"seamless-link capitalize\"\n                  onClick={e => this.props.shareMessage(e)}\n                >\n                  {lang.t(\"share_message\")}\n                </a>\n              )}\n              {!this.props.message.isInFront &&\n                  this.props.author &&\n                  this.props.author.id == me.me.id && (\n                    <a\n                      class=\"seamless-link capitalize\"\n                      onClick={e => this.props.publishInGroup(e)}\n                    >\n                      {lang.t(\"publish_in_group\")}\n                    </a>\n                  )}\n              {!me.hasBookmark(this.props.message.id) && (\n                <a\n                  class=\"seamless-link capitalize\"\n                  onClick={() => me.addBookmark(this.props.message.id)}\n                >\n                  {lang.t(\"add_bookmark\")}\n                </a>\n              )}\n              {me.hasBookmark(this.props.message.id) && (\n                <a\n                  class=\"seamless-link capitalize\"\n                  onClick={() => me.removeBookmark(this.props.message.id)}\n                >\n                  {lang.t(\"remove_bookmark\")}\n                </a>\n              )}\n              {this.props.author && this.props.author.id == me.me.id && (\n                <a\n                  class=\"seamless-link capitalize\"\n                  onClick={e => this.props.editMessage(e)}\n                >\n                  {lang.t(\"edit\")}\n                </a>\n              )}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","import { h } from \"preact\";\nimport { router } from \"/core\";\n\nfunction getEmbedUrl(url) {\n  const splits = url.split(\"/\");\n  const t = router.getParam(\"t\", url.split(\"?\")[1]);\n  if (splits.length > 5 && splits[4] == \"clip\") {\n    return `https://clips.twitch.tv/embed?clip=${splits[5].replace(/\\?.*$/, \"\")}&autoplay=false`;\n  }\n  if (splits.length > 4 && splits[4]) {\n     return `https://player.twitch.tv/?video=${splits[4].replace(/\\?.*$/, \"\")}&autoplay=false${t ? `&t=${t}` : \"\"}`;\n  }\n  return url;\n}\n\nexport default function TwitchEmbed() {\n  let embedUrl = getEmbedUrl(this.props.url);\n  return (\n    <div class=\"embed-responsive embed-responsive-16by9\">\n      <iframe\n        allowfullscreen\n        class=\"embed-responsive-item\"\n        src={`${embedUrl}&parent=${location.hostname}`}\n      />\n    </div>\n  );\n}\n","import { h, Component } from \"preact\";\n\nexport default class BandCampEmbed extends Component {\n  render() {\n    const embedUrl =\n      `${this.props.url \n      }/size=large/bgcol=f5f5f5/linkcol=0687f5/minimal=true/tracklist=false/`;\n    if (this.state.revealed) {\n      return (\n        <div class=\"bandcamp-embed embed-responsive embed-responsive-1by1\">\n          <iframe class=\"embed-responsive-item\" src={embedUrl} />\n        </div>\n      );\n    }\n    return (\n      <div\n        class=\"embed-preview\"\n        onClick={() => this.setState({ revealed: true })}\n      >\n        <div class=\"bandcamp\" />\n        <img src={this.props.preview} />\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\n\nexport default class GenericEmbed extends Component {\n  render() {\n    if (this.state.revealed) {\n      return (\n        <div class=\"embed-responsive embed-responsive-16by9\">\n          <iframe\n            allowfullscreen\n            class=\"embed-responsive-item\"\n            src={this.props.url}\n           />\n        </div>\n      );\n    }\n    return (\n      <div\n        class=\"embed-preview\"\n        onClick={() => this.setState({revealed: true})}\n      >\n        <div className={this.props.playBtnClass} />\n        <img src={this.props.preview} />\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { util, router } from \"/core\";\nimport TwitchEmbed from \"./embeds/twitch-embed.component.js\";\nimport BandCampEmbed from \"./embeds/bandcamp-embed.component.js\";\nimport GenericEmbed from \"./embeds/generic-embed.component.js\";\n\nexport default class EmbedBlock extends Component {\n  getPreview() {\n    if (this.props.data[\"providerUrl\"]) {\n      switch (\n        this.props.data[\"providerUrl\"]\n          .toLowerCase()\n          .replace(/\\/$/, \"\")\n          .replace(/^https?:\\/\\/(www\\.)?/, \"\")\n      ) {\n        case \"lichess.org\":\n          let url = this.props.url;\n          if (url.match(\"/study/\")) {\n            url = url.replace(\"/study/\", \"/study/embed/\");\n          } else {\n            url = url.replace(\"lichess.org/\", \"lichess.org/embed/\");\n          }\n          let id;\n          try {\n            id = url.split(\"/\").slice(-1)[0];\n          } catch (e) {\n            id = \"\";\n          }\n          url = url.replace(id, id.slice(0, 8));\n          return (\n            <GenericEmbed\n              preview={util.crop(this.props.preview.id, 270, 270)}\n              url={url}\n              playBtnClass={\"lichess\"}\n            />\n          );\n        case \"gamerdvr.com\":\n          if (this.props.data[\"url\"].match(/\\/gamer\\/\\w+\\/video\\//)) {\n            return (\n              <GenericEmbed\n                preview={util.crop(this.props.preview.id, 1024, 270)}\n                url={`${this.props.data[\"url\"]  }/embed`}\n                playBtnClass={\"gamerdvr\"}\n              />\n            );\n          }\n          break;\n        case \"youtube.com\":\n          if (this.props.data[\"type\"] == \"video\" && this.props.data[\"code\"]) {\n            return (\n              <GenericEmbed\n                preview={util.crop(this.props.preview.id, 1024, 270)}\n                url={\n                  `${this.props.data[\"code\"].match(/https:\\/\\/[^\"\\s]+/)[0] \n                  }&autoplay=1&controls=2&wmode=opaque`\n                }\n                playBtnClass={\"youtube\"}\n              />\n            );\n          }\n          break;\n        case \"soundcloud.com\":\n          if (this.props.data[\"code\"]) {\n            return (\n              <GenericEmbed\n                preview={util.crop(this.props.preview.id, 1024, 270)}\n                url={\n                  `${this.props.data[\"code\"].match(/https:\\/\\/[^\"\\s]+/)[0] \n                  }&auto_play=true`\n                }\n                playBtnClass={\"soundcloud\"}\n              />\n            );\n          }\n          break;\n        case \"arte.tv\":\n          let segments = this.props.data['url'].split(\"/\");\n          let videoId = \"\";\n          for (let i = 0; i < segments.length; i++) {\n            if (segments[i] == \"videos\") {\n              videoId = segments[i + 1];\n              break;\n            }\n          }\n          return (\n            <GenericEmbed\n              preview={util.crop(this.props.preview.id, 1024, 270)}\n              url={\n                `https://www.arte.tv/player/v5/index.php?json_url=${\n                  encodeURIComponent(`https://api.arte.tv/api/player/v2/config/en/${videoId}`)\n                }&lang=en&autoplay=true&mute=0`\n              }\n              playBtnClass={\"generic\"}\n            />\n          );\n        case \"twitch.tv\":\n          let splits = this.props.data[\"url\"].split('/');\n          if (splits.length > 4 && splits[4]) {\n            return (\n              <TwitchEmbed\n                preview={this.props.preview}\n                url={this.props.data[\"url\"]}\n              />\n            );\n          }\n          break;\n        case \"bandcamp.com\":\n          if (this.props.data[\"code\"]) {\n            let id = this.props.data[\"code\"].match(/https:\\/\\/.*album=\\d+/);\n            if (!id) {\n              id = this.props.data[\"code\"].match(/https:\\/\\/.*track=\\d+/);\n            }\n            if (id) {\n              return (\n                <BandCampEmbed\n                  preview={util.crop(this.props.preview.id, 1024, 270)}\n                  url={id[0]}\n                />\n              );\n            }\n          }\n          break;\n        case \"imgur.com\":\n          // skip default embed code if it's an imgur image\n          if (this.props.data[\"type\"] == \"photo\") {\n            break;\n          }\n        case \"vimeo.com\":\n        case \"dailymotion.com\":\n        case \"facebook.com\":\n        default:\n      }\n    }\n    if (this.props.data[\"providerName\"]) {\n      switch (this.props.data[\"providerName\"].toLowerCase()) {\n        case \"peertube\":\n          // default embed code\n          if (this.props.data[\"code\"]) {\n            return (\n              <div class=\"embed-container\" dangerouslySetInnerHTML={{ __html: this.props.data[\"code\"] }} />\n            );\n          }\n        default:\n      }\n    }\n    if (/image/.test(this.props.data[\"content-type\"])) {\n      return (\n        <div class=\"container d-flex justify-content-center flex-wrap align-items-center\">\n          <img\n            data-nlg={!this.props.inWriter}\n            href={router.toApp(this.props.url)}\n            class=\"img-fluid cursor-pointer\"\n            data-origin={this.props.url}\n            data-src={\n              this.props.preview && !/gif/.test(this.props.data[\"content-type\"])\n                ? util.thumbnail(this.props.preview.id, 1366, 768)\n                : this.props.url\n            }\n            src={\n              this.props.preview && !/gif/.test(this.props.data[\"content-type\"])\n                ? util.thumbnail(this.props.preview.id, 1366, 99999)\n                : this.props.url\n            }\n          />\n        </div>\n      );\n    }\n    if (/video/.test(this.props.data[\"content-type\"])) {\n      return (\n        <div class=\"container d-flex justify-content-center flex-wrap align-items-center\">\n          <video class=\"img-fluid\" controls src={this.props.url} />\n        </div>\n      );\n    }\n    if (/audio/.test(this.props.data[\"content-type\"])) {\n      return (\n        <div class=\"container d-flex justify-content-center flex-wrap align-items-center\">\n          <audio class=\"w-100\" controls>\n            <source src={this.props.url} />\n          </audio>\n        </div>\n      );\n    }\n    if (\n      this.props.data[\"title\"] &&\n      (this.props.preview || this.props.data[\"description\"])\n    ) {\n      return (\n        <a\n          class=\"preview-card seamless-link d-inline-block\"\n          target=\"_blank\"\n          rel=\"noreferrer\"\n          href={router.toApp(this.props.url)}\n        >\n          <div class=\"card\" style=\"max-width: 480px\">\n            {this.props.preview && (\n              <img\n                class=\"card-img-top\"\n                src={util.crop(this.props.preview.id, 320, 180)}\n              />\n            )}\n            <div class=\"card-body p-1\">\n              <h5>{this.props.data[\"title\"]}</h5>\n              {this.props.data[\"description\"] && (\n                <p>\n                  <small>{this.props.data[\"description\"].slice(0, 500)}</small>\n                </p>\n              )}\n            </div>\n          </div>\n        </a>\n      );\n    }\n    return null;\n  }\n\n  render() {\n    if (!this.props.url || !this.props.data) {\n      return null;\n    }\n    let preview = this.getPreview();\n    if (preview) {\n      return <p class=\"text-center card-text\">{preview}</p>;\n    }\n    return null;\n  }\n}\n","import { h, Component } from \"preact\";\nimport { http, util } from \"/core\";\nimport EmbedBlock from \"./embed-block.component.js\";\nimport FileGrid from \"./file-grid.component.js\";\n\nexport default class MessageBody extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { preview: null };\n  }\n\n  displayMessageText() {\n    if (!this.props.message.data) {\n      return \"\";\n    }\n    // escape html a little (just enough to avoid xss I hope)\n    let txt = this.props.message.data[\"text\"]\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\")\n      .trim();\n    // replace url by real links\n    let shift = 0;\n    let match = null;\n    while ((match = util.getUrl(txt.slice(shift)))) {\n      let url = match[0];\n      if (url.length >= 50) {\n        url = `${url.slice(0, 25)  }...${  url.slice(-24)}`;\n      }\n      let link = `<a href=\"${match[0]}\" target=\"_blank\">${url}</a>`;\n      txt =\n        txt.slice(0, match[\"index\"] + shift) +\n        link +\n        txt.slice(match[\"index\"] + shift + match[0].length);\n      shift += match[\"index\"] + link.length;\n    }\n    // replace line returns\n    txt = txt.replace(/\\n/g, \"<br/>\");\n    return { __html: txt };\n  }\n\n  componentDidMount() {\n    this.componentWillUpdate();\n  }\n\n  componentWillUpdate() {\n    if (!this.state.gotPreview && this.props.message) {\n      if (this.props.message.data) {\n        let previewUrl = util.getUrl(this.props.message.data[\"text\"]);\n        if (previewUrl) {\n          http\n            .get(`/api/links/by_url?url=${  encodeURIComponent(previewUrl[0])}`)\n            .then(r => {\n              this.setState({\n                preview: r,\n                gotPreview: true\n              });\n            });\n        } else {\n          this.setState({\n            gotPreview: true\n          });\n        }\n      }\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"message-body\">\n        {this.props.message.data && this.props.message.data.title && (\n          <div class=\"title\">\n            <span>{this.props.message.data.title}</span>\n          </div>\n        )}\n        {this.props.message.data &&\n          this.props.message.data.text &&\n          this.props.message.data.text.trim() && (\n            <p\n              class=\"card-text\"\n              dangerouslySetInnerHTML={this.displayMessageText()}\n             />\n          )}\n        {this.state.preview && (\n          <EmbedBlock\n            key={this.state.preview.url}\n            url={this.state.preview.url}\n            preview={this.state.preview.preview}\n            data={this.state.preview.data}\n          />\n        )}\n        {this.props.message.files && (\n          <FileGrid files={this.props.message.files} />\n        )}\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, alert, http, me, router, util, api } from \"/core\";\nimport { FaIcon } from \"/misc\";\nimport EmbedBlock from \"./embed-block.component.js\";\nimport FileGrid from \"./file-grid.component.js\";\n\nexport default class Writer extends Component {\n\n  constructor(props) {\n    super(props);\n    this.sendMessage = this.sendMessage.bind(this);\n    this.genPreview = this.genPreview.bind(this);\n    this.postMessage = this.postMessage.bind(this);\n    this.putMessage = this.putMessage.bind(this);\n    this.onKeyPress = this.onKeyPress.bind(this);\n    this.toggleFile = this.toggleFile.bind(this);\n    this.inputImages = this.inputImages.bind(this);\n    this.inputVideo = this.inputVideo.bind(this);\n    this.uploadFile = this.uploadFile.bind(this);\n    this.addFile = this.addFile.bind(this);\n    this.removeFile = this.removeFile.bind(this);\n    this.updateFile = this.updateFile.bind(this);\n    this.manageWorkers = this.manageWorkers.bind(this);\n    this.removeWorker = this.removeWorker.bind(this);\n    this.addWorker = this.addWorker.bind(this);\n    this.state = {\n      files: [],\n      writerId: util.genId(),\n      workers: [],\n      workerManager: setInterval(this.manageWorkers, 1000),\n    };\n  }\n\n  componentWillMount() {\n    this.setState({\n      files: this.props.files || [],\n      link: null,\n      preview: null\n    });\n  }\n\n  componentDidMount() {\n    if (document.getElementById(\"title\")) {\n      document.getElementById(\"title\").value = this.props.title || \"\";\n    }\n    if (document.getElementById(\"text\")) {\n      document.getElementById(\"text\").value = this.props.text || \"\";\n    }\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.state.workerManager);\n  }\n\n  onKeyPress(event, doGenPreview = false) {\n    if (event.ctrlKey && util.is_it_enter(event)) {\n      this.sendMessage();\n      return;\n    }\n    if (![\" \", \"Enter\", \"v\"].includes(event.key)) {\n      return;\n    }\n    if (doGenPreview) {\n      this.genPreview(event.currentTarget);\n    }\n  }\n\n  genPreview(t) {\n    t.style.height = \"1px\";\n    t.style.height = `${25 + t.scrollHeight  }px`;\n    // waiting for the dom to be updated\n    setTimeout(() => {\n      const text = t.value;\n      let links = text.match(/(https?:\\/\\/[^\\s]+)/gi);\n      if (links && links[0] != this.state.link) {\n        http\n          .get(`/api/links/by_url?url=${  encodeURIComponent(links[0])}`)\n          .then(r => {\n            if (r && t.value.indexOf(links[0]) >= 0) {\n              this.setState({ link: links[0], preview: r });\n            }\n          });\n      }\n    }, 0);\n  }\n\n  // toggle state (removed or not) of a file\n  toggleFile(fileIndex) {\n    let files = this.state.files;\n    let f = files.find(f => f.fileIndex == fileIndex);\n    f.removed = !f.removed;\n    this.setState({ files });\n  }\n\n  sendMessage() {\n    if (this.props.messageId) {\n      this.putMessage();\n    } else {\n      this.postMessage();\n    }\n  }\n\n  putMessage() {\n    let msg = {\n      files: this.state.files\n        .filter(e => !e.removed)\n        .filter(e => e.status == \"ready\")\n        .map(e => e[\"id\"])\n        .filter(e => !!e),\n      data: {\n        text: document.getElementById(\"text\").value\n      }\n    };\n    if (document.getElementById(\"title\")) {\n      msg.data.title = document.getElementById(\"title\").value || \"\";\n    }\n    http.put(`/api/messages/${this.props.messageId}`, msg).then(res => {\n      this.setState({sending: false});\n      if (!res) {\n        alert.add(lang.t(\"error_new_message\"), \"alert-danger\");\n        return;\n      }\n      window.dispatchEvent(new CustomEvent(\"editMessage\", { detail: res }));\n    });\n    this.setState({sending: true});\n  }\n\n  postMessage() {\n    let msg = {\n      createdAt: Math.floor(Date.now() / 1000),\n      author: me.me[\"id\"],\n      group: util.getId(this.props.group),\n      children: [],\n      files: this.state.files\n        .filter(e => !e.removed)\n        .filter(e => e.status == \"ready\")\n        .map(e => e[\"id\"])\n        .filter(e => !!e),\n      data: {\n        text: (document.getElementById(\"text\").value || \"\").substring(0, 50000)\n      },\n      lastActivityDate: Math.floor(Date.now() / 1000)\n    };\n    if (this.props.parent) {\n      msg.parent = util.getId(this.props.parent);\n    }\n    if (document.getElementById(\"title\")) {\n      msg.data.title = document.getElementById(\"title\").value || \"\";\n    }\n    // don't post if there is nothing to post\n    if (!msg.files.length && !msg.data.text && !msg.data.title) {\n      alert.add(lang.t(\"empty_message\"), \"alert-danger\");\n      return;\n    }\n    http.post(\"/api/messages\", msg).then(res => {\n      if (!res) {\n        this.setState({ sending: false });\n        alert.add(lang.t(\"error_new_message\"), \"alert-danger\");\n        return;\n      }\n      if (this.props.isChild) {\n        this.setState({ sending: false });\n        window.dispatchEvent(new CustomEvent(\"newChild\", { detail: res }));\n      } else {\n        setTimeout(() => {\n          window.dispatchEvent(new CustomEvent(\"newParent\", { detail: res }));\n          router.navigate(router.toApp(`/messages/${res.id}`));\n        }, 500);\n      }\n      this.setState({\n        files: [],\n        link: null,\n        preview: null,\n        writerId: util.genId(),\n      });\n      if (document.getElementById(\"text\")) {\n        document.getElementById(\"text\").value = \"\";\n      }\n    });\n    this.setState({ sending: true });\n  }\n\n  inputGenericFile(mimetype) {\n    const input = document.createElement(\"input\");\n    document.body.appendChild(input);\n    input.style.display = \"none\";\n    input.type = \"file\";\n    input.accept = mimetype;\n    input.addEventListener(\"change\", event => {\n      this.addFile(event.target.files[0], mimetype);\n    });\n    input.click();\n  }\n\n  inputVideo() {\n    const input = document.createElement(\"input\");\n    document.body.appendChild(input);\n    input.style.display = \"none\";\n    input.type = \"file\";\n    input.accept = \"video/*\";\n    input.addEventListener(\"change\", event => {\n      this.addFile(event.target.files[0], \"video\");\n    });\n    input.click();\n  }\n\n  inputImages() {\n    const input = document.createElement(\"input\");\n    document.body.appendChild(input);\n    input.style.display = \"none\";\n    input.type = \"file\";\n    input.multiple = \"multiple\";\n    input.accept = \"image/*\";\n    input.addEventListener(\"change\", event => {\n      let list = Array.from(event.target.files);\n      list.map(e => this.addFile(e, \"image\"));\n    });\n    input.click();\n  }\n\n  addFile(inputFile, type) {\n    this.setState(prevState => ({\n      files: [...prevState.files, {\n        inputFile,\n        type,\n        id: util.genId(),\n        progress: 0,\n        status: 'initial'\n      }]\n    }));\n  }\n\n  updateFile(id, file, callback = null) {\n    this.setState(prevState => ({\n      files: prevState.files.map(f => f.id === id ? Object.assign(f, file) : f)\n    }), callback);\n  }\n\n  removeFile(id) {\n    this.setState(prevState => ({\n      files: prevState.files.filter(f => f.id != id)\n    }));\n  }\n\n  manageWorkers() {\n    if (this.state.workers.length >= navigator.hardwareConcurrency) {\n      return;\n    }\n    let target = this.state.files.find(\n      e => !this.state.workers.map(w => w.target && w.target.id).includes(e.id) && e.status == 'initial'\n    );\n    if (target) {\n      let worker = {\n        target,\n        id: util.genId(),\n      };\n      this.setState(prevState => ({\n        workers: [...prevState.workers, worker]\n      }), () => this.addWorker(worker.id));\n    }\n  }\n\n  removeWorker(workerId) {\n    this.setState(prevState => ({\n      workers: prevState.workers.filter(e => e.id != workerId)\n    }));\n  }\n\n  addWorker(workerId) {\n    let worker = this.state.workers.find(e => e.id == workerId);\n    switch (worker.target.type) {\n      case \"image\":\n        import(\"/lazy/image-service.js\").then(imageService => {\n          imageService.default.handleImage(\n            worker.target.inputFile,\n            res => {\n              this.updateFile(\n                worker.target.id,\n                {inputFile: res},\n                this.uploadFile(worker.target.id, () => this.removeWorker(workerId))\n              );\n            }\n          );\n        });\n        break;\n      case \"video\":\n        console.log(worker);\n        this.uploadFile(worker.target.id, () => this.removeWorker(workerId));\n        break;\n      case \"application/pdf\":\n        console.log(worker);\n        this.uploadFile(worker.target.id, () => this.removeWorker(workerId));\n        break;\n      default:\n        // don't know what to do\n        // TODO handle this properly\n        console.warn(worker.target);\n        console.warn(\"unknown file type for worker\");\n    }\n  }\n\n  uploadFile(fileId, callback = null) {\n    const formData = new FormData();\n    let file = this.state.files.find(e => e.id == fileId);\n    console.log(file);\n    if (!file || !file.inputFile) {\n      // TODO handle this properly\n      console.error(this.state, file, fileId);\n      throw \"error\";\n    }\n    formData.append(\"file\", file.inputFile);\n    formData.append(\"fileIndex\", this.state.files.findIndex(f => f.id == file.id));\n\n    // store current writerId for later comparison\n    let writerId = this.state.writerId;\n\n    http.sendFile(\n      formData,\n      file => {\n        // update state only if it's the good writeId\n        if (writerId == this.state.writerId) {\n          file['status'] = 'ready';\n          this.updateFile(fileId, file, callback);\n        }\n      },\n      e => {\n        this.updateFile(\n          fileId,\n          {progress: Math.floor((e.loaded / e.total) * 100)}\n        )\n      },\n      e => {\n        console.warn(e);\n        alert.add(lang.t(\"error_upload\"), \"alert-danger\");\n        this.removeFile(fileId);\n      }\n    );\n  }\n\n  render() {\n    if (this.state.sending) {\n      return (\n        <div class=\"message-placeholder\">\n          <div class=\"spinner orange-spinner\">\n            <div /><div /><div /><div /><div />\n          </div>\n        </div>\n      );\n    }\n    return (\n      <div class=\"writer\">\n        {!this.props.isChild && (\n          <input\n            type=\"text\"\n            id=\"title\"\n            onKeyPress={e => this.onKeyPress(e)}\n            placeholder={lang.t(\"title_placeholder\")}\n           />\n        )}\n        <textarea\n          onKeyPress={e => this.onKeyPress(e, true)}\n          id=\"text\"\n          rows=\"5\"\n          autocomplete=\"off\"\n          autofocus={this.props.focus}\n          placeholder={lang.t(\"text_placeholder\")}\n          maxlength=\"50000\"\n         />\n        {this.state.preview && (\n          <EmbedBlock inWriter={true} {...this.state.preview} />\n        )}\n        {!!this.state.files.length && (\n          <FileGrid\n            key={this.state.files.reduce(\n              (a, c) => a + c.id + c.fileIndex + c.error,\n              \"\"\n            )}\n            files={this.state.files}\n            toggleFile={this.toggleFile}\n            inWriter={true}\n          />\n        )}\n        <div class=\"options\">\n          {api && api.info && api.info.upload && api.info.upload.image && (\n            <button\n              class=\"option\"\n              onClick={() => this.inputImages()}\n              title={lang.t(\"upload_image\")}\n            >\n              <FaIcon family={\"regular\"} icon={\"images\"} />\n            </button>\n          )}\n          {api && api.info && api.info.upload && api.info.upload.video && (\n            <button\n              class=\"option\"\n              onClick={() => this.inputVideo()}\n              title={lang.t(\"upload_video\")}\n            >\n              <FaIcon family={\"solid\"} icon={\"film\"} />\n            </button>\n          )}\n          {api && api.info && api.info.upload && api.info.upload.pdf && (\n            <button\n              class=\"option\"\n              onClick={() => this.inputGenericFile(\"application/pdf\")}\n              title={lang.t(\"upload_pdf\")}\n            >\n              <FaIcon family={\"regular\"} icon={\"file-pdf\"} />\n            </button>\n          )}\n          <div class=\"actions\">\n            {this.props.cancel && (\n              <button class=\"cancel\" onClick={e => this.props.cancel(e)}>\n                {lang.t(\"cancel\")}\n              </button>\n            )}\n            <button\n              disabled={!this.props.group}\n              type=\"submit\"\n              class=\"submit\"\n              onClick={e => this.sendMessage(e)}\n            >\n              {lang.t(\"submit\")}\n            </button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import { Fragment, h, Component } from \"preact\";\nimport { lang, http, me, router, util } from \"/core\";\nimport MessageChildren from \"./message-children.component.js\";\nimport MessageHead from \"./message-head.component.js\";\nimport MessageFooter from \"./message-footer.component.js\";\nimport MessageBody from \"./message-body.component.js\";\nimport Writer from \"./writer.component.js\";\n\nexport default class Message extends Component {\n  constructor(props) {\n    super(props);\n    this.getComponentClass = this.getComponentClass.bind(this);\n    this.editMessage = this.editMessage.bind(this);\n    this.deleteMessage = this.deleteMessage.bind(this);\n    this.shareMessage = this.shareMessage.bind(this);\n    this.publishInGroup = this.publishInGroup.bind(this);\n    this.cancelEdit = this.cancelEdit.bind(this);\n    this.onEditMessage = this.onEditMessage.bind(this);\n    this.openPublicLink = this.openPublicLink.bind(this);\n    window.addEventListener(\"editMessage\", this.onEditMessage);\n  }\n\n  async openPublicLink(event) {\n    event.preventDefault();\n    let newTab = window.open(\"about:blank\", \"_blank\");\n    const res = await http.get(\n      `/api/messages/${this.props.message.id}/get-public-link`\n    );\n    newTab.location = `${document.baseURI}public/${res.token}`;\n  }\n\n  onEditMessage(event) {\n    if (event.detail.id == this.props.message.id) {\n      this.props.key = +Date.now();\n      let msg = this.props.message;\n      msg.data = event.detail.data;\n      msg.files = event.detail.files;\n      this.setState({\n        message: msg,\n        data: msg.data,\n        gotPreview: false\n      });\n      setTimeout(() => this.setState({ edit: false }));\n    }\n  }\n\n  getComponentClass() {\n    let cn = \"message\";\n    if (this.props.isChild) {\n      cn += \" child\";\n    }\n    if (this.props.message.id == router.action) {\n      cn += \" highlight\";\n    }\n    return cn;\n  }\n\n  deleteMessage(event) {\n    event.preventDefault();\n    if (confirm(lang.t(\"ask_delete_message\"))) {\n      http.delete(`/api/messages/${this.props.message[\"id\"]}`);\n      if (this.props.isChild) {\n        this.setState({isRemoved: true});\n      } else {\n        router.navigate(`/groups/${this.props.message.group.id}`, {\n          data: {resetGroupDisplay: true}\n        });\n      }\n    }\n  }\n\n  shareMessage(event) {\n    event.preventDefault();\n    router.navigate(`/share?message=${  this.props.message.id}`);\n  }\n\n  editMessage(event) {\n    event.preventDefault();\n    this.setState({ edit: true });\n  }\n\n  publishInGroup() {\n    http\n      .put(`/api/messages/${  this.props.message.id}`, {\n        lastActivityDate: Math.floor(Date.now() / 1000),\n        isInFront: true\n      })\n      .then(res => {\n        if (!res) {\n          alert.add(lang.t(\"error\"), \"alert-danger\");\n          return;\n        }\n        router.navigate(`/groups/${  this.props.message.group.id}`);\n      });\n  }\n\n  cancelEdit(event) {\n    event.preventDefault();\n    this.setState({ edit: false });\n  }\n\n  displayWriter(isChild, focus) {\n    return (\n      <Writer\n        cancel={this.state.edit ? this.cancelEdit : null}\n        files={this.state.edit ? this.props.message.files : []}\n        focus={focus || !!this.state.edit}\n        group={this.props.message.group}\n        messageId={this.state.edit ? this.props.message.id : null}\n        parent={\n          this.state.edit ? this.props.message[\"parent\"] : this.props.message.id\n        }\n        text={this.state.edit ? this.props.message.data[\"text\"] : \"\"}\n        title={this.state.edit ? this.props.message.data[\"title\"] : \"\"}\n        isChild={isChild}\n      />\n    );\n  }\n\n  render() {\n    if (this.state.isRemoved) {\n      return null;\n    }\n    return (\n      <Fragment>\n        <div id={this.props.message.id} className={this.getComponentClass()}>\n          {this.state.edit && this.displayWriter(this.props.isChild)}\n          {!this.state.edit && (\n            <Fragment>\n              {this.props.preMessageHeadComponent}\n              <MessageHead\n                author={this.props.message[\"author\"]}\n                message={this.props.message}\n                isPublic={this.props.isPublic}\n                isChild={this.props.isChild}\n              />\n              <div class=\"main\">\n                <MessageBody\n                  message={this.props.message}\n                  isPublic={this.props.isPublic}\n                  isChild={this.props.isChild}\n                />\n                <MessageFooter\n                  author={this.props.message[\"author\"]}\n                  message={this.props.message}\n                  editMessage={this.editMessage}\n                  deleteMessage={this.deleteMessage}\n                  shareMessage={this.shareMessage}\n                  publishInGroup={this.publishInGroup}\n                  openPublicLink={this.openPublicLink}\n                  isPublic={this.props.isPublic}\n                  isChild={this.props.isChild}\n                />\n              </div>\n            </Fragment>\n          )}\n        </div>\n        {this.props.postMessageComponent}\n        {!this.props.isChild && (\n          <MessageChildren\n            childMessages={this.props.message.children}\n            isPublic={this.props.isPublic}\n            key={this.props.message.id}\n            id={this.props.message.id}\n          />\n        )}\n        {!this.state.edit && !this.props.isPublic && !this.props.isChild && (\n          <div class=\"message child mt-2\">\n            {me.me && (\n              <div class=\"message-head d-none d-md-block\">\n                <img\n                  class=\"rounded-circle w-3 material-shadow avatar\"\n                  style={util.backgroundHash(me.me.id)}\n                  src={\n                    me.me.avatar\n                      ? util.crop(me.me.avatar[\"id\"], 100, 100)\n                      : util.defaultAvatar\n                  }\n                />\n              </div>\n            )}\n            {this.displayWriter(true, this.props.focus)}\n          </div>\n        )}\n      </Fragment>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { me, util } from \"/core\";\nimport Message from \"./message.component.js\";\n\nexport default class MessageParent extends Component {\n  constructor(props) {\n    super(props);\n    this.onNewChild = this.onNewChild.bind(this);\n    window.addEventListener(\"newChild\", this.onNewChild);\n    this.state = { message: this.props.message };\n  }\n\n  componentDidMount() {\n    me.removeMatchingNotifications(this.props.message.id);\n    setTimeout(() => window.scrollTo(0, 0));\n  }\n\n  onNewChild(event) {\n    const newMsg = event.detail;\n    let msg = this.state.message;\n    if (newMsg.parent && util.getId(newMsg.parent) == msg[\"id\"]) {\n      newMsg.author = me.me;\n      msg.children = [...msg.children, newMsg];\n      this.setState(prevState => ({\n        lastDisplayedChild: prevState.lastDisplayedChild + 1,\n        message: msg\n      }));\n    }\n  }\n\n  render() {\n    // don't display the message if not loaded or removed\n    if (!this.state.message || this.state.isRemoved) {\n      return;\n    }\n\n    return (\n      <Message\n        message={this.state.message}\n        focus={this.props.focus}\n        isPublic={this.props.isPublic}\n        isChild={false}\n       />\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { http, me, router, util } from \"/core\";\nimport { FaIcon } from \"/misc\";\n\nexport default class MessagePreview extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      author: null,\n    };\n  }\n\n  componentDidMount() {\n    if (this.props.message && this.props.message.author) {\n      if (typeof(this.props.message.author) == \"string\") {\n        http\n          .get(`/api/users/${this.props.message.author}`)\n          .then(author => author && this.setState({ author }));\n      } else {\n        this.setState({author: this.props.message.author});\n      }\n    }\n  }\n\n  getAvatar(user) {\n    return (\n      <img\n        title={user ? user.name : \"--\"}\n        className={`avatar material-shadow${user ? \"\" : \" removed-user\"}`}\n        style={util.backgroundHash(user ? user.id : \"\")}\n        src={\n          user && user.avatar\n            ? util.crop(user.avatar[\"id\"], 100, 100)\n            : util.defaultAvatar\n        }\n        onError={e => (e.currentTarget.src = util.defaultAvatar)}\n      />\n    );\n  }\n\n  render() {\n    if (!this.props.message) {\n      return null;\n    }\n    return (\n      <a\n        class=\"d-inline-block seamless-link message-preview unselectable\"\n        href={router.toApp(`/messages/${this.props.message.id}`)}\n        onClick={e => router.onClick(e)}\n        title={this.props.message.data[\"title\"]}\n      >\n        <div tabindex={this.props.tabindex} class=\"card material-shadow-with-hover\">\n          {this.getAvatar(this.state.author)}\n          {this.props.message.preview ? (\n            <div\n              class=\"card-miniature\"\n              style={\n                `background-image: url('${util.crop(util.getId(this.props.message.preview), 320, 180)}')`\n              }\n            />\n          ) : (\n            <div class=\"text-preview\">{this.props.message.data[\"text\"]}</div>\n          )}\n          <div class=\"card-body border-top d-flex justify-content-between\">\n            <span class=\"left-buffer\" />\n            <span\n              class=\"title\"\n              title={\n                this.props.message.data[\"title\"] ||\n                util.humanFullDate(this.props.message.lastActivityDate)\n              }\n            >\n              {this.props.message.data[\"title\"] ||\n                util.humanTime(this.props.message.lastActivityDate)}\n            </span>\n            <span class=\"children\">\n              {!!this.props.message.children && (\n                <span>\n                  {`${Array.isArray(this.props.message.children) ? this.props.message.children.length : this.props.message.children} `}\n                  <FaIcon\n                    family={\n                      me.isNew(this.props.message.id) ? \"solid\" : \"regular\"\n                    }\n                    icon={\"comment\"}\n                  />\n                </span>\n              )}\n            </span>\n          </div>\n        </div>\n      </a>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { http, me, router, util } from \"/core\";\nimport { FaIcon } from \"/misc\";\n\nexport default class MessageSearchResult extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      message: props.message,\n      title: props.message.data[\"title\"] || \"\",\n      text: props.message.data[\"text\"] || \"\",\n      preview: props.message[\"preview\"] || null\n    };\n    this.getMiniature = this.getMiniature.bind(this);\n    this.getLink = this.getLink.bind(this);\n    this.displayMessageTitle = this.displayMessageTitle.bind(this);\n    this.displayMessageText = this.displayMessageText.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.props.message.author) {\n      http\n        .get(`/api/users/${  this.props.message.author}`)\n        .then(author => author && this.setState({ author }));\n    }\n  }\n\n  displayAuthorName() {\n    if (!this.state.author) {\n      return { __html: \"--\" };\n    }\n    let authorName = this.state.author.name;\n\n    // make the search terms stand out\n    let words = authorName.split(\" \");\n    for (let j = 0; j < words.length; j++) {\n      if (!words[j].match(util.urlRegExp)) {\n        let searchTerms = this.props.search.split(\" \");\n        for (let k = 0; k < searchTerms.length; k++) {\n          words[j] = words[j].replace(\n            new RegExp(searchTerms[k], \"gi\"),\n            \"<b>$&</b>\"\n          );\n        }\n      }\n    }\n    authorName = words.join(\" \");\n    return { __html: authorName };\n  }\n\n  displayMessageTitle() {\n    if (!this.props.message.data || !this.props.message.data[\"title\"]) {\n      return { __html: util.humanTime(this.props.message.lastActivityDate) };\n    }\n    // escape html a little (just enough to avoid xss I hope)\n    let title = this.props.message.data[\"title\"]\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\")\n      .trim();\n\n    // make the search terms stand out\n    let words = title.split(\" \");\n    for (let j = 0; j < words.length; j++) {\n      if (!words[j].match(util.urlRegExp)) {\n        let searchTerms = this.props.search.split(\" \");\n        for (let k = 0; k < searchTerms.length; k++) {\n          words[j] = words[j].replace(\n            new RegExp(searchTerms[k], \"gi\"),\n            \"<b>$&</b>\"\n          );\n        }\n      }\n    }\n    title = words.join(\" \");\n    return { __html: title };\n  }\n\n  displayMessageText() {\n    if (!this.props.message.data || !this.props.message.data[\"text\"]) {\n      return \"\";\n    }\n\n    // escape html a little (just enough to avoid xss I hope)\n    let txt = this.props.message.data[\"text\"]\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\")\n      .trim();\n\n    // make the search terms stand out for not url words\n    let lines = txt.split(\"\\n\");\n    for (let i = 0; i < lines.length; i++) {\n      let words = lines[i].split(\" \");\n      for (let j = 0; j < words.length; j++) {\n        if (!words[j].match(util.urlRegExp)) {\n          let searchTerms = this.props.search.split(\" \");\n          for (let k = 0; k < searchTerms.length; k++) {\n            if (!searchTerms[k]) {\n              continue;\n            }\n            words[j] = words[j].replace(\n              new RegExp(searchTerms[k], \"gi\"),\n              \"<b>$&</b>\"\n            );\n          }\n          let hashtags = this.props.hashtags.split(\" \");\n          for (let k = 0; k < hashtags.length; k++) {\n            if (!hashtags[k]) {\n              continue;\n            }\n            words[j] = words[j].replace(\n              new RegExp(`#${  hashtags[k]}`, \"gi\"),\n              \"<b>$&</b>\"\n            );\n          }\n        }\n      }\n      lines[i] = words.join(\" \");\n    }\n    txt = lines.join(\"\\n\");\n\n    // replace url by real links\n    let shift = 0;\n    let match = null;\n    while ((match = util.getUrl(txt.slice(shift)))) {\n      let url = match[0];\n      if (url.length >= 50) {\n        url = `${url.slice(0, 25)  }...${  url.slice(-24)}`;\n      }\n      let searchTerms = this.props.search.split(\" \");\n      for (let i = 0; i < searchTerms.length; i++) {\n        url = url.replace(new RegExp(searchTerms[i], \"gi\"), \"<b>$&</b>\");\n      }\n      let link = `<a href=\"${  match[0]  }\" target=\"_blank\">${  url  }</a>`;\n      txt =\n        txt.slice(0, match[\"index\"] + shift) +\n        link +\n        txt.slice(match[\"index\"] + shift + match[0].length);\n      shift += match[\"index\"] + link.length;\n    }\n\n    // replace line returns\n    txt = txt.replace(/\\n/g, \"<br/>\");\n\n    return { __html: txt };\n  }\n\n  getMiniature() {\n    if (this.state.preview) {\n      return (\n        <div\n          class=\"card-miniature\"\n          style={\n            `background-image: url('${ \n            util.crop(this.state.preview, 100, 100) \n            }')`\n          }\n        />\n      );\n    }\n    let avatar = util.defaultAvatar;\n    if (\n      this.state.author &&\n      this.state.author.avatar &&\n      this.state.author.avatar.id\n    ) {\n      avatar = util.crop(this.state.author.avatar[\"id\"], 100, 100);\n    }\n    return (\n      <div\n        class=\"card-miniature\"\n        style={`background-image: url('${  avatar  }')`}\n      />\n    );\n  }\n\n  getLink() {\n    if (this.state.message.parent && this.state.message.children == 0) {\n      return (\n        `/messages/${  this.state.message.parent  }/${  this.state.message.id}`\n      );\n    }\n    return `/messages/${  this.state.message.id}`;\n  }\n\n  render() {\n    return (\n      <a\n        class=\"d-inline-block seamless-link message-preview unselectable\"\n        href={router.toApp(this.getLink())}\n        onClick={e => router.onClick(e)}\n        title={this.state.title}\n      >\n        <div tabindex={this.props.tabindex} class=\"card material-shadow-with-hover\">\n          <div class=\"card-body border-top\">\n            {this.getMiniature()}\n            <div class=\"infos\">\n              <div\n                class=\"title\"\n                dangerouslySetInnerHTML={this.displayAuthorName()}\n               />\n              <div class=\"dot\">&bull;</div>\n              <div\n                class=\"title\"\n                title={\n                  this.state.title ||\n                  util.humanFullDate(this.state.message.lastActivityDate)\n                }\n                dangerouslySetInnerHTML={this.displayMessageTitle()}\n               />\n            </div>\n            <div class=\"text\">\n              {this.state.text.trim() && (\n                <p\n                  class=\"card-text\"\n                  dangerouslySetInnerHTML={this.displayMessageText()}\n                 />\n              )}\n            </div>\n            <div class=\"children\">\n              {!!this.state.message.children && (\n                <span>\n                  {`${this.state.message.children  } `}\n                  <FaIcon\n                    family={\n                      me.isNew(this.state.message.id) ? \"solid\" : \"regular\"\n                    }\n                    icon={\"comment\"}\n                  />\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n      </a>\n    );\n  }\n}\n","import _FileGrid from \"./file-grid.component.js\";\nimport _MessageParent from \"./message-parent.component.js\";\nimport _MessageChild from \"./message-child.component.js\";\nimport _MessageBody from \"./message-body.component.js\";\nimport _MessageChildren from \"./message-children.component.js\";\nimport _MessageHead from \"./message-head.component.js\";\nimport _MessageFooter from \"./message-footer.component.js\";\nimport _MessagePreview from \"./message-preview.component.js\";\nimport _MessageSearchResult from \"./message-search-result.component.js\";\nimport _EmbedBlock from \"./embed-block.component.js\";\n\nexport const FileGrid = _FileGrid;\nexport const MessageBody = _MessageBody;\nexport const MessageFooter = _MessageFooter;\nexport const MessageParent = _MessageParent;\nexport const MessageChild = _MessageChild;\nexport const MessageChildren = _MessageChildren;\nexport const MessageHead = _MessageHead;\nexport const MessagePreview = _MessagePreview;\nexport const MessageSearchResult = _MessageSearchResult;\nexport const EmbedBlock = _EmbedBlock;\n","import { h, Component } from \"preact\";\nimport { lang, me, router, util, http } from \"/core\";\nimport { MessageSearchResult } from \"/message\";\n\nexport default class GroupSearch extends Component {\n  constructor(props) {\n    super(props);\n    let groupId = util.getId(router.id);\n    this.state = {\n      groupId,\n      loaded: false,\n      messages: [],\n      totalMessages: 0,\n      search: \"\",\n      hashtags: \"\",\n    };\n    this.loadMessages = this.loadMessages.bind(this);\n  }\n\n  getGroupName() {\n    if (me.me.groups && router.entity.entityType == \"group\") {\n      let group = me.me.groups.find(g => g[\"id\"] == util.getId(router.entity));\n      return group ? group[\"name\"] : \"\";\n    }\n    return \"\";\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"routerStateChange\", this.loadMessages);\n  }\n\n  componentDidMount() {\n    this.loadMessages();\n    window.addEventListener(\"routerStateChange\", this.loadMessages);\n  }\n\n  loadMessages() {\n    const search = router.getParam(\"search\").replace(/\\+/g, \" \");\n    const hashtags = router.getParam(\"hashtags\").replace(/\\+/g, \" \");\n    this.setState({search, hashtags});\n    http\n      .post(\"/api/messages/search\", {\n        group: this.state.groupId,\n        search,\n        hashtags\n      })\n      .then(res => {\n        if (res && Array.isArray(res[\"messages\"])) {\n          this.setState({\n            search,\n            messages: res[\"messages\"],\n            totalMessages: res[\"totalItems\"],\n            loaded: true\n          });\n        }\n      });\n  }\n\n  render() {\n    return (\n      Array.isArray(this.state.messages) && (\n        <div>\n          <a\n            href={router.toApp(`/groups/${  util.getGroupId()}`)}\n            onClick={e => router.onClick(e)}\n          >\n            <div class=\"group-name no-decoration\">{util.getGroupName()}</div>\n          </a>\n          <article id=\"group\" class=\"justify-content-center d-flex\">\n            <div class=\"search-results-container container-fluid d-flex justify-content-center flex-wrap\">\n              {this.state.messages.length == 0 && !this.state.loaded && (\n                <p>\n                  <div class=\"mt-5 spinner orange-spinner\">\n                    <div /><div /><div /><div /><div />\n                  </div>\n                </p>\n              )}\n              {this.state.messages.length == 0 && this.state.loaded && (\n                <p>{lang.t(\"search_without_result\")}</p>\n              )}\n              {this.state.messages.map((msg, i) => {\n                return (\n                  <MessageSearchResult\n                    tabindex={i + 1}\n                    key={msg.id}\n                    message={msg}\n                    groupId={this.state.groupId}\n                    search={this.state.search}\n                    hashtags={this.state.hashtags}\n                  />\n                );\n              })}\n            </div>\n          </article>\n        </div>\n      )\n    );\n  }\n}\n","import { h, Component, Fragment } from \"preact\";\nimport { lang, me, router } from \"/core\";\nimport { FaIcon } from \"/misc\";\n\nexport default class GroupsDropdownNavbar extends Component {\n  constructor(props) {\n    super(props);\n    // force update the navbar when me gets updated\n    addEventListener(\"meStateChange\", () => this.setState({}));\n  }\n\n  render() {\n    return (\n      <Fragment>\n        {me.me.groups && (\n          <div\n            class=\"nav-link dropdown groups unselectable\"\n            tabindex=\"-1\"\n            onClick={e => e.currentTarget.classList.toggle(\"active\")}\n          >\n            <div class=\"unselectable pr-1\">\n              {lang.t(\"groups\")} <FaIcon family={\"solid\"} icon={\"caret-down\"} />\n            </div>\n            <div class=\"dropdown-menu dropdown-left\">\n              {me.me.groups.map(e => (\n                <a\n                  class=\"d-block seamless-link unselectable\"\n                  href={router.toApp(`/groups/${  e.id}`)}\n                  onClick={e => router.onClick(e)}\n                >\n                  {e.name}\n                </a>\n              ))}\n              <a\n                class=\"seamless-link unselectable\"\n                href={router.toApp(\"/create-group\")}\n                onClick={e => router.onClick(e)}\n              >\n                {`+ ${  lang.t(\"create_a_group\")}`}\n              </a>\n            </div>\n          </div>\n        )}\n      </Fragment>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, http } from \"/core\";\n\nexport default class CreateGroup extends Component {\n  constructor() {\n    super();\n    this.postNewGroup = this.postNewGroup.bind(this);\n  }\n\n  postNewGroup(event) {\n    event.preventDefault();\n    const name = document.querySelector(\"#create_group_form input[name='name']\")\n      .value;\n    let group = {};\n    if (name) {\n      group.name = name;\n    } else {\n      return false;\n    }\n    group.createdAt = Math.floor(Date.now() / 1000);\n    http.post(\"/api/groups\", group).then(res => {\n      http.post(`/api/groups/invitation/${  res.secretKey}`, {}).then(res => {\n        window.location = `${window.location.origin}/groups/${res.id}`;\n      });\n    });\n  }\n\n  render() {\n    return (\n      <div class=\"container mt-2\">\n        <div class=\"group-settings\">\n          <div class=\"card\">\n            <div class=\"card-body\">\n              <div class=\"container-fluid p-1\">\n                <div class=\"row\">\n                  <div class=\"col-12 col-md-10\">\n                    <form id=\"create_group_form\" class=\"mb-1\">\n                      <div class=\"form-group\">\n                        <label for=\"name\">{lang.t(\"name\")}: </label>\n                        <input\n                          type=\"text\"\n                          name=\"name\"\n                          minlength=\"1\"\n                          maxlength=\"128\"\n                          placeholder={lang.t(\"name_input\")}\n                          class=\"form-control\"\n                          required\n                         />\n                      </div>\n                      <button\n                        onClick={e => this.postNewGroup(e)}\n                        class=\"btn btn-primary\"\n                      >\n                        {lang.t(\"create_the_group\")}\n                      </button>\n                    </form>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { http, router, util } from \"/core\";\nimport { MessagePreview } from \"/message\";\nimport { GroupTitle } from \"/pages\";\n\nexport default class GroupBoard extends Component {\n  constructor(props) {\n    super(props);\n    let groupId = util.getId(router.id);\n    let loaded =\n      1 +\n      Math.floor((window.screen.width * window.screen.height) / (320 * 215));\n    this.state = {\n      groupId,\n      loaded,\n      messages: [],\n      scrollTop: 0,\n      totalMessages: 0,\n      pageYOffset: 0,\n      page: 0\n    };\n    this.scroll_cooldown = Date.now();\n    this.onScroll = this.onScroll.bind(this);\n    this.loadMessages = this.loadMessages.bind(this);\n    this.onNewParent = this.onNewParent.bind(this);\n    window.addEventListener(\"newParent\", this.onNewParent);\n  }\n\n  onNewParent() {\n    this.loadMessages(0);\n  }\n\n  componentDidMount() {\n    this.loadMessages(0);\n    window.addEventListener(\"scroll\", this.onScroll);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"scroll\", this.onScroll);\n  }\n\n  loadMessages(page) {\n    http\n      .get(`/api/groups/${  this.state.groupId  }/page/${  page}`)\n      .then(res => {\n        if (res && Array.isArray(res[\"messages\"])) {\n          let new_loaded = Math.max(this.state.loaded, page * 30);\n          let msgList = this.state.messages;\n          // don't add already added messages\n          res[\"messages\"].map(\n            m => !msgList.find(msg => msg.id == m.id) && msgList.push(m)\n          );\n          this.setState({\n            messages: msgList,\n            totalMessages: res[\"totalItems\"],\n            page,\n            loaded: new_loaded\n          });\n          if ((page + 1) * 30 < new_loaded) {\n            setTimeout(() => this.loadMessages(page + 1));\n          }\n        }\n      });\n  }\n\n  onScroll() {\n    // prevent loading messages if we are in a post\n    if (\n      window.getComputedStyle(document.getElementById(\"group\").parentNode)\n        .display == \"none\"\n    ) {\n      return;\n    }\n    // don't load if on cooldown\n    if (this.scroll_cooldown + 100 < Date.now()) {\n      this.scroll_cooldown = Date.now();\n      this.setState({ pageYOffset: window.pageYOffset });\n      // don't load if unecessary\n      if (\n        Array.isArray(this.state.messages) &&\n        document.body.scrollHeight - window.screen.height - 500 <\n          window.pageYOffset &&\n        this.state.loaded < this.state.totalMessages\n      ) {\n        this.setState(prevState => ({ loaded: prevState.loaded + 10 }));\n        if (this.state.loaded + 30 > this.state.messages.length) {\n          this.loadMessages(this.state.page + 1);\n          // update page count right away\n          this.setState(prevState => ({ page: prevState.page + 1 }));\n        }\n      }\n    }\n  }\n\n  render() {\n    return (\n      Array.isArray(this.state.messages) && (\n        <div>\n          <GroupTitle\n            key={util.getGroupId()}\n            id={util.getGroupId()}\n            name={util.getGroupName()}\n          />\n          <article id=\"group\" class=\"justify-content-center d-flex\">\n            <div class=\"message-container container-fluid d-flex justify-content-center flex-wrap\">\n              {this.state.messages.slice(0, this.state.loaded).map((msg, i) => {\n                return (\n                  <MessagePreview\n                    tabindex={i + 1}\n                    key={msg.id}\n                    message={msg}\n                    groupId={util.getId(router.id)}\n                  />\n                );\n              })}\n            </div>\n          </article>\n        </div>\n      )\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { http, me, lang, router } from \"/core\";\nimport { MessagePreview } from \"/message\";\n\nexport default class BookmarkBoard extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      messages: [],\n    }\n    this.loadBookmarks = this.loadBookmarks.bind(this);\n    // force update the navbar when me gets updated\n    addEventListener(\"meStateChange\", () => this.loadBookmarks());\n  }\n\n  loadBookmarks() {\n    if (me.me && me.me.data && Array.isArray(me.me.data.bookmarks)) {\n      Promise.all(me.me.data.bookmarks.map(bid => {\n        return http.get(`/api/messages/${bid}`);\n      })).then(messages => this.setState({messages}));\n    }\n  }\n\n  componentDidMount() {\n    this.loadBookmarks();\n  }\n\n  render() {\n    if (!Array.isArray(this.state.messages) || this.state.messages.length < 1) {\n      return;\n    }\n    return (\n      <div>\n        <a\n          href={router.toApp(\"/bookmarks\")}\n          onClick={e => router.onClick(e)}\n          class=\"no-decoration\"\n        >\n          <div class=\"group-name\">{lang.t(\"bookmarks\")}</div>\n        </a>\n        <article id=\"group\" class=\"justify-content-center d-flex\">\n          <div class=\"message-container container-fluid d-flex justify-content-center flex-wrap\">\n            {this.state.messages.map((msg, i) => {\n              if (msg && msg[\"id\"]) {\n                return (\n                  <MessagePreview\n                    tabindex={i + 1}\n                    key={msg.id}\n                    message={msg}\n                    groupId={msg.group.id}\n                  />\n                );\n              }\n            })}\n          </div>\n        </article>\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, me, alert, http, router, util } from \"/core\";\n\nexport default class GroupSettings extends Component {\n  constructor(props) {\n    super(props);\n    this.updateSettings = this.updateSettings.bind(this);\n    this.leaveGroup = this.leaveGroup.bind(this);\n    this.leave = this.leave.bind(this);\n    this.resetSecretKey = this.resetSecretKey.bind(this);\n    this.state = Object.assign({ hydratedUsers: [] }, props);\n  }\n\n  resetSecretKey(event) {\n    event.preventDefault();\n    http\n      .post(`/api/groups/${  this.state.id  }/reset-invite-key`, {})\n      .then(res => {\n        alert.add(lang.t(\"group_updated\"));\n        this.setState({ secretKey: res[\"inviteKey\"] });\n      });\n  }\n\n  updateSettings(event) {\n    event.preventDefault();\n    const name = document.querySelector(\"#settings_form input[name='name']\")\n      .value;\n    let group = {};\n    if (name) {\n      group.name = name;\n    }\n    http.put(`/api/groups/${  this.state.id}`, group).then(res => {\n      alert.add(lang.t(\"group_updated\"));\n      this.setState(prevState => Object.assign(prevState, res));\n    });\n  }\n\n  leaveGroup(event) {\n    event.preventDefault();\n    if (me.me.data[\"default_group\"] == this.state.id) {\n      let user = {};\n      user.data = { default_group: me.me.groups[0].id };\n      http.put(`/api/users/${  me.me.id}`, user).then(() => {\n        me.update();\n        this.leave();\n      });\n    } else {\n      this.leave();\n    }\n  }\n\n  leave() {\n    http.post(`/api/groups/${  this.state.id  }/leave`, {}).then(res => {\n      if (!res || !res[\"entityType\"]) {\n        alert.add(lang.t(\"error\"), \"alert-danger\");\n      } else {\n        me.update();\n        alert.add(lang.t(\"group_left\"));\n        router.navigate(\"/\");\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div>\n        <div class=\"group-settings mb-3\">\n          <div class=\"card\">\n            <div class=\"card-body\">\n              <div class=\"container-fluid p-1\">\n                <div class=\"row\">\n                  <div class=\"col-12 col-md-10\">\n                    <form id=\"settings_form\" class=\"mb-1 border-bottom pb-1\">\n                      <div class=\"form-group\">\n                        <label for=\"name\">{lang.t(\"name\")}: </label>\n                        <input\n                          type=\"text\"\n                          name=\"name\"\n                          minlength=\"1\"\n                          maxlength=\"128\"\n                          placeholder={lang.t(\"name_input\")}\n                          value={this.state.name}\n                          class=\"form-control\"\n                          required\n                         />\n                      </div>\n                      <button\n                        onClick={this.updateSettings}\n                        class=\"btn btn-outline-secondary\"\n                      >\n                        {lang.t(\"save_changes\")}\n                      </button>\n                    </form>\n                    <form class=\"mb-1 border-bottom pb-1\">\n                      <div class=\"form-group\">\n                        <label for=\"inviteKey\">\n                          {lang.t(\"invitation_link\")}:{\" \"}\n                        </label>\n                        <input\n                          type=\"text\"\n                          name=\"inviteKey\"\n                          value={\n                            `${location.protocol \n                            }//${ \n                            location.host \n                            }/invitation/${ \n                            this.state.secretKey}`\n                          }\n                          class=\"form-control font-size-80\"\n                          readonly=\"readonly\"\n                         />\n                      </div>\n                      <button\n                        class=\"btn btn-outline-secondary\"\n                        onClick={this.resetSecretKey}\n                      >\n                        {lang.t(\"reset_invitation_link\")}\n                      </button>\n                    </form>\n                    <form>\n                      <button\n                        onClick={e => this.leaveGroup(e)}\n                        class=\"btn btn-outline-danger\"\n                      >\n                        {lang.t(\"quit_group\")}\n                      </button>\n                    </form>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <div class=\"user-list mb-3\">\n          <h3>{lang.t(\"users\")}</h3>\n          {this.props.users.map(\n            user =>\n              user && (\n                <div class=\"user-card\">\n                  <img\n                    class=\"avatar material-shadow-with-hover\"\n                    style={util.backgroundHash(user.id)}\n                    src={\n                      user.avatar\n                        ? util.crop(user.avatar[\"id\"], 200, 200)\n                        : util.defaultAvatar\n                    }\n                    onError={e => (e.currentTarget.src = util.defaultAvatar)}\n                  />\n                  <span>{user[\"name\"]}</span>\n                </div>\n              )\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, router, me, alert, http, util, cache, storage } from \"/core\";\n\nexport default class UserSettings extends Component {\n  constructor(props) {\n    super(props);\n    this.destroyAccount = this.destroyAccount.bind(this);\n    this.inputAvatar = this.inputAvatar.bind(this);\n    this.updateSettings = this.updateSettings.bind(this);\n    this.resetApiKey = this.resetApiKey.bind(this);\n    this.state = Object.assign({apiKey: \"\"}, props);\n  }\n\n  componentDidMount() {\n    storage.get(\"apiKey\").then(apiKey => this.setState({apiKey}));\n  }\n\n  resetApiKey(event) {\n    event.preventDefault();\n    http.post(`/api/users/${this.state.id}/reset-api-key`, {}).then(() => util.logout());\n  }\n\n  inputAvatar() {\n    const input = document.createElement(\"input\");\n    input.type = \"file\";\n    input.accept = \"image/*\";\n    input.addEventListener(\"change\", event => {\n      import(\"/lazy/image-service.js\").then(imageService => {\n        imageService.default.handleImage(\n          event.target.files[0],\n          blob => {\n            const formData = new FormData();\n            formData.append(\"file\", blob);\n            http.post(\"/api/files\", formData, false).then(file => {\n              http\n                .put(`/api/users/${this.state.id}`, { avatar: file[\"id\"] })\n                .then(() => {\n                  this.setState({ avatar: file });\n                  alert.add(lang.t(\"settings_updated\"));\n                });\n            });\n          }\n        );\n      });\n    });\n    input.click();\n  }\n\n  destroyAccount(event) {\n    event.preventDefault();\n    let confirmDeletion = confirm(lang.t(\"are_you_sure\"));\n    if (confirmDeletion) {\n      http.delete(`/api/users/${this.state.id}`).then(() => {\n        router.navigate(\"/logout\");\n      });\n    }\n  }\n\n  updateSettings(event) {\n    event.preventDefault();\n    const name = document.querySelector(\"#settings_form input[name='name']\")\n      .value;\n    const login = document.querySelector(\"#settings_form input[name='email']\")\n      .value;\n    const password = document.querySelector(\n      \"#settings_form input[name='password']\"\n    ).value;\n    const notification_emails = document.querySelector(\n      \"#settings_form select[name='notification_emails']\"\n    ).value;\n    const default_group = document.querySelector(\n      \"#settings_form select[name='default_group']\"\n    ).value;\n    const lang = document.querySelector(\"#settings_form select[name='lang']\")\n      .value;\n    let user = {};\n    if (name) {\n      user.name = name;\n    }\n    if (login) {\n      user.login = login;\n    }\n    if (password) {\n      user.password = password;\n    }\n    user.data = {\n      notification_emails,\n      default_group,\n      lang\n    };\n    http.put(`/api/users/${this.state.id}`, user).then(res => {\n      if (res[\"error\"]) {\n        alert.add(res[\"error\"], \"alert-danger\");\n      } else {\n        cache.removeMatching(this.state.id);\n        this.setState(prevState => Object.assign(prevState, res));\n        location.href = router.toApp(\n          `${location.pathname}?alert=settings_updated`\n        );\n      }\n    });\n  }\n\n  render() {\n    return (\n      <div class=\"user-settings\">\n        <div class=\"card\">\n          <div class=\"identite card-body\">\n            <div class=\"container-fluid p-1\">\n              <div class=\"row\">\n                <div class=\"col-12 col-md-2\">\n                  <img\n                    class=\"img-fluid rounded-circle material-shadow avatar\"\n                    src={\n                      this.state.avatar\n                        ? util.crop(this.state.avatar[\"id\"], 100, 100)\n                        : util.defaultAvatar\n                    }\n                    style={util.backgroundHash(this.state['id'] || \"\")}\n                    onError={e => (e.currentTarget.src = util.defaultAvatar)}\n                    onClick={e => this.inputAvatar(e)}\n                  />\n                </div>\n                <div class=\"col-12 col-md-10\">\n                  <form id=\"settings_form\" class=\"mb-3\">\n                    <div class=\"form-group\">\n                      <label for=\"name\">{lang.t(\"name\")}: </label>\n                      <input\n                        type=\"text\"\n                        name=\"name\"\n                        minlength=\"1\"\n                        maxlength=\"128\"\n                        placeholder={lang.t(\"name_input\")}\n                        value={this.state.name}\n                        class=\"form-control\"\n                       />\n                    </div>\n                    <div class=\"form-group\">\n                      <label for=\"email\">{lang.t(\"email\")}: </label>\n                      <input\n                        type=\"email\"\n                        name=\"email\"\n                        placeholder={lang.t(\"email_input\")}\n                        value={this.state.login}\n                        class=\"form-control\"\n                       />\n                    </div>\n                    <div class=\"form-group\">\n                      <label for=\"password\">{lang.t(\"password\")}: </label>\n                      <input\n                        type=\"password\"\n                        name=\"password\"\n                        autocomplete=\"off\"\n                        minlength=\"8\"\n                        maxlength=\"128\"\n                        placeholder={lang.t(\"password_input\")}\n                        class=\"form-control\"\n                       />\n                    </div>\n                    <div class=\"form-group\">\n                      <label for=\"notification_emails\">\n                        {lang.t(\"notification_emails\")}:\n                      </label>\n                      <select\n                        name=\"notification_emails\"\n                        class=\"form-control\"\n                        value={this.state.data[\"notification_emails\"]}\n                      >\n                        <option value=\"none\">{lang.t(\"none\")}</option>\n                        <option value=\"hourly\">{lang.t(\"hourly\")}</option>\n                        <option value=\"daily\">{lang.t(\"daily\")}</option>\n                        <option value=\"weekly\">{lang.t(\"weekly\")}</option>\n                        <option value=\"monthly\">{lang.t(\"monthly\")}</option>\n                      </select>\n                    </div>\n                    <div class=\"form-group\">\n                      <label for=\"default_group\">\n                        {lang.t(\"default_group\")}:\n                      </label>\n                      <select\n                        name=\"default_group\"\n                        class=\"form-control\"\n                        value={this.state.data[\"default_group\"]}\n                      >\n                        {me.me.groups.map(e => (\n                          <option value={e.id}>{e.name}</option>\n                        ))}\n                      </select>\n                    </div>\n                    <div class=\"form-group\">\n                      <label class=\"capitalize\" for=\"lang\">\n                        {lang.t(\"lang\")}:\n                      </label>\n                      <select\n                        name=\"lang\"\n                        class=\"form-control\"\n                        value={lang.getCurrentLang()}\n                      >\n                        {Object.keys(lang.possibleLang).map(k => (\n                          <option value={k}>{lang.possibleLang[k]}</option>\n                        ))}\n                      </select>\n                    </div>\n                    <button\n                      onClick={e => this.updateSettings(e)}\n                      class=\"btn btn-primary\"\n                    >\n                      {lang.t(\"save_changes\")}\n                    </button>\n                  </form>\n                  <form id=\"api_key_form\">\n                    <div class=\"form-group\">\n                      <label for=\"apiKey\">\n                        {lang.t(\"api_key\")}:{\" \"}\n                      </label>\n                      <input\n                        type=\"text\"\n                        name=\"apiKey\"\n                        value={this.state.apiKey}\n                        class=\"form-control font-size-80\"\n                        readonly=\"readonly\"\n                       />\n                    </div>\n                    <button\n                      class=\"btn btn-outline-secondary\"\n                      onClick={this.resetApiKey}\n                    >\n                      {lang.t(\"reset_api_key\")}\n                    </button>\n                  </form>\n                  <form id=\"destroy_form\">\n                    <label class=\"d-block\" for=\"destroy_account\">\n                      {lang.t(\"destroy_account_explain\")}\n                    </label>\n                    <button\n                      onClick={e => this.destroyAccount(e)}\n                      name=\"destroy_account\"\n                      class=\"btn btn-danger\"\n                    >\n                      {lang.t(\"destroy_account\")}\n                    </button>\n                  </form>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        {this.state.alert && (\n          <div class=\"global-alert alert alert-success\">{this.state.alert}</div>\n        )}\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { http, lang, me, router } from \"/core\";\nimport UserSettings from \"./user-settings.component.js\";\nimport GroupSettings from \"./group-settings.component.js\";\n\nexport default class Settings extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n    if (props.entityUrl) {\n      http.get(props.entityUrl).then(res => this.setState({ entity: res }));\n    }\n  }\n\n  render() {\n    if (!this.state.entity || !me.me) {\n      return;\n    }\n    return (\n      <div class=\"settings\">\n        <ul class=\"nav nav-tabs\">\n          <li class=\"nav-item\">\n            <a\n              class={\n                `nav-link${ \n                this.state.entity[\"entityType\"] == \"user\" ? \" active\" : \"\"}`\n              }\n              href={router.toApp(`/users/${  me.me.id  }/settings`)}\n              onClick={e => router.onClick(e)}\n            >\n              {lang.t(\"account\")}\n            </a>\n          </li>\n          {me.me.groups.length > 0 && (\n            <li\n              class=\"nav-item dropdown group-list\"\n              tabindex=\"-1\"\n              onClick={e => e.currentTarget.classList.toggle(\"active\")}\n            >\n              <div\n                class={\n                  `nav-link${ \n                  this.state.entity[\"entityType\"] == \"group\" ? \" active\" : \"\"}`\n                }\n              >\n                {lang.t(\"groups\")}\n              </div>\n              <div class=\"dropdown-menu\">\n                {me.me.groups.map(e => (\n                  <a\n                    class=\"seamless-link\"\n                    href={router.toApp(`/groups/${  e.id  }/settings`)}\n                    onClick={e => router.onClick(e)}\n                  >\n                    {e.name}\n                  </a>\n                ))}\n              </div>\n            </li>\n          )}\n        </ul>\n        {this.state.entity[\"entityType\"] === \"user\" && (\n          <UserSettings {...this.state.entity} />\n        )}\n        {this.state.entity[\"entityType\"] === \"group\" && (\n          <GroupSettings {...this.state.entity} />\n        )}\n      </div>\n    );\n  }\n}\n","import _GroupSettings from \"./group-settings.component.js\";\nimport _Settings from \"./settings.component.js\";\nimport _UserSettings from \"./user-settings.component.js\";\n\nexport const GroupSettings = _GroupSettings;\nexport const Settings = _Settings;\nexport const UserSettings = _UserSettings;\n","import { h } from \"preact\";\nimport { util, router } from \"/core\";\nimport { MessageParent } from \"/message\";\nimport { CreateGroup, GroupTitle, GroupBoard, Share, BookmarkBoard } from \"/pages\";\nimport { Settings } from \"/settings\";\nimport { GroupSearch } from \"/navbar\";\nimport { FaIcon } from \"/misc\";\nimport Writer from \"/message/writer.component.js\";\n\nexport default function MainContent(props) {\n  if (props.action == \"settings\") {\n    return (\n      <article class=\"mt-2 justify-content-center d-flex\">\n        <div class=\"container pb-3\">\n          <Settings\n            key={props.entityUrl}\n            entityUrl={props.entityUrl}\n          />\n        </div>\n      </article>\n    );\n  }\n  switch (props.route) {\n    case \"create-group\":\n      return <CreateGroup />;\n    case \"share\":\n      return <Share />;\n    case \"messages\":\n      return (\n        <article class=\"mb-3 justify-content-center d-flex\">\n          <div class=\"container pb-3\">\n            <GroupTitle\n              key={util.getGroupId()}\n              id={util.getGroupId()}\n              name={util.getGroupName()}\n            />\n            <MessageParent\n              focus={!!router.getParam(\"focus\", router.search)}\n              key={router.entity.id}\n              message={router.entity}\n            />\n          </div>\n        </article>\n      );\n    case \"bookmarks\":\n      return (\n        <div>\n          <BookmarkBoard />\n        </div>\n      );\n    case \"groups\":\n      if (props.action == \"write\") {\n        return (\n          <article class=\"mb-3\">\n            <div class=\"container pb-3\">\n              <GroupTitle\n                key={util.getGroupId()}\n                id={util.getGroupId()}\n                name={util.getGroupName()}\n              />\n              <Writer focus={true} group={props.id} />\n            </div>\n          </article>\n        );\n      }\n      if (router.getParam(\"search\") || router.getParam(\"hashtags\")) {\n        return (\n          <div>\n            <GroupSearch key={props.id} />\n          </div>\n        );\n      }\n      return (\n        <div>\n          <GroupBoard key={props.id} />\n          <a\n            class=\"write-button material-shadow-with-hover seamless-link\"\n            href={router.toApp(`/groups/${props.id}/write`)}\n            onClick={e => router.onClick(e)}\n          >\n            <FaIcon family={\"solid\"} icon={\"pencil-alt\"} />\n          </a>\n        </div>\n      );\n    default:\n  }\n}\n","import { h, Component, Fragment } from \"preact\";\nimport { http, lang, me, router, util } from \"/core\";\n\nexport default class Notification extends Component {\n  constructor(props) {\n    super(props);\n    this.getMiniature = this.getMiniature.bind(this);\n    this.setMiniatureOnError = this.setMiniatureOnError.bind(this);\n    this.getAction = this.getAction.bind(this);\n    this.getTarget = this.getTarget.bind(this);\n    this.getTitle = this.getTitle.bind(this);\n    this.state = {\n      target: this.getTarget(),\n      action: this.getAction(),\n      title: this.getTitle(),\n    };\n  }\n\n  getMiniature() {\n    let imgSrc = util.defaultAvatar;\n    if (\n      this.props.fromUser &&\n      this.props.fromUser.avatar &&\n      this.props.type != \"global_notification\"\n    ) {\n      imgSrc = util.crop(this.props.fromUser.avatar[\"id\"], 80, 80);\n    }\n    return (\n      <img\n        style={util.backgroundHash(\n          this.props.fromUser ? this.props.fromUser.id : \"\"\n        )}\n        src={imgSrc}\n        onError={e => this.setMiniatureOnError(e)}\n      />\n    );\n  }\n\n  setMiniatureOnError(event) {\n    event.currentTarget.src = util.defaultAvatar;\n  }\n\n  getAction() {\n    switch (this.props.type) {\n      case \"new_message\":\n        return lang.t(\"has_posted_in\");\n      case \"new_comment\":\n        return lang.t(\"has_commented_on\");\n      case \"user_joined_group\":\n        return lang.t(\"has_joined\");\n      case \"user_left_group\":\n        return lang.t(\"has_left\");\n      case \"group_name_change\":\n        return lang.t(\"changed_group_name\");\n      default:\n        return \"\";\n    }\n  }\n\n  getTitle() {\n    switch (this.props.type) {\n      case \"new_message\":\n      case \"new_comment\":\n        if (this.props.fromMessage && this.props.fromMessage['data']) {\n          if (this.props.fromMessage['data']['title']) {\n            return this.props.fromMessage['data']['title'];\n          }\n          if (this.props.fromMessage['data']['text']) {\n            let url = util.getUrl(this.props.fromMessage['data']['text']);\n            if (url && url.length > 0) {\n              url = url[0];\n            }\n            if (url) {\n              http.get(`/api/links/by_url?url=${encodeURIComponent(url)}`).then(r => {\n                this.setState({title: r.data['title'] || r.data['description'] || r.data['url']});\n              });\n              return url;\n            }\n            return this.props.fromMessage['data']['text'];\n          }\n        }\n        return \"\";\n      default:\n        return \"\";\n    }\n  }\n\n  getObject() {\n    switch (this.props.type) {\n      case \"new_message\":\n        return (\n          <Fragment>\n            <strong>\n              {this.props.fromGroup.name}\n            </strong>\n            {this.state.title && (\n              <Fragment>\n                <br />\n                <small><em>{util.limitStrSize(this.state.title, 52)}</em></small>\n              </Fragment>\n            )}\n          </Fragment>\n        );\n      case \"new_comment\":\n        return (\n          <span>\n            {`${lang.t(\"the_message_from\")  } `}\n            <strong>\n              {this.props.fromMessage && this.props.fromMessage[\"author\"]\n                ? this.props.fromMessage[\"author\"][\"name\"]\n                : \"\"}\n            </strong>\n            {this.state.title && (\n              <Fragment>\n                <br />\n                <small><em>{util.limitStrSize(this.state.title, 52)}</em></small>\n              </Fragment>\n            )}\n          </span>\n        );\n      case \"user_joined_group\":\n      case \"user_left_group\":\n        return (\n          <strong>\n            {this.props.fromGroup.name}\n          </strong>\n        );\n      case \"group_name_change\":\n        return (\n          <span>\n            <strong>{this.props.data[\"previousGroupName\"]}</strong>\n            {` ${lang.t(\"to\")} `}\n            <strong>{this.props.data[\"newGroupName\"]}</strong>\n          </span>\n        );\n      case \"global_notification\":\n        return this.props.data[\"text\"];\n      default:\n        return \"\";\n    }\n  }\n\n  getTarget() {\n    switch (this.props.type) {\n      case \"user_joined_group\":\n      case \"user_left_group\":\n      case \"group_name_change\":\n        return `/groups/${this.props.fromGroup.id}`;\n      case \"new_message\":\n        return `/messages/${this.props.target}`;\n      case \"new_comment\":\n        return (\n          `/messages/${this.props.fromMessage.id}/${this.props.target}`\n        );\n      case \"global_notification\":\n        return this.props.target;\n      default:\n        return \"\";\n    }\n  }\n\n  render() {\n    return (\n      <a\n        class=\"notification seamless-link unselectable\"\n        href={router.toApp(this.state.target)}\n        title={this.state.title}\n        onClick={e => {\n          e.preventDefault();\n          me.removeMatchingNotifications(this.props.id).then(() =>\n            router.onClick(e, false, this.state.target)\n          );\n        }}\n      >\n        <div class=\"miniature unselectable\">{this.getMiniature()}</div>\n        <div class=\"infos\">\n          <div class=\"description\">\n            {this.props.type != \"global_notification\" && (\n              <Fragment>\n                <strong>{this.props.fromUser.name || \"--\"}</strong>\n                <span>{` ${this.state.action} `}</span>\n              </Fragment>\n            )}\n            {this.getObject()}\n          </div>\n          <div class=\"date\">\n            {util.humanTime(this.props.createdAt)}\n          </div>\n        </div>\n      </a>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, router } from \"/core\";\nimport { FaIcon } from \"/misc\";\n\nexport default class Search extends Component {\n  constructor(props) {\n    super(props);\n    this.search = this.search.bind(this);\n  }\n\n  search(evt) {\n    evt.preventDefault();\n    let group_id =\n    router.route == \"messages\" ? router.entity && router.entity.group && router.entity.group.id : router.entity && router.entity.id;\n    // https://stackoverflow.com/a/37511463\n    let searchTerms = document\n      .getElementById(\"search\")\n      .value.normalize(\"NFD\")\n      .replace(/[\\u0300-\\u036f]/g, \"\")\n      .split(\" \");\n    router.navigate(\n      `/groups/${group_id}?search=${searchTerms.map(e => encodeURIComponent(e)).join(\"+\")}`\n    );\n  }\n\n  render() {\n    let entityId = null;\n    if (router.entity) {\n      if (router.entity.group && router.entity.group.id) {\n        entityId = router.entity.group.id;\n      } else {\n        entityId = router.entity.id;\n      }\n    }\n    if (entityId) {\n      return (\n        <form class=\"navbar-block search-block\" onSubmit={e => this.search(e)}>\n          <div class=\"input-group\">\n            <input\n              class=\"form-control\"\n              type=\"text\"\n              id=\"search\"\n              placeholder={lang.t(\"search_in_group\")}\n              value={decodeURIComponent(\n                router.getParam(\"search\").replace(/\\+/g, \" \")\n              )}\n             />\n            <div class=\"input-group-append\">\n              <button\n                class=\"btn btn-secondary\"\n                type=\"submit\"\n              >\n                <FaIcon family={\"solid\"} icon={\"search\"} />\n              </button>\n            </div>\n          </div>\n        </form>\n      );\n    }\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, me, router, http } from \"/core\";\nimport Writer from \"/message/writer.component.js\";\n\nexport default class Share extends Component {\n  constructor() {\n    super();\n    let currentUrl = new URL(window.location);\n    this.state = {\n      loaded: false,\n      group: null,\n      currentUrl,\n      title: currentUrl.searchParams.get(\"title\") || \"\",\n      text: currentUrl.searchParams.get(\"text\") || \"\",\n      url: currentUrl.searchParams.get(\"url\") || \"\",\n      parent: currentUrl.searchParams.get(\"parent\") || \"\",\n      files: null\n    };\n    this.groupSelect = this.groupSelect.bind(this);\n  }\n\n  componentDidMount() {\n    me.get().then(user => {\n      if (user.data[\"default_group\"]) {\n        this.setState({ group: user.data[\"default_group\"] });\n        router.backUrl = `/groups/${  user.data[\"default_group\"]}`;\n      } else if (user.groups.length == 1) {\n          this.setState({ group: user.groups[0][\"id\"] });\n          router.backUrl = `/groups/${  user.groups[0]}`;\n        }\n      if (this.state.currentUrl.searchParams.get(\"message\")) {\n        http\n          .get(\n            `/api/messages/${  this.state.currentUrl.searchParams.get(\"message\")}`\n          )\n          .then(m => {\n            this.setState({\n              loaded: true,\n              title: (m && m.data.title) || \"\",\n              text: (m && m.data.text) || \"\",\n              url: \"\",\n              files: (m && m.files) || null\n            });\n          });\n      } else {\n        this.setState({ loaded: true });\n      }\n    });\n  }\n\n  groupSelect(e) {\n    this.setState({ group: e.target.value });\n    router.backUrl = `/groups/${  e.target.value}`;\n  }\n\n  render() {\n    if (!this.state[\"loaded\"]) {\n      return;\n    }\n    return (\n      <article class=\"mt-2\">\n        <div class=\"container\">\n          {!this.state.parent && me.me && me.me.groups.length > 1 && (\n            <div class=\"mb-1\">\n              <label class=\"px-1\" for=\"group_share_choice\">\n                {lang.t(\"group_share_choice\")}\n              </label>\n              <select\n                value={this.state.group}\n                class=\"form-control\"\n                name=\"group_share_choice\"\n                onChange={e => this.groupSelect(e)}\n                required\n              >\n                {me.me.groups.map(e => (\n                  <option value={e[\"id\"]}>{e.name}</option>\n                ))}\n              </select>\n            </div>\n          )}\n          {this.state.parent && (\n            <div class=\"form-group\">\n              <label for=\"apiKey\">\n                {lang.t(\"parent_message\")}:{\" \"}\n              </label>\n              <input\n                type=\"text\"\n                name=\"parent_message\"\n                value={this.state.parent}\n                class=\"form-control font-size-80\"\n                readonly=\"readonly\"\n               />\n            </div>\n          )}\n          <Writer\n            focus={true}\n            group={this.state.group}\n            title={this.state.title}\n            parent={this.state.parent}\n            text={\n              this.state.text || this.state.url\n                ? `${this.state.text  }\\n${  this.state.url}`\n                : \"\"\n            }\n            files={this.state.files}\n          />\n        </div>\n      </article>\n    );\n  }\n}\n","import { h } from \"preact\";\nimport { router } from \"/core\";\n\nexport default function GroupTitle() {\n  return (\n    <a\n      href={router.toApp(`/groups/${  this.props.id}`)}\n      onClick={e => router.onClick(e)}\n      class=\"no-decoration\"\n    >\n      <div class=\"group-name\">{this.props.name}</div>\n    </a>\n  );\n}\n","import _CreateGroup from \"./create-group.component.js\";\nimport _GroupBoard from \"./group-board.component.js\";\nimport _BookmarkBoard from \"./bookmark-board.component.js\";\nimport _MainContent from \"./main-content.component.js\";\nimport _Notification from \"./notification.component.js\";\nimport _Search from \"./search.component.js\";\nimport _Share from \"./share.component.js\";\nimport _GroupTitle from \"./group-title.component.js\";\n\nexport const CreateGroup = _CreateGroup;\nexport const GroupBoard = _GroupBoard;\nexport const BookmarkBoard = _BookmarkBoard;\nexport const MainContent = _MainContent;\nexport const Notification = _Notification;\nexport const Search = _Search;\nexport const Share = _Share;\nexport const GroupTitle = _GroupTitle;\n","import { h, Component } from \"preact\";\nimport { lang, me, router, util } from \"/core\";\nimport { FaIcon } from \"/misc\";\nimport { Search } from \"/pages\";\nimport { GroupsDropdownNavbar, NotificationsDropdownNavbar } from \"/navbar\";\n\nexport default class Navbar extends Component {\n  constructor(props) {\n    super(props);\n    this.clickBackButton = this.clickBackButton.bind(this);\n    // force update the navbar when me gets updated\n    addEventListener(\"meStateChange\", () => this.setState({}));\n  }\n\n  clickBackButton(evt) {\n    evt.preventDefault();\n    if (router.backUrlPrompt && !confirm(router.backUrlPrompt)) {\n      return false;\n    }\n    router.onClick(evt);\n  }\n\n  render() {\n    return (\n      <div class=\"main-nav nav align-items-center z-index-100\">\n        <div class=\"navbar-block\">\n          {([\"share\"].includes(router.route) ||\n            [\"settings\"].includes(router.action) ||\n            !router.backUrl) && (\n              <div\n                class=\"menu dropdown cursor-pointer\"\n                tabindex=\"-1\"\n                onClick={e => e.currentTarget.classList.toggle(\"active\")}\n              >\n                <div class=\"rounded-circle avatar unselectable\">\n                  <img\n                    class=\"rounded-circle\"\n                    style={util.backgroundHash(me.me.id)}\n                    src={\n                      me.me.avatar\n                        ? util.crop(me.me.avatar[\"id\"], 80, 80)\n                        : util.defaultAvatar\n                    }\n                    onError={e => (e.currentTarget.src = util.defaultAvatar)}\n                  />\n                </div>\n                <div class=\"dropdown-menu dropdown-right\">\n                  { me.me && me.me.data && Array.isArray(me.me.data.bookmarks) && me.me.data.bookmarks.length && (\n                    <a\n                      class=\"d-block seamless-link capitalize\"\n                      href={router.toApp(\"/bookmarks\")}\n                      onClick={e => router.onClick(e)}\n                    >\n                      {lang.t('bookmarks')}\n                    </a>\n                  )}\n                  <a\n                    class=\"d-block seamless-link capitalize\"\n                    href={router.toApp(`/users/${  me.me.id  }/settings`)}\n                    onClick={e => router.onClick(e)}\n                  >\n                    {lang.t(\"settings\")}\n                  </a>\n                  <a\n                    class=\"d-block seamless-link capitalize\"\n                    href={router.toApp(\"/logout\")}\n                    onClick={e => router.onClick(e)}\n                  >\n                    {lang.t(\"logout\")}\n                  </a>\n                </div>\n              </div>\n            )}\n          {[\"groups\", \"messages\"].includes(router.route) && router.backUrl && (\n            <a\n              class=\"seamless-link back\"\n              href={router.toApp(router.backUrl)}\n              onClick={e => this.clickBackButton(e)}\n            >\n              <FaIcon family={\"regular\"} icon={\"level-down-alt\"} rotation={\"180deg\"} />\n            </a>\n          )}\n          <NotificationsDropdownNavbar />\n        </div>\n        <Search />\n        <div class=\"navbar-block\">\n          <GroupsDropdownNavbar />\n        </div>\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, me, http } from \"/core\";\nimport { FaIcon } from \"/misc\";\nimport { Notification } from \"/pages\";\n\nexport default class NotificationsDropdownNavbar extends Component {\n  constructor(props) {\n    super(props);\n    // force update the navbar when me gets updated\n    addEventListener(\"meStateChange\", () => this.setState({}));\n    this.clearAllNotifications = this.clearAllNotifications.bind(this);\n  }\n\n  clearAllNotifications() {\n    if (me.me.notifications.length) {\n      Promise.all(\n        me.me.notifications.map(n => http.delete(`/api/notifications/${  n.id}`))\n      ).then(me.update());\n    }\n  }\n\n  render() {\n    return (\n      <div\n        className={\n          `menu dropdown${me.me.notifications && me.me.notifications.length ? \" cursor-pointer\" : \"\"}`\n        }\n        title={lang.t('notifications')}\n        tabindex=\"-1\"\n        onClick={e =>\n          me.me.notifications.length &&\n          e.currentTarget.classList.toggle(\"active\")\n        }\n      >\n        <div class=\"unselectable button-with-count\">\n          <FaIcon\n            family={me.me.notifications.length ? \"solid\" : \"regular\"}\n            icon={\"bell\"}\n          />\n          {!!me.me.notifications.length && (\n            <span class=\"badge-count\">{me.me.notifications.length}</span>\n          )}\n        </div>\n        <div class=\"dropdown-menu dropdown-right notifications-menu\">\n          <div class=\"notification-header\">\n            <strong class=\"capitalize\">{lang.t(\"notifications\")}</strong>\n            <div\n              class=\"action capitalize\"\n              onClick={() => this.clearAllNotifications()}\n            >\n              {lang.t(\"mark_all_as_read\")}\n            </div>\n          </div>\n          {me.me && Array.isArray(me.me.notifications) && me.me.notifications.length && (\n            me.me.notifications.sort((a, b) => b.createdAt - a.createdAt).map(e => <Notification key={e.id} {...e} />)\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import _GroupSearch from \"./group-search.component.js\";\nimport _GroupsDropdownNavbar from \"./groups-dropdown-navbar.component.js\";\nimport _Navbar from \"./navbar.component.js\";\nimport _NotificationsDropdownNavbar from \"./notifications-dropdown-navbar.component.js\";\n\nexport const GroupSearch = _GroupSearch;\nexport const GroupsDropdownNavbar = _GroupsDropdownNavbar;\nexport const Navbar = _Navbar;\nexport const NotificationsDropdownNavbar = _NotificationsDropdownNavbar;\n","import { h, Component } from \"preact\";\nimport { lang, me, alert, storage, http, router } from \"/core\";\nimport zusam_logo from \"/assets/zusam_logo.svg\";\n\nexport default class Login extends Component {\n  constructor() {\n    super();\n    this.state = {\n      showAlert: false,\n      error: \"\"\n    };\n    this.sendLoginForm = this.sendLoginForm.bind(this);\n    this.sendPasswordReset = this.sendPasswordReset.bind(this);\n    this.showPasswordReset = this.showPasswordReset.bind(this);\n    // reroute if already logged in\n    storage.get(\"apiKey\").then(apiKey => apiKey && router.navigate(\"/\"));\n  }\n\n  sendPasswordReset(e) {\n    e.preventDefault();\n    let login = document.getElementById(\"login\").value || \"\";\n    login.toLowerCase();\n    this.setState({ sending: true });\n    http.post(\"/api/password-reset-mail\", { mail: login }).then(res => {\n      this.setState({ sending: false });\n      if (res && !res.message) {\n        alert.add(lang.t(\"password_reset_mail_sent\"));\n      } else {\n        alert.add(lang.t(res.message), \"alert-danger\");\n      }\n    });\n  }\n\n  sendLoginForm(e) {\n    e.preventDefault();\n    this.setState({ showAlert: false, sending: true });\n    let login = document.getElementById(\"login\").value || \"\";\n    login.toLowerCase();\n    const password = document.getElementById(\"password\").value;\n    http.post(\"/api/login\", { login, password }).then(res => {\n      this.setState({ sending: false });\n      if (res && res.api_key) {\n        storage.set(\"apiKey\", res.api_key).then(() => {\n          me.update().then(() => {\n            setTimeout(() => router.navigate(\"/\"), 100);\n          });\n        });\n      } else if (res && res.message) {\n          alert.add(lang.t(res.message), \"alert-danger\");\n        } else {\n          alert.add(lang.t(\"error\"), \"alert-danger\");\n        }\n    });\n  }\n\n  showPasswordReset() {\n    this.setState({ showResetPassword: true });\n  }\n\n  render() {\n    return (\n      <div class=\"login\">\n        <div class=\"login-form\">\n          <img src={zusam_logo} />\n          {!this.state.showResetPassword && (\n            <form>\n              <div class=\"form-group\">\n                <input\n                  type=\"email\"\n                  class=\"form-control\"\n                  required\n                  id=\"login\"\n                  placeholder={lang.t(\"login_placeholder\")}\n                />\n              </div>\n              <div class=\"form-group\">\n                <input\n                  type=\"password\"\n                  class=\"form-control\"\n                  required\n                  id=\"password\"\n                  placeholder={lang.t(\"password_placeholder\")}\n                />\n              </div>\n              <div class=\"forgot-password\">\n                <span onClick={e => this.showPasswordReset(e)}>\n                  {lang.t(\"forgot_password\")}\n                </span>\n              </div>\n              <button\n                type=\"submit\"\n                class=\"btn btn-light\"\n                onClick={e => this.sendLoginForm(e)}\n                disabled={this.state.sending}\n              >\n                {lang.t(\"connect\")}\n              </button>\n            </form>\n          )}\n          {!!this.state.showResetPassword && (\n            <form>\n              <div class=\"form-group\">\n                <input\n                  type=\"email\"\n                  class=\"form-control\"\n                  required\n                  id=\"login\"\n                  placeholder={lang.t(\"login_placeholder\")}\n                />\n              </div>\n              <button\n                type=\"submit\"\n                class=\"btn btn-light\"\n                onClick={e => this.sendPasswordReset(e)}\n                disabled={this.state.sending}\n              >\n                {lang.t(\"submit\")}\n              </button>\n            </form>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, alert, storage, http, router } from \"/core\";\n\nexport default class ResetPassword extends Component {\n  constructor() {\n    super();\n    this.sendNewPassword = this.sendNewPassword.bind(this);\n  }\n\n  sendNewPassword(e) {\n    e.preventDefault();\n    storage.set(\"apiKey\", \"\");\n    const password = document.getElementById(\"password\").value || \"\";\n    const passwordConfirmation = document.getElementById(\"password_confirmation\").value || \"\";\n    const mail = router.getParam(\"mail\");\n    const key = router.getParam(\"key\");\n    if (mail && password) {\n      if (password != passwordConfirmation) {\n        alert.add(lang.t(\"passwords_dont_match\"));\n        return;\n      }\n      http\n        .post(\"/api/new-password\", { mail, key, password })\n        .then(res => {\n          if (res.api_key) {\n            storage.set(\"apiKey\", res.api_key);\n            setTimeout(() => router.navigate(\"/\"), 100);\n          } else {\n            alert.add(lang.t(res.message));\n          }\n        })\n        .catch(res => console.warn(res));\n    }\n  }\n\n  render() {\n    return (\n      <div class=\"login\">\n        <div class=\"login-form\">\n          <h2 class=\"title\">{lang.t(\"reset_password_title\")}</h2>\n          <form>\n            <div class=\"form-group\">\n              <input\n                type=\"password\"\n                class=\"form-control\"\n                required\n                id=\"password\"\n                placeholder={lang.t(\"new_password_placeholder\")}\n              />\n            </div>\n            <div class=\"form-group\">\n              <input\n                type=\"password\"\n                class=\"form-control\"\n                required\n                id=\"password_confirmation\"\n                placeholder={lang.t(\"confirm_password_placeholder\")}\n              />\n            </div>\n            <button\n              type=\"submit\"\n              class=\"btn btn-light\"\n              onClick={e => this.sendNewPassword(e)}\n            >\n              {lang.t(\"submit\")}\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, alert, storage, http, router } from \"/core\";\nimport zusam_logo from \"/assets/zusam_logo.svg\";\n\nexport default class Signup extends Component {\n  constructor() {\n    super();\n    this.state = {\n      showAlert: false,\n      error: \"\",\n      inviteKey: router.getParam(\"inviteKey\")\n    };\n    this.sendSignupForm = this.sendSignupForm.bind(this);\n  }\n\n  sendSignupForm(e) {\n    e.preventDefault();\n    this.setState({ showAlert: false });\n    let login = document.getElementById(\"login\").value || \"\";\n    login.toLowerCase();\n    const password = document.getElementById(\"password\").value;\n    storage.set(\"apiKey\", \"\");\n    http\n      .post(\"/api/signup\", {\n        login,\n        password,\n        invite_key: this.state.inviteKey\n      })\n      .then(res => {\n        if (res && !res.message) {\n          storage.set(\"apiKey\", res.api_key);\n          setTimeout(() => router.navigate(\"/\"), 100);\n        } else {\n          alert.add(lang.t(res.message));\n        }\n      });\n  }\n\n  render() {\n    return (\n      <div class=\"signup\">\n        <div class=\"signup-form\">\n          <img src={zusam_logo} />\n          <div class=\"welcome lead\">{lang.t(\"invitation_welcome\")}</div>\n          <form>\n            <div class=\"form-group\">\n              <input\n                type=\"email\"\n                class=\"form-control\"\n                required\n                id=\"login\"\n                placeholder={lang.t(\"login_placeholder\")}\n              />\n            </div>\n            <div class=\"form-group\">\n              <input\n                type=\"password\"\n                class=\"form-control\"\n                required\n                id=\"password\"\n                placeholder={lang.t(\"password_placeholder\")}\n              />\n            </div>\n            <button\n              type=\"submit\"\n              class=\"btn btn-light\"\n              onClick={e => this.sendSignupForm(e)}\n            >\n              {lang.t(\"signup\")}\n            </button>\n          </form>\n        </div>\n      </div>\n    );\n  }\n}\n","import { h, Component } from \"preact\";\nimport { lang, http } from \"/core\";\n\nexport default class StopNotificationEmails extends Component {\n  constructor() {\n    super();\n    http\n      .get(`/api${  window.location.pathname}`)\n      .then(() => {\n        this.setState({ message: lang.t(\"notification_emails_stopped\") });\n      })\n      .catch(err => {\n        console.warn(err);\n        this.setState({ message: lang.t(\"error\") });\n      });\n  }\n\n  render() {\n    return <div>{this.state.message || \"\"}</div>;\n  }\n}\n","import { h, Component } from \"preact\";\nimport { http } from \"/core\";\nimport { MessageParent } from \"/message\";\n\nexport default class Public extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {};\n  }\n\n  componentDidMount() {\n    if (this.props.token) {\n      http\n        .get(`/api/public/${  this.props.token}`)\n        .then(res => this.setState({ message: res }));\n    }\n  }\n\n  render() {\n    if (!this.state.message) {\n      return;\n    }\n    return (\n      <article class=\"justify-content-center d-flex mt-2\">\n        <div class=\"container\">\n          <MessageParent\n            isPublic={true}\n            key={this.state.message.id}\n            message={this.state.message}\n          />\n        </div>\n      </article>\n    );\n  }\n}\n","import _Login from \"./login.component.js\";\nimport _ResetPassword from \"./reset-password.component.js\";\nimport _Signup from \"./signup.component.js\";\nimport _StopNotificationEmails from \"./stop-notification-emails.component.js\";\nimport _Public from \"./public.component.js\";\n\nexport const Login = _Login;\nexport const ResetPassword = _ResetPassword;\nexport const Signup = _Signup;\nexport const StopNotificationEmails = _StopNotificationEmails;\nexport const Public = _Public;\n","import { h, render, Component } from \"preact\";\nimport { alert, lang, storage, router, me, cache, api } from \"/core\";\nimport { Navbar } from \"/navbar\";\nimport { MainContent } from \"/pages\";\nimport {\n  Login,\n  Public,\n  ResetPassword,\n  Signup,\n  StopNotificationEmails\n} from \"/outside\";\n\nclass App extends Component {\n  constructor() {\n    super();\n\n    // load api infos\n    api.update();\n\n    // cache management\n    console.log(`localStorage usage: ${storage.usage()}`);\n    cache.purgeOldCache();\n\n    this.onRouterStateChange = this.onRouterStateChange.bind(this);\n    window.addEventListener(\"routerStateChange\", this.onRouterStateChange);\n    window.addEventListener(\"meStateChange\", () => this.setState({ me: me.me }));\n    window.addEventListener(\"fetchedNewDict\", () => this.setState({}));\n    window.addEventListener(\"popstate\", router.sync);\n    window.addEventListener(\"click\", e => {\n      if (!e.target.closest(\".dropdown\")) {\n        // close dropdowns if we are clicking on something else\n        document\n          .querySelectorAll(\".dropdown\")\n          .forEach(n => n.classList.remove(\"active\"));\n      } else {\n        // close dropdowns that are not clicked on\n        document\n          .querySelectorAll(\".dropdown\")\n          .forEach(n => {\n            if(n != e.target.closest(\".dropdown\")) {\n              n.classList.remove(\"active\")\n            }\n          });\n      }\n    });\n\n    // fetch language file\n    lang.fetchDict();\n\n    // get apiKey from the logged in user\n    storage.get(\"apiKey\").then(apiKey => {\n      if (router.isOutside() || apiKey) {\n        router.sync();\n      } else {\n        // redirect to login if we don't have an apiKey\n        //  log this so that we can later remove a falsy behavior\n        //  We don't want to logout the user if the network is slow\n        console.warn(\"No API key\");\n        router.navigate(\"/login\");\n      }\n    });\n\n    this.state = {\n      action: router.action,\n      route: router.route,\n      id: router.id,\n      entityUrl: router.entityUrl\n    };\n  }\n\n  onRouterStateChange() {\n    this.setState({\n      action: router.action,\n      route: router.route,\n      id: router.id,\n      entityUrl: router.entityUrl\n    });\n    setTimeout(() => window.scrollTo(0, 0));\n    storage.get(\"apiKey\").then(apiKey => {\n      if (apiKey && router.route != \"login\") {\n        me.get().then(user => {\n          if (!user && !router.isOutside()) {\n            // let's log this so we can later know what causes disconnects when the network is slow\n            console.warn(\"No user data => logout.\");\n            storage.set(\"apiKey\", \"\").then(() => router.navigate(\"/login\"));\n          } else {\n            this.setState({\n              action: router.action,\n              route: router.route,\n              id: router.id,\n              me: user,\n              entityUrl: router.entityUrl\n            });\n          }\n        });\n      } else if (!router.isOutside()) {\n            // let's log this so we can later know what causes disconnects when the network is slow\n            console.warn(\"No API key => logout.\");\n          router.navigate(\"/login\");\n        }\n    });\n    alert.add(lang.t(router.getParam(\"alert\", router.search)));\n  }\n\n  render() {\n    // external pages for non connected users\n    switch (this.state.route) {\n      case \"signup\":\n        return <Signup />;\n      case \"stop-notification-emails\":\n        return <StopNotificationEmails />;\n      case \"public\":\n        return <Public token={this.state.id} key={this.state.id} />;\n      case \"password-reset\":\n        return <ResetPassword />;\n      case \"login\":\n        return <Login />;\n    }\n\n    // here, we enter the \"connected\" realm of pages.\n    // If the user is not connected, what should we do ?\n    if (!this.state.me || !this.state.me.groups) {\n      return;\n    }\n\n    return (\n      <main>\n        <Navbar />\n        <div class=\"content\">\n          <MainContent {...this.state} />\n        </div>\n      </main>\n    );\n  }\n}\n\nrender(<App />, document.body);\n\nif (\"serviceWorker\" in navigator) {\n  window.addEventListener(\"load\", () => {\n    if (location.search.includes(\"service-workers=unregister\")) {\n      navigator.serviceWorker.getRegistrations().then((registrations) => {\n        for (let registration of registrations) {\n          registration.unregister();\n        }\n      });\n      console.log(\"Service workers unregistered\");\n    }\n    navigator.serviceWorker.register(\"/service-workers.js\").then(\n      (registration) => {\n        console.log(\n          \"ServiceWorker registration successful with scope: \",\n          registration.scope\n        );\n      },\n      (err) => {\n        console.warn(\"ServiceWorker registration failed: \", err);\n      }\n    );\n  });\n}\n","module.exports = function loadJSBundle(bundle) {\n  return new Promise(function (resolve, reject) {\n    var script = document.createElement('script');\n    script.async = true;\n    script.type = 'text/javascript';\n    script.charset = 'utf-8';\n    script.src = bundle;\n    script.onerror = function (e) {\n      script.onerror = script.onload = null;\n      reject(e);\n    };\n\n    script.onload = function () {\n      script.onerror = script.onload = null;\n      resolve();\n    };\n\n    document.getElementsByTagName('head')[0].appendChild(script);\n  });\n};\n"]}